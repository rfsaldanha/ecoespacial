<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Econometria Espacial aplicada com R - 6&nbsp; Modelos espaciais em painel</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./gwr.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./modelos_painel.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos espaciais em painel</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Econometria Espacial aplicada com R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apresentação</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução ao R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aede.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Análise Exploratória de Dados Espaciais (AED-E)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrizes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Matrizes de vizinhos espaciais</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelos_corte_transversal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelos espaciais de corte transversal (<em>cross-section</em>)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gwr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regressão Ponderada Geograficamente (GWR)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelos_painel.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos espaciais em painel</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Apêndices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./importar_matriz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Importar matrizes criadas no Geoda</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#pacotes" id="toc-pacotes" class="nav-link active" data-scroll-target="#pacotes"><span class="header-section-number">6.1</span> Pacotes</a></li>
  <li><a href="#shapefile" id="toc-shapefile" class="nav-link" data-scroll-target="#shapefile"><span class="header-section-number">6.2</span> Shapefile</a></li>
  <li><a href="#dados" id="toc-dados" class="nav-link" data-scroll-target="#dados"><span class="header-section-number">6.3</span> Dados</a>
  <ul class="collapse">
  <li><a href="#filtrando-dados" id="toc-filtrando-dados" class="nav-link" data-scroll-target="#filtrando-dados"><span class="header-section-number">6.3.1</span> Filtrando dados</a></li>
  </ul></li>
  <li><a href="#matriz-de-vizinhança" id="toc-matriz-de-vizinhança" class="nav-link" data-scroll-target="#matriz-de-vizinhança"><span class="header-section-number">6.4</span> Matriz de vizinhança</a>
  <ul class="collapse">
  <li><a href="#variáveis-defasadas-espacialmente" id="toc-variáveis-defasadas-espacialmente" class="nav-link" data-scroll-target="#variáveis-defasadas-espacialmente"><span class="header-section-number">6.4.1</span> Variáveis defasadas espacialmente</a></li>
  </ul></li>
  <li><a href="#empilhar-dados" id="toc-empilhar-dados" class="nav-link" data-scroll-target="#empilhar-dados"><span class="header-section-number">6.5</span> Empilhar dados</a>
  <ul class="collapse">
  <li><a href="#verifica-se-o-painél-é-balanceado" id="toc-verifica-se-o-painél-é-balanceado" class="nav-link" data-scroll-target="#verifica-se-o-painél-é-balanceado"><span class="header-section-number">6.5.1</span> Verifica se o painél é balanceado</a></li>
  </ul></li>
  <li><a href="#especificação-do-modelo" id="toc-especificação-do-modelo" class="nav-link" data-scroll-target="#especificação-do-modelo"><span class="header-section-number">6.6</span> Especificação do modelo</a></li>
  <li><a href="#testes" id="toc-testes" class="nav-link" data-scroll-target="#testes"><span class="header-section-number">6.7</span> Testes</a>
  <ul class="collapse">
  <li><a href="#teste-de-hausman" id="toc-teste-de-hausman" class="nav-link" data-scroll-target="#teste-de-hausman"><span class="header-section-number">6.7.1</span> Teste de Hausman</a></li>
  <li><a href="#teste-espacial-de-hausman" id="toc-teste-espacial-de-hausman" class="nav-link" data-scroll-target="#teste-espacial-de-hausman"><span class="header-section-number">6.7.2</span> Teste espacial de Hausman</a></li>
  <li><a href="#teste-pesaran-cd-cross-section-dependence" id="toc-teste-pesaran-cd-cross-section-dependence" class="nav-link" data-scroll-target="#teste-pesaran-cd-cross-section-dependence"><span class="header-section-number">6.7.3</span> Teste Pesaran CD (cross-section dependence)</a></li>
  <li><a href="#teste-bsk" id="toc-teste-bsk" class="nav-link" data-scroll-target="#teste-bsk"><span class="header-section-number">6.7.4</span> Teste BSK</a></li>
  <li><a href="#teste-bsjk" id="toc-teste-bsjk" class="nav-link" data-scroll-target="#teste-bsjk"><span class="header-section-number">6.7.5</span> Teste BSJK</a></li>
  </ul></li>
  <li><a href="#modelos" id="toc-modelos" class="nav-link" data-scroll-target="#modelos"><span class="header-section-number">6.8</span> Modelos</a>
  <ul class="collapse">
  <li><a href="#ols" id="toc-ols" class="nav-link" data-scroll-target="#ols"><span class="header-section-number">6.8.1</span> OLS</a></li>
  <li><a href="#sar-ml" id="toc-sar-ml" class="nav-link" data-scroll-target="#sar-ml"><span class="header-section-number">6.8.2</span> SAR (ML)</a></li>
  <li><a href="#sar-gm" id="toc-sar-gm" class="nav-link" data-scroll-target="#sar-gm"><span class="header-section-number">6.8.3</span> SAR (GM)</a></li>
  <li><a href="#sem-ml" id="toc-sem-ml" class="nav-link" data-scroll-target="#sem-ml"><span class="header-section-number">6.8.4</span> SEM (ML)</a></li>
  <li><a href="#sem-gm" id="toc-sem-gm" class="nav-link" data-scroll-target="#sem-gm"><span class="header-section-number">6.8.5</span> SEM (GM)</a></li>
  <li><a href="#sac-ml" id="toc-sac-ml" class="nav-link" data-scroll-target="#sac-ml"><span class="header-section-number">6.8.6</span> SAC (ML)</a></li>
  <li><a href="#sac-gm" id="toc-sac-gm" class="nav-link" data-scroll-target="#sac-gm"><span class="header-section-number">6.8.7</span> SAC (GM)</a></li>
  <li><a href="#especificação-com-lag" id="toc-especificação-com-lag" class="nav-link" data-scroll-target="#especificação-com-lag"><span class="header-section-number">6.8.8</span> Especificação com lag</a></li>
  <li><a href="#sdm-ml" id="toc-sdm-ml" class="nav-link" data-scroll-target="#sdm-ml"><span class="header-section-number">6.8.9</span> SDM (ML)</a></li>
  <li><a href="#sdem-ml" id="toc-sdem-ml" class="nav-link" data-scroll-target="#sdem-ml"><span class="header-section-number">6.8.10</span> SDEM (ML)</a></li>
  <li><a href="#slx-ml" id="toc-slx-ml" class="nav-link" data-scroll-target="#slx-ml"><span class="header-section-number">6.8.11</span> SLX (ML)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos espaciais em painel</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="pacotes" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="pacotes"><span class="header-section-number">6.1</span> Pacotes</h2>
<p>O pacote <code>plm</code> é responsável pelos painéis convencionais (não espaciais) que usaremos para comparação. O pacote <code>splm</code> é responsável pelos painéis espaciais. Os autores do pacote lançaram um artigo sobre ele neste <a href="https://www.jstatsoft.org/article/view/v047i01/v47i01.pdf">link</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatialreg)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
which was just loaded, will retire in October 2023.
Please refer to R-spatial evolution reports for details, especially
https://r-spatial.org/r/2023/05/15/evolution4.html.
It may be desirable to make the sf package available;
package maintainers should consider adding sf to Suggests:.
The sp package is now running under evolution status 2
     (status 2 uses the sf package in place of rgdal)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>To access larger datasets in this package, install the spDataLarge
package with: `install.packages('spDataLarge',
repos='https://nowosad.github.io/drat/', type='source')`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splm)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'splm'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:spatialreg':

    impacts</code></pre>
</div>
</div>
</section>
<section id="shapefile" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="shapefile"><span class="header-section-number">6.2</span> Shapefile</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pacotes</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Abra o arquivo</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>natregimes_montana.shp <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/natregimes_montana.gml"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `natregimes_montana' from data source 
  `/home/raphael/projects/ecoespacial/data/natregimes_montana.gml' 
  using driver `GML'
Simple feature collection with 55 features and 74 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -116.0625 ymin: 44.35373 xmax: -104.0426 ymax: 49
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>natregimes_montana.shp <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(natregimes_montana.shp)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>natregimes_montana.shp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(natregimes_montana.shp)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar o mapa</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(natregimes_montana.shp)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="modelos_painel_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="dados" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="dados"><span class="header-section-number">6.3</span> Dados</h2>
<p>Uma olhada nos dados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(natregimes_montana.shp<span class="sc">@</span>data)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   55 obs. of  74 variables:
 $ fid       : chr  "natregimes_montana.0" "natregimes_montana.1" "natregimes_montana.2" "natregimes_montana.3" ...
 $ REGIONS   : num  2 2 2 2 2 2 2 2 2 2 ...
 $ NOSOUTH   : num  1 1 1 1 1 1 1 1 1 1 ...
 $ POLY_ID   : int  7 8 9 10 11 12 13 24 25 26 ...
 $ NAME      : chr  "Lincoln" "Flathead" "Glacier" "Toole" ...
 $ STATE_NAME: chr  "Montana" "Montana" "Montana" "Montana" ...
 $ STATE_FIPS: int  30 30 30 30 30 30 30 30 30 30 ...
 $ CNTY_FIPS : int  53 29 35 101 51 41 91 5 71 105 ...
 $ FIPS      : int  30053 30029 30035 30101 30051 30041 30091 30005 30071 30105 ...
 $ STFIPS    : int  30 30 30 30 30 30 30 30 30 30 ...
 $ COFIPS    : int  53 29 35 101 51 41 91 5 71 105 ...
 $ FIPSNO    : int  30053 30029 30035 30101 30051 30041 30091 30005 30071 30105 ...
 $ SOUTH     : int  0 0 0 0 0 0 0 0 0 0 ...
 $ HR60      : num  7.98 1.01 11.53 0 0 ...
 $ HR70      : num  5.54 1.69 9.27 5.71 0 ...
 $ HR80      : num  5.63 4.49 28.23 0 0 ...
 $ HR90      : num  5.72 2.81 5.5 6.61 0 ...
 $ HC60      : num  1 0.333 1.333 0 0 ...
 $ HC70      : num  1 0.667 1 0.333 0 ...
 $ HC80      : num  1 2.33 3 0 0 ...
 $ HC90      : num  1 1.667 0.667 0.333 0 ...
 $ PO60      : int  12537 32965 11565 7904 2624 18653 6458 8091 6027 17080 ...
 $ PO70      : int  18063 39460 10783 5839 2359 17358 5779 6727 5386 11471 ...
 $ PO80      : int  17752 51966 10628 5559 2329 17985 5414 6999 5367 10250 ...
 $ PO90      : int  17481 59218 12121 5046 2295 17654 4732 6728 5163 8239 ...
 $ RD60      : num  -1.404 -1.136 -0.315 -1.246 -0.972 ...
 $ RD70      : num  -1.543 -0.885 0.201 -0.636 -0.73 ...
 $ RD80      : num  -0.907 -0.939 0.413 -0.314 -0.181 ...
 $ RD90      : num  -0.234 -0.305 1.479 -0.649 -0.298 ...
 $ PS60      : num  -0.982 -0.346 -0.967 -1.117 -1.865 ...
 $ PS70      : num  -0.698 -0.232 -1.002 -1.314 -1.878 ...
 $ PS80      : num  -0.797 -0.131 -1.107 -1.433 -1.965 ...
 $ PS90      : num  -0.8041 -0.0598 -1.0004 -1.4703 -1.9292 ...
 $ UE60      : num  17.3 13.8 12.8 5.5 5.1 6.3 5.5 7.1 4.3 8.6 ...
 $ UE70      : num  10.3 9.8 12.6 3.6 0.5 4.3 3 10.6 4.3 5.1 ...
 $ UE80      : num  27.53 14.23 8.56 3.55 1.83 ...
 $ UE90      : num  16.12 7.72 16.96 1.85 2.6 ...
 $ DV60      : num  3.44 2.6 3.86 3.3 2.4 ...
 $ DV70      : num  3.8 3.3 3.5 4.07 3.11 ...
 $ DV80      : num  6.13 6.22 5.84 4.64 4.21 ...
 $ DV90      : num  9.57 9.28 7.82 7.69 4.44 ...
 $ MA60      : num  24.8 30.1 22.8 25.9 24.8 24 29.2 25.3 28.9 23.4 ...
 $ MA70      : num  25.1 28 22.1 29.4 26.9 24.2 31.3 26.8 29 25.2 ...
 $ MA80      : num  28.3 29.7 26.8 29.9 30 27.2 33.4 27.5 29.6 29.4 ...
 $ MA90      : num  34.7 35.3 28.2 35.3 34 31.7 39.6 31.6 34 36.9 ...
 $ POL60     : num  9.44 10.4 9.36 8.98 7.87 ...
 $ POL70     : num  9.8 10.58 9.29 8.67 7.77 ...
 $ POL80     : num  9.78 10.86 9.27 8.62 7.75 ...
 $ POL90     : num  9.77 10.99 9.4 8.53 7.74 ...
 $ DNL60     : num  1.217 1.859 1.361 1.4 0.601 ...
 $ DNL70     : num  1.582 2.039 1.291 1.097 0.494 ...
 $ DNL80     : num  1.59 2.32 1.27 1.06 0.49 ...
 $ DNL90     : num  1.577 2.452 1.398 0.971 0.473 ...
 $ MFIL59    : num  8.61 8.59 8.55 8.7 8.68 ...
 $ MFIL69    : num  9.18 9.06 8.94 9.05 9.06 ...
 $ MFIL79    : num  9.77 9.83 9.66 9.76 9.76 ...
 $ MFIL89    : num  10.13 10.26 9.98 10.3 10.24 ...
 $ FP59      : num  16.8 20 28.7 12.7 16 14.7 27.9 30.8 30.6 21.1 ...
 $ FP69      : num  5.9 10.1 23.4 10.9 8.1 11.1 8.2 25.2 13.1 14 ...
 $ FP79      : num  9.55 6.91 16.72 9.4 14.15 ...
 $ FP89      : num  11.7 11.7 30.5 10 11.9 ...
 $ BLK60     : num  0.0239 0.0819 0.2075 0.0127 0 ...
 $ BLK70     : num  0.0221 0.076 0.0278 0 0 ...
 $ BLK80     : num  0.0394 0.0712 0.0282 0.018 0 ...
 $ BLK90     : num  0.0629 0.0946 0.0908 0.0991 0.1307 ...
 $ GI59      : num  0.211 0.242 0.317 0.24 0.286 ...
 $ GI69      : num  0.296 0.335 0.381 0.355 0.379 ...
 $ GI79      : num  0.312 0.336 0.382 0.38 0.391 ...
 $ GI89      : num  0.367 0.373 0.428 0.344 0.378 ...
 $ FH60      : num  6.87 7.86 12.64 9.44 9.23 ...
 $ FH70      : num  3.7 6.4 11.4 8 5.6 7.5 6 10.3 7.2 8.1 ...
 $ FH80      : num  8.53 8.03 14.35 9.47 5.85 ...
 $ FH90      : num  10.7 10.8 18 10.7 9.5 ...
 $ West      : int  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(natregimes_montana.shp<span class="sc">@</span>data)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   fid REGIONS NOSOUTH POLY_ID     NAME STATE_NAME STATE_FIPS
1 natregimes_montana.0       2       1       7  Lincoln    Montana         30
2 natregimes_montana.1       2       1       8 Flathead    Montana         30
3 natregimes_montana.2       2       1       9  Glacier    Montana         30
4 natregimes_montana.3       2       1      10    Toole    Montana         30
5 natregimes_montana.4       2       1      11  Liberty    Montana         30
6 natregimes_montana.5       2       1      12     Hill    Montana         30
  CNTY_FIPS  FIPS STFIPS COFIPS FIPSNO SOUTH      HR60     HR70      HR80
1        53 30053     30     53  30053     0  7.976390 5.536179  5.633168
2        29 30029     30     29  30029     0  1.011173 1.689475  4.490115
3        35 30035     30     35  30035     0 11.529039 9.273857 28.227324
4       101 30101     30    101  30101     0  0.000000 5.708740  0.000000
5        51 30051     30     51  30051     0  0.000000 0.000000  0.000000
6        41 30041     30     41  30041     0  3.574045 3.840688  7.413585
      HR90      HC60      HC70     HC80      HC90  PO60  PO70  PO80  PO90
1 5.720497 1.0000000 1.0000000 1.000000 1.0000000 12537 18063 17752 17481
2 2.814460 0.3333333 0.6666667 2.333333 1.6666667 32965 39460 51966 59218
3 5.500096 1.3333333 1.0000000 3.000000 0.6666667 11565 10783 10628 12121
4 6.605892 0.0000000 0.3333333 0.000000 0.3333333  7904  5839  5559  5046
5 0.000000 0.0000000 0.0000000 0.000000 0.0000000  2624  2359  2329  2295
6 1.888146 0.6666667 0.6666667 1.333333 0.3333333 18653 17358 17985 17654
        RD60       RD70       RD80       RD90       PS60       PS70       PS80
1 -1.4042598 -1.5426214 -0.9071029 -0.2342999 -0.9820457 -0.6979686 -0.7968777
2 -1.1362915 -0.8845592 -0.9385383 -0.3047841 -0.3460932 -0.2317217 -0.1310444
3 -0.3145964  0.2010717  0.4129320  1.4785661 -0.9666818 -1.0020089 -1.1072647
4 -1.2456903 -0.6362448 -0.3137972 -0.6494730 -1.1167019 -1.3137875 -1.4332524
5 -0.9720294 -0.7303135 -0.1811841 -0.2980633 -1.8648430 -1.8784566 -1.9652599
6 -1.1497843 -0.7690945 -0.5384804 -0.2891518 -0.5925901 -0.6484952 -0.7144108
         PS90 UE60 UE70      UE80      UE90     DV60     DV70     DV80     DV90
1 -0.80405473 17.3 10.3 27.534319 16.118209 3.437140 3.796674 6.129678 9.566015
2 -0.05980789 13.8  9.8 14.229821  7.722523 2.596485 3.299732 6.217617 9.281914
3 -1.00040768 12.8 12.6  8.560477 16.961060 3.861104 3.501281 5.840611 7.820672
4 -1.47026101  5.5  3.6  3.545493  1.850329 3.300825 4.065828 4.637681 7.688201
5 -1.92917594  5.1  0.5  1.831897  2.598870 2.399128 3.113772 4.208195 4.441624
6 -0.72631046  6.3  4.3  6.504457  7.372424 2.485284 2.514011 5.130874 7.643013
  MA60 MA70 MA80 MA90     POL60     POL70     POL80     POL90     DNL60
1 24.8 25.1 28.3 34.7  9.436440  9.801621  9.784253  9.768870 1.2165748
2 30.1 28.0 29.7 35.3 10.403202 10.583043 10.858345 10.988981 1.8589771
3 22.8 22.1 26.8 28.2  9.355739  9.285726  9.271247  9.402695 1.3614436
4 25.9 29.4 29.9 35.3  8.975124  8.672315  8.623174  8.526351 1.3995396
5 24.8 26.9 30.0 34.0  7.872455  7.765993  7.753194  7.738488 0.6007514
6 24.0 24.2 27.2 31.7  9.833762  9.761809  9.797293  9.778718 1.8520290
      DNL70     DNL80     DNL90   MFIL59   MFIL69   MFIL79   MFIL89 FP59 FP69
1 1.5817562 1.5911574 1.5766315 8.609408 9.181015 9.768813 10.12999 16.8  5.9
2 2.0388182 2.3189207 2.4522596 8.592672 9.055673 9.830218 10.26004 20.0 10.1
3 1.2914311 1.2667148 1.3980954 8.550435 8.942984 9.660843  9.97525 28.7 23.4
4 1.0967302 1.0575356 0.9710215 8.703341 9.047821 9.760483 10.29958 12.7 10.9
5 0.4942894 0.4902151 0.4731983 8.675564 9.059517 9.762903 10.24256 16.0  8.1
6 1.7800755 1.8257588 1.8074938 8.733916 9.096163 9.902337 10.34358 14.7 11.1
       FP79     FP89      BLK60      BLK70      BLK80      BLK90      GI59
1  9.547634 11.67276 0.02392917 0.02214472 0.03943218 0.06292546 0.2114246
2  6.907224 11.71484 0.08190505 0.07602636 0.07120040 0.09456584 0.2419263
3 16.722284 30.50017 0.20752270 0.02782157 0.02822732 0.09075159 0.3168864
4  9.404990 10.04601 0.01265182 0.00000000 0.01798885 0.09908839 0.2399049
5 14.146341 11.91710 0.00000000 0.00000000 0.00000000 0.13071895 0.2863521
6  9.838504 12.41975 0.12866563 0.45512156 0.05004170 0.10762433 0.2596779
       GI69      GI79      GI89      FH60 FH70      FH80      FH90 West
1 0.2955510 0.3123898 0.3667044  6.872739  3.7  8.526162 10.738936    1
2 0.3353569 0.3364158 0.3732165  7.863412  6.4  8.025603 10.842786    1
3 0.3813661 0.3815989 0.4278562 12.644595 11.4 14.349277 18.013291    1
4 0.3548186 0.3798462 0.3438127  9.444444  8.0  9.468970 10.736196    1
5 0.3793765 0.3908409 0.3779590  9.225700  5.6  5.853659  9.499136    1
6 0.3441587 0.3586575 0.3694063  9.356043  7.5 11.432214 13.194598    1</code></pre>
</div>
</div>
<section id="filtrando-dados" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="filtrando-dados"><span class="header-section-number">6.3.1</span> Filtrando dados</h3>
<p>Vamos separar algumas variáveis para usarmos no modelo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> natregimes_montana.shp<span class="sc">@</span>data</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">subset</span>(dados, <span class="at">select=</span><span class="fu">c</span>(<span class="st">"POLY_ID"</span>, <span class="st">"HR90"</span>, <span class="st">"HR80"</span>, <span class="st">"RD90"</span>, <span class="st">"RD80"</span>,<span class="st">"UE90"</span>, <span class="st">"UE80"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="matriz-de-vizinhança" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="matriz-de-vizinhança"><span class="header-section-number">6.4</span> Matriz de vizinhança</h2>
<p>Para rodar os paineis espaciais, vamos precisar de uma matriz de vizinhança.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'spdep'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:spatialreg':

    get.ClusterOption, get.coresOption, get.mcOption,
    get.VerboseOption, get.ZeroPolicyOption, set.ClusterOption,
    set.coresOption, set.mcOption, set.VerboseOption,
    set.ZeroPolicyOption</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>w1 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(<span class="fu">poly2nb</span>(natregimes_montana.shp, <span class="at">queen =</span> <span class="cn">TRUE</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(w1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 55 
Number of nonzero links: 272 
Percentage nonzero weights: 8.991736 
Average number of links: 4.945455 
Link number distribution:

 2  3  4  5  6  7  8  9 
 3  8 11 16  6  7  3  1 
3 least connected regions:
1 7 28 with 2 links
1 most connected region:
2 with 9 links

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 55 3025 55 23.70729 228.2789</code></pre>
</div>
</div>
<section id="variáveis-defasadas-espacialmente" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="variáveis-defasadas-espacialmente"><span class="header-section-number">6.4.1</span> Variáveis defasadas espacialmente</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>lag_HR90 <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(w1, dados<span class="sc">$</span>HR90)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>lag_HR80 <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(w1, dados<span class="sc">$</span>HR80)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>lag_RD90 <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(w1, dados<span class="sc">$</span>RD90)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>lag_RD80 <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(w1, dados<span class="sc">$</span>RD80)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>lag_UE90 <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(w1, dados<span class="sc">$</span>UE90)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>lag_UE80 <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(w1, dados<span class="sc">$</span>UE80)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="empilhar-dados" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="empilhar-dados"><span class="header-section-number">6.5</span> Empilhar dados</h2>
<p>Para empilhar os dados de modo automático, vamos precisar que a base de dados tenha uma organização básica.</p>
<ul>
<li>O primeiro campo deve ser o de identificação;</li>
<li>Os nomes das variáveis devem conter a especificação da variável e o ano, algo como “PIB2000” e “PIB2010”.</li>
<li>Não devem existir outras variáveis além da identificação e dados do painel.</li>
</ul>
<p>Vejamos a base de dados do exemplo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "POLY_ID"  "HR90"     "HR80"     "RD90"     "RD80"     "UE90"    
 [7] "UE80"     "lag_HR90" "lag_HR80" "lag_RD90" "lag_RD80" "lag_UE90"
[13] "lag_UE80"</code></pre>
</div>
</div>
<p>Para colocar os dados em painel, criamos uma função. Veja abaixo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>painel <span class="ot">&lt;-</span> <span class="cf">function</span>(id, dados){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(reshape2)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  dadosp <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dados, <span class="at">id=</span>id)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  dadosp<span class="sc">$</span>varname <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">gsub</span>(<span class="st">"[[:digit:]]"</span>, <span class="st">""</span>, dadosp<span class="sc">$</span>variable))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  dadosp<span class="sc">$</span>year <span class="ot">&lt;-</span>  <span class="fu">as.character</span>(<span class="fu">gsub</span>(<span class="st">"[[:alpha:]]"</span>, <span class="st">""</span>, dadosp<span class="sc">$</span>variable))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  sp <span class="ot">&lt;-</span> <span class="fu">split</span>(dadosp, <span class="at">f =</span> dadosp<span class="sc">$</span>varname)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  dadosp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sp[[<span class="dv">1</span>]][,<span class="dv">1</span>], sp[[<span class="dv">1</span>]]<span class="sc">$</span>year)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sp)){</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    dadosp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dadosp, sp[[i]]<span class="sc">$</span>value)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(dadosp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"ano"</span>,<span class="fu">names</span>(sp)) </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dadosp)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Depois de declarada, vamos colocar os dados em painel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dadosp <span class="ot">&lt;-</span> <span class="fu">painel</span>(<span class="st">"POLY_ID"</span>, dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: reshape2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dadosp)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id ano       HR   lag_HR      lag_RD   lag_UE         RD        UE
1  7  90 5.720497 3.329789 -0.22352606 8.606974 -0.2342999 16.118209
2  8  90 2.814460 5.257950  0.03762522 8.897906 -0.3047841  7.722523
3  9  90 5.500096 4.867323 -0.41474938 5.425459  1.4785661 16.961060
4 10  90 6.605892 3.560571  0.29683726 8.754485 -0.6494730  1.850329
5 11  90 0.000000 3.418914 -0.34637004 4.856264 -0.2980633  2.598870
6 12  90 1.888146 4.954419  0.20961082 5.438876 -0.2891518  7.372424</code></pre>
</div>
</div>
<section id="verifica-se-o-painél-é-balanceado" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="verifica-se-o-painél-é-balanceado"><span class="header-section-number">6.5.1</span> Verifica se o painél é balanceado</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.pbalanced</span>(dadosp)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
</section>
<section id="especificação-do-modelo" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="especificação-do-modelo"><span class="header-section-number">6.6</span> Especificação do modelo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>esp <span class="ot">&lt;-</span> HR <span class="sc">~</span> RD <span class="sc">+</span> UE</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testes" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="testes"><span class="header-section-number">6.7</span> Testes</h2>
<section id="teste-de-hausman" class="level3" data-number="6.7.1">
<h3 data-number="6.7.1" class="anchored" data-anchor-id="teste-de-hausman"><span class="header-section-number">6.7.1</span> Teste de Hausman</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(esp, <span class="at">data =</span> dadosp)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">plm</span>(esp, <span class="at">data =</span> dadosp, <span class="at">model =</span> <span class="st">"random"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>ph <span class="ot">&lt;-</span> <span class="fu">phtest</span>(fe, re) <span class="co"># H0: efeitos aleatórios</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ph)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hausman Test

data:  esp
chisq = 18.503, df = 2, p-value = 9.598e-05
alternative hypothesis: one model is inconsistent</code></pre>
</div>
</div>
</section>
<section id="teste-espacial-de-hausman" class="level3" data-number="6.7.2">
<h3 data-number="6.7.2" class="anchored" data-anchor-id="teste-espacial-de-hausman"><span class="header-section-number">6.7.2</span> Teste espacial de Hausman</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>error_type <span class="ot">&lt;-</span> <span class="st">"b"</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>sar_random <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">TRUE</span>, <span class="at">model =</span> <span class="st">"random"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> <span class="st">"none"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>sar_fixed <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">TRUE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> <span class="st">"none"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>sem_random <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">FALSE</span>, <span class="at">model =</span> <span class="st">"random"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> error_type)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>sem_fixed <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">FALSE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> error_type)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>sac_random <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">TRUE</span>, <span class="at">model =</span> <span class="st">"random"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> error_type)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>sac_fixed <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">TRUE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> error_type)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>test_sar <span class="ot">&lt;-</span> <span class="fu">sphtest</span>(sar_random, sar_fixed)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>test_sem <span class="ot">&lt;-</span> <span class="fu">sphtest</span>(sem_random, sem_fixed)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>test_sac <span class="ot">&lt;-</span> <span class="fu">sphtest</span>(sac_random, sac_fixed)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(test_sar<span class="sc">$</span>statistic, test_sar<span class="sc">$</span>p.value),</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(test_sem<span class="sc">$</span>statistic, test_sem<span class="sc">$</span>p.value),</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(test_sac<span class="sc">$</span>statistic, test_sac<span class="sc">$</span>p.value)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"test"</span>, <span class="st">"p-value"</span>), <span class="fu">c</span>(<span class="st">"SAR"</span>,<span class="st">"SEM"</span>,<span class="st">"SAC"</span>))</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="at">x =</span> res, <span class="at">digits =</span> <span class="dv">5</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             SAR      SEM      SAC
test    57.60107 59.82911 73.12357
p-value  0.00000  0.00000  0.00000</code></pre>
</div>
</div>
</section>
<section id="teste-pesaran-cd-cross-section-dependence" class="level3" data-number="6.7.3">
<h3 data-number="6.7.3" class="anchored" data-anchor-id="teste-pesaran-cd-cross-section-dependence"><span class="header-section-number">6.7.3</span> Teste Pesaran CD (cross-section dependence)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>cd <span class="ot">&lt;-</span> <span class="fu">pcdtest</span>(esp, <span class="at">data =</span> dadosp) <span class="co"># H0: ausência de dependência CS</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Insufficient number of observations in time to estimate heterogeneous
model: using within residuals</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cd)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pesaran CD test for cross-sectional dependence in panels

data:  HR ~ RD + UE
z = 0.47708, p-value = 0.6333
alternative hypothesis: cross-sectional dependence</code></pre>
</div>
</div>
</section>
<section id="teste-bsk" class="level3" data-number="6.7.4">
<h3 data-number="6.7.4" class="anchored" data-anchor-id="teste-bsk"><span class="header-section-number">6.7.4</span> Teste BSK</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>res_lmh <span class="ot">&lt;-</span> <span class="fu">bsktest</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">test =</span> <span class="st">"LMH"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>res_lm1 <span class="ot">&lt;-</span> <span class="fu">bsktest</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">test =</span> <span class="st">"LM1"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>res_lm2 <span class="ot">&lt;-</span> <span class="fu">bsktest</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">test =</span> <span class="st">"LM2"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>res_clm_mu <span class="ot">&lt;-</span> <span class="fu">bsktest</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">test =</span> <span class="st">"CLMmu"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>res_clm_lambda <span class="ot">&lt;-</span> <span class="fu">bsktest</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">test =</span> <span class="st">"CLMlambda"</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(res_lmh<span class="sc">$</span>statistic, res_lmh<span class="sc">$</span>p.value),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(res_lm1<span class="sc">$</span>statistic, res_lm1<span class="sc">$</span>p.value),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(res_lm2<span class="sc">$</span>statistic, res_lm2<span class="sc">$</span>p.value),</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(res_clm_mu<span class="sc">$</span>statistic, res_clm_mu<span class="sc">$</span>p.value),</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(res_clm_lambda<span class="sc">$</span>statistic, res_clm_lambda<span class="sc">$</span>p.value)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"test"</span>, <span class="st">"p-value"</span>), <span class="fu">c</span>(<span class="st">"LM joint"</span>,<span class="st">"LM mu"</span>,<span class="st">"LM lambda"</span>, <span class="st">"CLM mu"</span>, <span class="st">"CLM lambda"</span>))</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="at">x =</span> res, <span class="at">digits =</span> <span class="dv">5</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        LM joint    LM mu LM lambda  CLM mu CLM lambda
test     0.00067 -0.16962   0.02596 0.16929    0.01471
p-value  0.73956  1.13469   0.97929 0.86557    0.98826</code></pre>
</div>
</div>
</section>
<section id="teste-bsjk" class="level3" data-number="6.7.5">
<h3 data-number="6.7.5" class="anchored" data-anchor-id="teste-bsjk"><span class="header-section-number">6.7.5</span> Teste BSJK</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>res_c1 <span class="ot">&lt;-</span> <span class="fu">bsjktest</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">test =</span> <span class="st">"C.1"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>res_c2 <span class="ot">&lt;-</span> <span class="fu">bsjktest</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">test =</span> <span class="st">"C.2"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>res_c3 <span class="ot">&lt;-</span> <span class="fu">bsjktest</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">test =</span> <span class="st">"C.3"</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>res_j <span class="ot">&lt;-</span> <span class="fu">bsjktest</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">test =</span> <span class="st">"J"</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(res_c1<span class="sc">$</span>statistic, res_c1<span class="sc">$</span>p.value),</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(res_c2<span class="sc">$</span>statistic, res_c2<span class="sc">$</span>p.value),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(res_c3<span class="sc">$</span>statistic, res_c3<span class="sc">$</span>p.value),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(res_j<span class="sc">$</span>statistic, res_j<span class="sc">$</span>p.value)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"test"</span>, <span class="st">"p-value"</span>), <span class="fu">c</span>(<span class="st">"C.1"</span>,<span class="st">"C.2"</span>,<span class="st">"C.3"</span>, <span class="st">"J"</span>))</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="at">x =</span> res, <span class="at">digits =</span> <span class="dv">5</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            C.1      C.2      C.3   J
test    0.00089 2627.012 -55.1903 Inf
p-value 0.97618    0.000   1.0000   0</code></pre>
</div>
</div>
</section>
</section>
<section id="modelos" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="modelos"><span class="header-section-number">6.8</span> Modelos</h2>
<section id="ols" class="level3" data-number="6.8.1">
<h3 data-number="6.8.1" class="anchored" data-anchor-id="ols"><span class="header-section-number">6.8.1</span> OLS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>modOLS <span class="ot">&lt;-</span> <span class="fu">plm</span>(esp, <span class="at">data=</span>dadosp)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modOLS)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = esp, data = dadosp)

Balanced Panel: n = 55, T = 2, N = 110

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-1.6018e+01 -1.4836e+00 -9.7145e-17  1.4836e+00  1.6018e+01 

Coefficients:
   Estimate Std. Error t-value Pr(&gt;|t|)  
RD -1.70968    2.03753 -0.8391  0.40518  
UE -0.60668    0.30327 -2.0005  0.05058 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    1945.6
Residual Sum of Squares: 1778.9
R-Squared:      0.085641
Adj. R-Squared: -0.88048
F-statistic: 2.48204 on 2 and 53 DF, p-value: 0.093239</code></pre>
</div>
</div>
</section>
<section id="sar-ml" class="level3" data-number="6.8.2">
<h3 data-number="6.8.2" class="anchored" data-anchor-id="sar-ml"><span class="header-section-number">6.8.2</span> SAR (ML)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>modSAR <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">TRUE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> <span class="st">"none"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSAR)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial panel fixed effects lag model
 

Call:
spml(formula = esp, data = dadosp, listw = w1, model = "within", 
    effect = "individual", lag = TRUE, spatial.error = "none")

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-1.6051e+01 -1.5039e+00  5.0307e-16  1.5039e+00  1.6051e+01 

Spatial autoregressive coefficient:
       Estimate Std. Error t-value Pr(&gt;|t|)
lambda 0.041611   0.139414  0.2985   0.7653

Coefficients:
   Estimate Std. Error t-value Pr(&gt;|t|)   
RD -1.72265    1.41373 -1.2185 0.223029   
UE -0.60525    0.21228 -2.8512 0.004356 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>impSAR <span class="ot">&lt;-</span> <span class="fu">impacts</span>(modSAR, <span class="at">listw =</span> w1, <span class="at">time =</span> <span class="dv">2</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(impSAR, <span class="at">zstats=</span><span class="cn">TRUE</span>, <span class="at">short=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, trace):
       Direct    Indirect      Total
RD -1.7232646 -0.07418350 -1.7974481
UE -0.6054694 -0.02606439 -0.6315338
========================================================
Simulation results ( variance matrix):
========================================================
Simulated standard errors
      Direct  Indirect     Total
RD 1.3674978 0.4243478 1.5459931
UE 0.2227749 0.1095275 0.2485368

Simulated z-values:
      Direct   Indirect     Total
RD -1.341009 -0.3528343 -1.283027
UE -2.723723 -0.3622596 -2.601042

Simulated p-values:
   Direct    Indirect Total    
RD 0.1799176 0.72421  0.1994826
UE 0.0064551 0.71716  0.0092941</code></pre>
</div>
</div>
</section>
<section id="sar-gm" class="level3" data-number="6.8.3">
<h3 data-number="6.8.3" class="anchored" data-anchor-id="sar-gm"><span class="header-section-number">6.8.3</span> SAR (GM)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>modSAR_gm <span class="ot">&lt;-</span> <span class="fu">spgm</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">TRUE</span>, <span class="at">spatial.error =</span> <span class="cn">FALSE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">moments =</span> <span class="st">"weights"</span>, <span class="at">endog =</span> <span class="cn">NULL</span>, <span class="at">instruments =</span> <span class="cn">NULL</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSAR_gm)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial w2sls model 

Call:
spgm(formula = esp, data = dadosp, listw = w1, model = "within", 
    lag = TRUE, spatial.error = FALSE, moments = "weights", endog = NULL, 
    instruments = NULL)

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-1.5911e+01 -1.5530e+00 -1.1102e-16  1.5530e+00  1.5911e+01 

Spatial autoregressive coefficient:
       Estimate Std. Error t-value Pr(&gt;|t|)
lambda -0.13678    0.34803  -0.393   0.6943

Coefficients:
   Estimate Std. Error t-value Pr(&gt;|t|)   
RD -1.66704    1.44634 -1.1526 0.249078   
UE -0.61138    0.21500 -2.8436 0.004461 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">impacts</span>(modSAR_gm, <span class="at">listw =</span> w1, <span class="at">time =</span> <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, trace):
       Direct   Indirect      Total
RD -1.6731043 0.20665672 -1.4664475
UE -0.6136056 0.07579069 -0.5378149</code></pre>
</div>
</div>
</section>
<section id="sem-ml" class="level3" data-number="6.8.4">
<h3 data-number="6.8.4" class="anchored" data-anchor-id="sem-ml"><span class="header-section-number">6.8.4</span> SEM (ML)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>modSEM <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">FALSE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> <span class="st">"b"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSEM)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial panel fixed effects error model
 

Call:
spml(formula = esp, data = dadosp, listw = w1, model = "within", 
    effect = "individual", lag = FALSE, spatial.error = "b")

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-1.5976e+01 -1.5531e+00  8.8818e-16  1.5531e+00  1.5976e+01 

Spatial error parameter:
    Estimate Std. Error t-value Pr(&gt;|t|)
rho  0.12909    0.13804  0.9352   0.3497

Coefficients:
   Estimate Std. Error t-value Pr(&gt;|t|)   
RD -1.74299    1.45918 -1.1945 0.232280   
UE -0.66625    0.22026 -3.0249 0.002488 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="sem-gm" class="level3" data-number="6.8.5">
<h3 data-number="6.8.5" class="anchored" data-anchor-id="sem-gm"><span class="header-section-number">6.8.5</span> SEM (GM)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>modSEM_gm <span class="ot">&lt;-</span> <span class="fu">spgm</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">FALSE</span>, <span class="at">spatial.error =</span> <span class="cn">TRUE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">moments =</span> <span class="st">"weights"</span>, <span class="at">endog =</span> <span class="cn">NULL</span>, <span class="at">instruments =</span> <span class="cn">NULL</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSEM_gm)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial fixed effects error model (GM estimation) 

Call:
spgm(formula = esp, data = dadosp, listw = w1, model = "within", 
    lag = FALSE, spatial.error = TRUE, moments = "weights", endog = NULL, 
    instruments = NULL)

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-1.6009e+01 -1.6060e+00  2.7756e-17  1.6060e+00  1.6009e+01 

Estimated spatial coefficient, variance components and theta:
          Estimate
rho        0.12991
sigma^2_v 32.10872

Coefficients:
   Estimate Std. Error t-value Pr(&gt;|t|)   
RD -1.74318    1.47292 -1.1835 0.236618   
UE -0.66665    0.22235 -2.9982 0.002716 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="sac-ml" class="level3" data-number="6.8.6">
<h3 data-number="6.8.6" class="anchored" data-anchor-id="sac-ml"><span class="header-section-number">6.8.6</span> SAC (ML)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>modSAC <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">TRUE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> <span class="st">"b"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSAC)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial panel fixed effects sarar model
 

Call:
spml(formula = esp, data = dadosp, listw = w1, model = "within", 
    effect = "individual", lag = TRUE, spatial.error = "b")

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-1.5352e+01 -2.2314e+00  1.1102e-15  2.2314e+00  1.5352e+01 

Spatial error parameter:
    Estimate Std. Error t-value  Pr(&gt;|t|)    
rho  0.56959    0.17228  3.3062 0.0009455 ***

Spatial autoregressive coefficient:
       Estimate Std. Error t-value Pr(&gt;|t|)  
lambda -0.61788    0.26057 -2.3713  0.01773 *

Coefficients:
   Estimate Std. Error t-value  Pr(&gt;|t|)    
RD -1.27359    1.47521 -0.8633 0.3879579    
UE -0.81066    0.23375 -3.4681 0.0005242 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>impSAC <span class="ot">&lt;-</span> <span class="fu">impacts</span>(modSAC, <span class="at">listw =</span> w1, <span class="at">time =</span> <span class="dv">2</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(impSAC, <span class="at">zstats=</span><span class="cn">TRUE</span>, <span class="at">short=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, trace):
       Direct  Indirect      Total
RD -1.3659102 0.5787157 -0.7871945
UE -0.8694233 0.3683616 -0.5010617
========================================================
Simulation results ( variance matrix):
========================================================
Simulated standard errors
      Direct Indirect    Total
RD 147.74878 5605.883 5753.624
UE  62.02735 2352.592 2414.618

Simulated z-values:
       Direct   Indirect      Total
RD 0.06323979 0.07178852 0.07156909
UE 0.05940991 0.07386598 0.07349465

Simulated p-values:
   Direct  Indirect Total  
RD 0.94958 0.94277  0.94294
UE 0.95263 0.94112  0.94141</code></pre>
</div>
</div>
</section>
<section id="sac-gm" class="level3" data-number="6.8.7">
<h3 data-number="6.8.7" class="anchored" data-anchor-id="sac-gm"><span class="header-section-number">6.8.7</span> SAC (GM)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>modSAC_gm <span class="ot">&lt;-</span> <span class="fu">spgm</span>(esp, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">TRUE</span>, <span class="at">spatial.error =</span> <span class="cn">TRUE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">moments =</span> <span class="st">"weights"</span>, <span class="at">endog =</span> <span class="cn">NULL</span>, <span class="at">instruments =</span> <span class="cn">NULL</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSAC_gm)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial fixed effects  SARAR model (GM estimation) 

Call:
spgm(formula = esp, data = dadosp, listw = w1, model = "within", 
    lag = TRUE, spatial.error = TRUE, moments = "weights", endog = NULL, 
    instruments = NULL)

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.185   4.166   8.600  10.750  14.484  42.990 

Estimated spatial coefficient, variance components and theta:
          Estimate
rho        0.24997
sigma^2_v 31.37009

Spatial autoregressive coefficient:
       Estimate Std. Error t-value Pr(&gt;|t|)
lambda -0.42865    0.57903 -0.7403   0.4591

Coefficients:
   Estimate Std. Error t-value Pr(&gt;|t|)  
RD -1.49849    2.14154 -0.6997  0.48410  
UE -0.70468    0.32459 -2.1709  0.02994 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Impactos ainda não implementado</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># splm:::impacts(modSAC_gm, listw = w1, time = 2)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="especificação-com-lag" class="level3" data-number="6.8.8">
<h3 data-number="6.8.8" class="anchored" data-anchor-id="especificação-com-lag"><span class="header-section-number">6.8.8</span> Especificação com lag</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>esp_lag <span class="ot">&lt;-</span> HR <span class="sc">~</span> lag_RD <span class="sc">+</span> lag_UE</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sdm-ml" class="level3" data-number="6.8.9">
<h3 data-number="6.8.9" class="anchored" data-anchor-id="sdm-ml"><span class="header-section-number">6.8.9</span> SDM (ML)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>modSDM <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp_lag, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">TRUE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> <span class="st">"none"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSDM)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial panel fixed effects lag model
 

Call:
spml(formula = esp_lag, data = dadosp, listw = w1, model = "within", 
    effect = "individual", lag = TRUE, spatial.error = "none")

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-1.6035e+01 -7.9460e-01  7.2164e-16  7.9460e-01  1.6035e+01 

Spatial autoregressive coefficient:
       Estimate Std. Error t-value Pr(&gt;|t|)
lambda 0.079183   0.140775  0.5625   0.5738

Coefficients:
       Estimate Std. Error t-value Pr(&gt;|t|)
lag_RD  2.08471    2.67145  0.7804   0.4352
lag_UE  0.28441    0.34111  0.8338   0.4044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>impSDM <span class="ot">&lt;-</span> <span class="fu">impacts</span>(modSDM, <span class="at">listw =</span> w1, <span class="at">time =</span> <span class="dv">2</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(impSDM, <span class="at">zstats=</span><span class="cn">TRUE</span>, <span class="at">short=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, trace):
          Direct   Indirect     Total
lag_RD 2.0874286 0.17655424 2.2639828
lag_UE 0.2847807 0.02408669 0.3088674
========================================================
Simulation results ( variance matrix):
========================================================
Simulated standard errors
          Direct   Indirect     Total
lag_RD 2.3743758 0.52353230 2.5983533
lag_UE 0.3288402 0.08001749 0.3610444

Simulated z-values:
          Direct  Indirect     Total
lag_RD 0.9133306 0.3098754 0.8970373
lag_UE 0.9443251 0.3352516 0.9343948

Simulated p-values:
       Direct  Indirect Total 
lag_RD 0.36107 0.75666  0.3697
lag_UE 0.34500 0.73744  0.3501</code></pre>
</div>
</div>
</section>
<section id="sdem-ml" class="level3" data-number="6.8.10">
<h3 data-number="6.8.10" class="anchored" data-anchor-id="sdem-ml"><span class="header-section-number">6.8.10</span> SDEM (ML)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>modSDEM <span class="ot">&lt;-</span> <span class="fu">spml</span>(esp_lag, <span class="at">data =</span> dadosp, <span class="at">listw =</span> w1, <span class="at">lag =</span> <span class="cn">FALSE</span>, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">effect =</span> <span class="st">"individual"</span>, <span class="at">spatial.error =</span> <span class="st">"b"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSDEM)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial panel fixed effects error model
 

Call:
spml(formula = esp_lag, data = dadosp, listw = w1, model = "within", 
    effect = "individual", lag = FALSE, spatial.error = "b")

Residuals:
    Min.  1st Qu.   Median  3rd Qu.     Max. 
-15.8759  -1.1474   0.0000   1.1474  15.8759 

Spatial error parameter:
    Estimate Std. Error t-value Pr(&gt;|t|)
rho  0.12983    0.13799  0.9409   0.3468

Coefficients:
       Estimate Std. Error t-value Pr(&gt;|t|)
lag_RD  2.84568    2.86474  0.9933   0.3205
lag_UE  0.39960    0.36624  1.0911   0.2752</code></pre>
</div>
</div>
</section>
<section id="slx-ml" class="level3" data-number="6.8.11">
<h3 data-number="6.8.11" class="anchored" data-anchor-id="slx-ml"><span class="header-section-number">6.8.11</span> SLX (ML)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>modSLX <span class="ot">&lt;-</span> <span class="fu">plm</span>(esp_lag, <span class="at">data =</span> dadosp, <span class="at">model =</span> <span class="st">"within"</span>, <span class="at">spatial.error =</span> <span class="st">"none"</span>, <span class="at">lag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSLX)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = esp_lag, data = dadosp, model = "within", spatial.error = "none", 
    lag = FALSE)

Balanced Panel: n = 55, T = 2, N = 110

Residuals:
       Min.     1st Qu.      Median     3rd Qu.        Max. 
-1.6021e+01 -9.3583e-01  1.0061e-16  9.3583e-01  1.6021e+01 

Coefficients:
       Estimate Std. Error t-value Pr(&gt;|t|)
lag_RD  1.79783    3.85166  0.4668   0.6426
lag_UE  0.23564    0.49172  0.4792   0.6337

Total Sum of Squares:    1945.6
Residual Sum of Squares: 1933.2
R-Squared:      0.0063674
Adj. R-Squared: -1.0435
F-statistic: 0.169816 on 2 and 53 DF, p-value: 0.84428</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./gwr.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regressão Ponderada Geograficamente (GWR)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">Referências</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>