[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Econometria Espacial aplicada com R",
    "section": "",
    "text": "Apresentação\nEste livro on-line apresenta uma introdução a Econometria Espacial aplicada com R. Recomendamos como referência o livro Econometria Espacial aplicada (Almeida 2012).\n\nRaphael Saldanha é geógrafo, mestre em saúde pública, doutor em Informação e Comunicação em Saúde, postdoc researcher no Inria (Institut national de recherche en sciences et technologies du numérique, France).\nEduardo Almeida é economista, mestre e doutor em Economia, postdoc pela Escola Superior de Agricultura “Luiz de Queiroz”, professor adjunto da Faculdade de Economia da Universidade Federal de Juiz de Fora (UFJF) desde 2005.\n\n\n\n\nAlmeida, Eduardo. 2012. Econometria espacial aplicada. Campinas: Alínea."
  },
  {
    "objectID": "intro_r.html",
    "href": "intro_r.html",
    "title": "1  Introdução ao R",
    "section": "",
    "text": "2 Comandos básicos\nA interface do R não é recomendada para a criação de banco de dados. Como já existem centenas de opções de softwares de qualidade e gratuitos para este fim, os bancos de dados podem ser criados em outros softwares como o Excel e importados posteriormente para o R.\nExistem diversos pacotes para ler aquivos de banco de dados no R, como DBF, SAV, Stata e etc. Mas a forma mais segura e recomendada é exportar os dados no formato CSV para ser importados no R.\nAbaixo temos uma lista comandos para obter estatísticas básicas com o R e alguns gráficos.\n# Importar o arquivo 'notas.csv'\ndados &lt;- read.csv2(file = \"data/notas.csv\", header = TRUE)\n\n# Média\nmean(dados$nota)\n\n[1] 25.22667\n\n# Mediana\nmedian(dados$nota)\n\n[1] 26.3\n\n# Variância\nvar(dados$nota)\n\n[1] 144.4083\n\n# Desvio padrão\nsd(dados$nota)\n\n[1] 12.017\n\n# Valor máximo\nmax(dados$nota)\n\n[1] 40.9\n\n# Valor mínimo\nmin(dados$nota)\n\n[1] 10\n\n# Amplitude\nrange(dados$nota)\n\n[1] 10.0 40.9\n\n# Coeficiente de variação\nsd(dados$nota)/mean(dados$nota)\n\n[1] 0.476361\n\n# Quartis\nquantile(dados$nota)\n\n    0%    25%    50%    75%   100% \n10.000 16.250 26.300 32.795 40.900 \n\n# Sumário\nsummary(dados$nota)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  10.00   16.25   26.30   25.23   32.80   40.90 \n\n# Boxplot\nboxplot(dados$nota)\n\n\n\n# Histograma\nhist(dados$nota, main = \"Boxplot\", xlab = \"Classes\", ylab = \"Frequências\", col = \"tan\")"
  },
  {
    "objectID": "intro_r.html#instalando-o-r",
    "href": "intro_r.html#instalando-o-r",
    "title": "1  Introdução ao R",
    "section": "1.1 Instalando o R",
    "text": "1.1 Instalando o R\nUma copia do R pode ser obtida gratuitamente no site https://cran.r-project.org/. Atente para o sistema operacional antes de efetuar o download."
  },
  {
    "objectID": "intro_r.html#rstudio",
    "href": "intro_r.html#rstudio",
    "title": "1  Introdução ao R",
    "section": "1.2 RStudio",
    "text": "1.2 RStudio\nApós a instalação do R, ele já pode ser usado através de sua interface gráfica padrão. Contudo, é comum a utilização de interfaces de desenvolvimento (IDE - Integrated Development Environment) criada por terceiros.\nNeste material, iremos utilizar uma IDE chamada RStudio. Ela pode ser obtida gratuitamente no site https://www.rstudio.com/products/RStudio/.\nApós instalar e abrir o RStudio, você verá na tela duas áreas principais. A primeira é chamada de script e a segunda de console.\nA área de script é onde digitamos os comandos utilizados no R. Após preparar um comando, ele é executado pressionando o botão run na interface ou pressionando Ctrl + r no teclado. Ao executar um comando, ele será reproduzido na área do console e seu resultado virá logo abaixo.\nO script é um arquivo de texto que pode ser salvo e reaproveitado posteriormente. É comum encontrarmos em scripts do R linhas precedidas com o caractere #. Este simbolo indica um comentário, ou seja, um texto que não será interpretado como um comando no R.\n\n1.2.1 Que documento é este?\nO script é a forma mais tradicional de criar códigos para o R, mas ele tem algumas limitações. Por ser apenas um arquivo de texto simples, ele não é capaz de armazenar os resultados produzidos pelo R, guardar figuras e ser esteticamente apresentável.\nPor estes motivos e na onda da ciência reprodutível, foi criado o R Notebook. Um notebook é uma uma espécie de script versão 2.0, onde é possível escrever comentários com formatação, inserir código do R e ver o seu resultado logo abaixo. E a melhor parte: um notebook pode ser exportado para HTML ou PDF facilmente, facilitando o envio de pesquisas feitas com o R.\nEste arquivo que você está visualizando é um R Notebook. Os asteríscos e alguns símbolos que você está vendo no texto é uma forma de formatação chamada Markdown. Por exemplo, dois asterísticos entre uma palavra fazem com que ela fique em negrito. Neste link tem um guia desta linguagem.\nPara ver como está ficando o seu notebook, clique no botão Preview. Uma página irá aparecer com a pré-visualização do seu notebook. Para exportar para HTML ou PDF, use a seta para abaixo ao lado do botão (Knit to…)."
  },
  {
    "objectID": "intro_r.html#operações-matemáticas",
    "href": "intro_r.html#operações-matemáticas",
    "title": "1  Introdução ao R",
    "section": "2.1 Operações matemáticas",
    "text": "2.1 Operações matemáticas\nOs primeiros comandos no R são funções muito básicas para operações matemáticas. A parte verde abaixo é um chunk de código R no notebook. Isto indica ao RStudio que esta parte do texto deve ser intepretada como código R e não como texto. Para executar um chunk, pressione Ctrl + Shift + Enter.\n\n# Soma\n2+2\n\n[1] 4\n\n# Subtração\n4-2\n\n[1] 2\n\n# Multiplicação\n2*3\n\n[1] 6\n\n# Divisão\n4/2\n\n[1] 2\n\n# Exponenciação\n2^3\n\n[1] 8\n\n\nSe tudo correu bem, você deve ver acima o resultado das operações. Use o preview do notebook para ver como está ficando o resultado do documento.\n\n2.1.1 Sua vez\nRealize a seguinte operação no R \\(((2+3(5))/10)^2\\).\n\n\nCódigo\n((2+3*5)/10)^2\n\n\n[1] 2.89\n\n\nResultado correto: 2,89."
  },
  {
    "objectID": "intro_r.html#funções",
    "href": "intro_r.html#funções",
    "title": "1  Introdução ao R",
    "section": "2.2 Funções",
    "text": "2.2 Funções\nFunções são comandos que apresentam resultados com base em um ou mais argumentos. Teste os exemplos abaixo.\n\n# Raiz quadrada\nsqrt(x=9)\n\n[1] 3\n\n# Combinação de 10 elementos tomados 2 a 2\nchoose(n=10, k=2)\n\n[1] 45\n\n# e^x\nexp(2)\n\n[1] 7.389056\n\n# Logarítmo natural\nlog(1)\n\n[1] 0\n\n\n\n2.2.1 Sua vez\nCalcule a raiz quadrada do logaritmo de 10 no R.\n\n\nCódigo\nsqrt(log(x = 10))\n\n\n[1] 1.517427\n\n\nResultado correto: 1,51."
  },
  {
    "objectID": "intro_r.html#objetos",
    "href": "intro_r.html#objetos",
    "title": "1  Introdução ao R",
    "section": "2.3 Objetos",
    "text": "2.3 Objetos\nOs resultados de operações simples e funções no R podem ser armazenados na memória para utilização posterior através de objetos.\nNa linguagem R, objetos são abstrações na memória que podem conter desde um simples número até complexos bancos de dados. Estude os comandos abaixo.\n\n# Criar o objeto x\nx &lt;- 2\n\n# Imprimir o objeto x\nx\n\n[1] 2\n\n# Operações com o objeto x\nx^2\n\n[1] 4\n\nx+x\n\n[1] 4\n\n# Apagar o objeto x\nrm(x)\n\n# Criar o vetor y\ny &lt;- c(2, 5, 10, 11.3, 12)\n\n# Imprimir o vetor y\ny\n\n[1]  2.0  5.0 10.0 11.3 12.0\n\n# Elevar o vetor y ao quadrado\ny^2\n\n[1]   4.00  25.00 100.00 127.69 144.00\n\n# Apagar o vetor y\nrm(y)\n\n# Criar o vetor 'notas'\nnotas &lt;- c(60, 50, 20, 50, 90)\n\n# Ordenar o vetor 'notas'\nnotas &lt;- sort(notas)\n\n# Imprimir o vetor 'notas'\nnotas\n\n[1] 20 50 50 60 90\n\n\n\n2.3.1 Sua vez\nCrie um objeto chamado dados com os valores {5, 7, 12.7, 13, 15}. Eleve ao quadrado e obtenha o resultado da soma dos valores elevados com a função sum(x).\n\n\nCódigo\ndados &lt;- c(5, 7, 12.7, 13, 15)\nsum(dados^2)\n\n\n[1] 629.29\n\n\nResultado correto: 629,29."
  },
  {
    "objectID": "intro_r.html#operadores-lógicos",
    "href": "intro_r.html#operadores-lógicos",
    "title": "1  Introdução ao R",
    "section": "2.4 Operadores lógicos",
    "text": "2.4 Operadores lógicos\nEstes operados verificam afirmações de lógica, veja os comandos abaixo.\n\n# Igualdade\n2 == 2\n\n[1] TRUE\n\n2 == 5\n\n[1] FALSE\n\n\"a\" == \"a\"\n\n[1] TRUE\n\n\"a\" == 'A'\n\n[1] FALSE\n\n# Maior\n2 &gt; 3\n\n[1] FALSE\n\n2 &gt;= 3\n\n[1] FALSE\n\n# Menor\n2 &lt; 4\n\n[1] TRUE\n\n2 &lt;= 1\n\n[1] FALSE\n\nc(1,2,2,4,7,10) &lt; 7\n\n[1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE"
  },
  {
    "objectID": "intro_r.html#arquivos-csv",
    "href": "intro_r.html#arquivos-csv",
    "title": "1  Introdução ao R",
    "section": "3.1 Arquivos CSV",
    "text": "3.1 Arquivos CSV\nPara importar este arquivo CSV no R, teste o código abaixo. Se não funcionar, tente trocar “/” por “\\”.\n\n# Importar o arquivo 'notas.csv'\ndados &lt;- read.csv2(file = \"data/notas.csv\", header = TRUE)\n\nAtenção para os nomes das variáveis! Evite a utilização de nomes muito longos, caracteres especiais e acentos.\nApós importar um banco de dados, verifique se tudo correu bem com estes comandos.\n\n# Estrutura do objeto\nstr(dados)\n\n'data.frame':   6 obs. of  3 variables:\n $ id  : int  1 2 3 4 5 6\n $ nome: chr  \"Maria\" \"João\" \"José\" \"Maria\" ...\n $ nota: num  10 20 32.6 15 40.9 ...\n\n# Listar os nomes das variáveis\nnames(dados)\n\n[1] \"id\"   \"nome\" \"nota\"\n\n# Imprimir as seis primeiras linhas\nhead(dados)\n\n  id    nome  nota\n1  1   Maria 10.00\n2  2    João 20.00\n3  3    José 32.60\n4  4   Maria 15.00\n5  5 Gustavo 40.90\n6  6 Alfredo 32.86\n\n# Imprimir as seis últimas linhas\ntail(dados)\n\n  id    nome  nota\n1  1   Maria 10.00\n2  2    João 20.00\n3  3    José 32.60\n4  4   Maria 15.00\n5  5 Gustavo 40.90\n6  6 Alfredo 32.86\n\n\nPara acessar uma variável específica:\n\ndados$nota \n\n[1] 10.00 20.00 32.60 15.00 40.90 32.86\n\n\n\n3.1.1 Sua vez\nImporte o mesmo arquivo do exemplo mas com o argumento header = FALSE. Execute o comando str(x) e veja o que mudou.\n\n\nCódigo\ndados &lt;- read.csv2(file = \"data/notas.csv\", header = TRUE)\nstr(dados)\n\n\n'data.frame':   6 obs. of  3 variables:\n $ id  : int  1 2 3 4 5 6\n $ nome: chr  \"Maria\" \"João\" \"José\" \"Maria\" ...\n $ nota: num  10 20 32.6 15 40.9 ..."
  },
  {
    "objectID": "aede.html#leitura-do-shapefile",
    "href": "aede.html#leitura-do-shapefile",
    "title": "2  Análise Exploratória de Dados Espaciais (AED-E)",
    "section": "2.1 Leitura do shapefile",
    "text": "2.1 Leitura do shapefile\nPara a leitura de arquivos shapefile no R, precisamos usar alguns pacotes. Após a instalação dos pacotes, use os seguintes comandos.\n\n# Pacotes\nlibrary(sf)\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(sp)\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n# Abra o arquivo 'gm10.shp'\nfp_mg.shp &lt;- st_read(\"data/FP_MG.shp\", options = \"ENCODING=WINDOWS-1252\")\n\noptions:        ENCODING=WINDOWS-1252 \nReading layer `FP_MG' from data source \n  `/home/rfsaldanha/projects/ecoespacial/data/FP_MG.shp' using driver `ESRI Shapefile'\n\n\nWarning in CPL_read_ogr(dsn, layer, query, as.character(options), quiet, : GDAL\nMessage 1: organizePolygons() received an unexpected geometry.  Either a\npolygon with interior rings, or a polygon with less than 4 points, or a\nnon-Polygon geometry.  Return arguments as a collection.\n\n\nSimple feature collection with 66 features and 41 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -51.06258 ymin: -22.91696 xmax: -39.85724 ymax: -14.23725\nCRS:           NA\n\nfp_mg.shp &lt;- st_make_valid(fp_mg.shp)\nfp_mg.shp &lt;- as_Spatial(fp_mg.shp)\n# encoding = \"UTF-8\"\n\n# Plotar o mapa\nplot(fp_mg.shp)"
  },
  {
    "objectID": "aede.html#atributos-do-shapefile",
    "href": "aede.html#atributos-do-shapefile",
    "title": "2  Análise Exploratória de Dados Espaciais (AED-E)",
    "section": "2.2 Atributos do shapefile",
    "text": "2.2 Atributos do shapefile\nPodemos ver a tabela de atributos do shapefile desta forma.\n\nhead(fp_mg.shp@data)\n\n  CODMIC      NOMMIC      Q     AC     AP    K   R  RP RNP DRNP   F    AREA\n1     41     Aimorés 134310  60132  60132 1833 363 155 208   25  84  8354.1\n2     49     Alfenas 564476 113253 113253 7203 312 273  39    8   1  4998.9\n3     14    Almenara  84631  20737  20737  783 383 150 233   15   1 15504.5\n4     55 Andrelândia  59164  27764  27764 1154 264 200  64   13 227  5047.3\n5     12     Araçuaí 159897  36779  36779  552 315 162 153   15   1 10299.4\n6     23       Araxá 495102 160580 160643 7582 645 564  81    6 327 14145.6\n  ESCTOT POPTOT    LP   ACP    KP   ETOTP   DRNPP       FP     RNPP      RPP\n1    347 152658 0.111 0.394 0.012 0.00227 0.00016 0.000550 0.001363 0.001015\n2    229 179366 0.111 0.631 0.040 0.00128 0.00004 0.000006 0.000217 0.001522\n3    384 213342 0.047 0.097 0.004 0.00180 0.00007 0.000005 0.001092 0.000703\n4    191  70783 0.037 0.392 0.016 0.00270 0.00018 0.003207 0.000904 0.002826\n5    327 143468 0.143 0.256 0.004 0.00228 0.00010 0.000007 0.001066 0.001129\n6    182 158275 0.043 1.015 0.048 0.00115 0.00004 0.002066 0.000512 0.003563\n       R_P       QP   X_COORD   Y_COORD CMICRO     VP      VPP    LA   LM     L\n1 0.002378 0.879810 -41.38876 -19.53116  31041  78349 0.513232 42737 3997 46734\n2 0.001739 3.147062 -46.01852 -21.37551  31049 216064 1.204598 33737 1118 34855\n3 0.001795 0.396692 -40.65978 -16.35385  31014  40164 0.188261 30920 4259 35179\n4 0.003730 0.835850 -44.44562 -21.95045  31055  42360 0.598449 15135  908 16043\n5 0.002196 1.114513 -41.87023 -17.00645  31012  28864 0.201188 45015 7069 52084\n6 0.004075 3.128112 -46.95948 -19.59779  31023 197010 1.244732 23442 1488 24930\n  CO_RUR  NU_RUR   CO_TOT      EER      K_L VEG TEMP PREC     KL\n1   4937 1314045  4402218 0.003757 0.039222   1    4    1 0.0392\n2   6736 2957879 12228817 0.002277 0.206656   2    2    3 0.2067\n3   1431  282421  3363297 0.005067 0.022258   2    5    1 0.0223\n4   1717  498819  2819950 0.003442 0.071932   2    1    4 0.0719\n5   1431  365829  2404595 0.003912 0.010598   3    4    1 0.0106\n6   4357 1476959 14220985 0.002950 0.304132   1    2    4 0.3041"
  },
  {
    "objectID": "aede.html#mapa",
    "href": "aede.html#mapa",
    "title": "2  Análise Exploratória de Dados Espaciais (AED-E)",
    "section": "2.3 Mapa",
    "text": "2.3 Mapa\nPodemos produzir um mapa colorido com os seguintes comandos.\n\np &lt;- colorRampPalette(c(\"white\", \"blue\"))(128)\npalette(p)\nplot(fp_mg.shp, col = fp_mg.shp@data$Q)\n\n\n\n\n\n2.3.1 Sua vez\nFaça um mapa com a variável AC com a cor vermelha.\n\n\nCódigo\np &lt;- colorRampPalette(c(\"yellow\", \"red\"))(128)\npalette(p)\nplot(fp_mg.shp, col = fp_mg.shp@data$AC)"
  },
  {
    "objectID": "matrizes.html#leitura-do-shapefile",
    "href": "matrizes.html#leitura-do-shapefile",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.1 Leitura do shapefile",
    "text": "3.1 Leitura do shapefile\nPara a leitura de arquivos shapefile no R, precisamos usar alguns pacotes. Após a instalação dos pacotes, use os seguintes comandos.\n\n# Pacotes\nlibrary(sf)\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(sp)\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n# Abra o arquivo 'gm10.shp'\nfp_mg.shp &lt;- st_read(\"data/FP_MG.shp\", options = \"ENCODING=WINDOWS-1252\")\n\noptions:        ENCODING=WINDOWS-1252 \nReading layer `FP_MG' from data source \n  `/home/rfsaldanha/projects/ecoespacial/data/FP_MG.shp' using driver `ESRI Shapefile'\n\n\nWarning in CPL_read_ogr(dsn, layer, query, as.character(options), quiet, : GDAL\nMessage 1: organizePolygons() received an unexpected geometry.  Either a\npolygon with interior rings, or a polygon with less than 4 points, or a\nnon-Polygon geometry.  Return arguments as a collection.\n\n\nSimple feature collection with 66 features and 41 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -51.06258 ymin: -22.91696 xmax: -39.85724 ymax: -14.23725\nCRS:           NA\n\nfp_mg.shp &lt;- st_make_valid(fp_mg.shp)\nfp_mg.shp &lt;- as_Spatial(fp_mg.shp)\n\n# Plotar o mapa\nplot(fp_mg.shp)\n\n\n\n\nPara a criação de matrizes de vizinhos espaciais, iremos utilizar o pacote spdep.\n\n# Pacote\nlibrary(spdep)\n\nLoading required package: spData\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\n\n\n3.1.1 Matriz queen e rook\n\n# Matriz queen\nw1 &lt;- nb2listw(poly2nb(fp_mg.shp, queen = TRUE))\nsummary(w1)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 336 \nPercentage nonzero weights: 7.713499 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 2  9 12 16 16  8  2  1 \n2 least connected regions:\n29 38 with 2 links\n1 most connected region:\n65 with 9 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 27.58858 269.8006\n\n# Matriz queen 2ª ordem\nw1.2 &lt;- nb2listw(nblag_cumul(nblag(poly2nb(fp_mg.shp, queen = TRUE), maxlag = 2)))\n\n# Matrix queen padronizada na linha\nw1.w &lt;- nb2listw(poly2nb(fp_mg.shp, queen=TRUE), style=\"W\")\nsummary(w1.w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 336 \nPercentage nonzero weights: 7.713499 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 2  9 12 16 16  8  2  1 \n2 least connected regions:\n29 38 with 2 links\n1 most connected region:\n65 with 9 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 27.58858 269.8006\n\n# Matriz rook\nw2 &lt;- nb2listw(poly2nb(fp_mg.shp, queen = FALSE))\nsummary(w2)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 332 \nPercentage nonzero weights: 7.621671 \nAverage number of links: 5.030303 \nLink number distribution:\n\n 2  3  4  5  6  7  8 \n 2  9 12 18 15  7  3 \n2 least connected regions:\n29 38 with 2 links\n3 most connected regions:\n12 26 65 with 8 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 27.82221 269.6778\n\n# Matriz rook padronizada globalmente\nw2.c &lt;- nb2listw(poly2nb(fp_mg.shp, queen = FALSE), style = \"C\")\nsummary(w2.c)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 332 \nPercentage nonzero weights: 7.621671 \nAverage number of links: 5.030303 \nLink number distribution:\n\n 2  3  4  5  6  7  8 \n 2  9 12 18 15  7  3 \n2 least connected regions:\n29 38 with 2 links\n3 most connected regions:\n12 26 65 with 8 links\n\nWeights style: C \nWeights constants summary:\n   n   nn S0       S1      S2\nC 66 4356 66 26.24096 285.489\n\n\n\n\n3.1.2 Distância inversa\n\ncoords &lt;- coordinates(fp_mg.shp)\nnb &lt;- dnearneigh(coords, 0, 1000)\ndlist &lt;- nbdists(nb, coords)\ndlist &lt;- lapply(dlist, function(x) 1/x^2)\nw3 &lt;- nb2listw(nb, glist=dlist)\nsummary(w3)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 4290 \nPercentage nonzero weights: 98.48485 \nAverage number of links: 65 \nLink number distribution:\n\n65 \n66 \n66 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n66 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 8.369751 267.6908\n\n# Distância inversa padronizada pelo número de vizinhos\nw3.u &lt;- nb2listw(nb, glist=dlist, style=\"U\")\nsummary(w3.u)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 4290 \nPercentage nonzero weights: 98.48485 \nAverage number of links: 65 \nLink number distribution:\n\n65 \n66 \n66 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n66 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n\nWeights style: U \nWeights constants summary:\n   n   nn S0          S1         S2\nU 66 4356  1 0.002368187 0.07316268\n\n\nPara ver mais opções, veja a ajuda deste comando: ?nb2listw\n\n\n3.1.3 Matriz de k-vizinhos espaciais\nA escolha do número ideal de \\(k\\) vizinhos será realizada testando-se vários \\(k\\) e utilizando-se o que retornou o maior valor para a estatística \\(I\\) de Moran significativo.\n\n# Número de permutações\nper &lt;- 999\n\n# Número máximo de k vizinhos testados\nkv &lt;- 20\n\n# Nome dos registros\nIDs &lt;- row.names(fp_mg.shp@data)\n\n# Criação da tabela que irá receber a estatística I de Moran e significância para cada k testado\nres.pesos &lt;- data.frame(k=numeric(),i=numeric(),valorp=numeric())\n\n# Início do loop\nfor(k in 1:kv)\n{\n  # Armazenando número k atual\n  res.pesos[k,1] &lt;- k\n  # Calculando o I e significância para o k atual\n  moran.k &lt;- moran.mc(fp_mg.shp@data$Q,\n                      listw=nb2listw(knn2nb(\n                      knearneigh(coords, k=k),\n                      row.names=IDs),style=\"B\"),\n                      nsim=per)\n  # Armazenando o valor I para o k atual\n  res.pesos[k,2] &lt;- moran.k$statistic\n  # Armazenando o p-value para o k atual\n  res.pesos[k,3] &lt;- moran.k$p.value\n}\n\n# Ver a tabela de k vizinhos, I de Moran e significância\nres.pesos\n\n    k         i valorp\n1   1 0.5228074  0.002\n2   2 0.3875458  0.002\n3   3 0.4531317  0.001\n4   4 0.4199339  0.001\n5   5 0.3944831  0.001\n6   6 0.3595862  0.001\n7   7 0.3461349  0.001\n8   8 0.3286129  0.001\n9   9 0.3064023  0.001\n10 10 0.3157462  0.001\n11 11 0.3028398  0.001\n12 12 0.2942354  0.001\n13 13 0.2791438  0.001\n14 14 0.2620697  0.001\n15 15 0.2541920  0.001\n16 16 0.2429784  0.001\n17 17 0.2320723  0.001\n18 18 0.2213339  0.001\n19 19 0.2117356  0.001\n20 20 0.2017898  0.001\n\n# Sendo todos significativos, iremos usar o k que retornou o maior valor I\nmaxi &lt;- which.max(res.pesos[,2])\n\n# Criação da matriz usando o k escolhido\nw5 &lt;- nb2listw(knn2nb(knearneigh(coords, k=maxi),row.names=IDs),style=\"B\")\nsummary(w5)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 66 \nPercentage nonzero weights: 1.515152 \nAverage number of links: 1 \nNon-symmetric neighbours list\nLink number distribution:\n\n 1 \n66 \n66 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 1 link\n66 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 1 link\n\nWeights style: B \nWeights constants summary:\n   n   nn S0 S1  S2\nB 66 4356 66 98 308"
  },
  {
    "objectID": "matrizes.html#autocorrelação-espacial-global",
    "href": "matrizes.html#autocorrelação-espacial-global",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.2 Autocorrelação espacial global",
    "text": "3.2 Autocorrelação espacial global\n\n3.2.1 I de Moran\n\nmoran.test(fp_mg.shp@data$Q, listw = w5)\n\n\n    Moran I test under randomisation\n\ndata:  fp_mg.shp@data$Q  \nweights: w5    \n\nMoran I statistic standard deviate = 3.8645, p-value = 5.566e-05\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n       0.52280745       -0.01538462        0.01939499 \n\nmoran.mc(fp_mg.shp@data$Q, listw = w5, nsim = 999)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  fp_mg.shp@data$Q \nweights: w5  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.52281, observed rank = 998, p-value = 0.002\nalternative hypothesis: greater\n\n\n\n\n3.2.2 C de Geary\n\ngeary.test(fp_mg.shp@data$Q, listw = w5)\n\n\n    Geary C test under randomisation\n\ndata:  fp_mg.shp@data$Q \nweights: w5 \n\nGeary C statistic standard deviate = 2.6176, p-value = 0.004428\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n       0.46130049        1.00000000        0.04235442 \n\ngeary.mc(fp_mg.shp@data$Q, listw = w5, nsim = 999)\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  fp_mg.shp@data$Q \nweights: w5 \nnumber of simulations + 1: 1000 \n\nstatistic = 0.4613, observed rank = 6, p-value = 0.006\nalternative hypothesis: greater\n\n\n\n\n3.2.3 G de Getis-Ord\n\nglobalG.test(as.vector(scale(fp_mg.shp@data$Q, center = FALSE)), listw = w5, B1correct = TRUE)\n\n\n    Getis-Ord global G statistic\n\ndata:  as.vector(scale(fp_mg.shp@data$Q, center = FALSE)) \nweights: w5 \n\nstandard deviate = 3.2113, p-value = 0.0006607\nalternative hypothesis: greater\nsample estimates:\nGlobal G statistic        Expectation           Variance \n      3.071155e-02       1.538462e-02       2.277991e-05"
  },
  {
    "objectID": "matrizes.html#autocorrelação-espacial-local",
    "href": "matrizes.html#autocorrelação-espacial-local",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.3 Autocorrelação espacial local",
    "text": "3.3 Autocorrelação espacial local\n\n3.3.1 G de Gettis-Ords\n\nlg1 &lt;- localG(fp_mg.shp@data$Q, listw = w5)\nsummary(lg1)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.69900 -0.53552 -0.44190 -0.04454 -0.06779  4.21616 \n\nhist(lg1)\n\n\n\n\n\n\n3.3.2 I de Moran\n\n# Cálculo\nlm1 &lt;- localmoran(fp_mg.shp@data$Q, listw = w5)\nsummary(lm1)\n\n       Ii                E.Ii                Var.Ii               Z.Ii        \n Min.   :-0.83956   Min.   :-2.629e-01   Min.   : 0.000197   Min.   :-4.1007  \n 1st Qu.: 0.07066   1st Qu.:-4.908e-03   1st Qu.: 0.089934   1st Qu.: 0.2869  \n Median : 0.20075   Median :-3.384e-03   Median : 0.222559   Median : 0.4695  \n Mean   : 0.52281   Mean   :-1.538e-02   Mean   : 0.860585   Mean   : 0.3957  \n 3rd Qu.: 0.27959   3rd Qu.:-1.365e-03   3rd Qu.: 0.322327   3rd Qu.: 0.5559  \n Max.   :11.31579   Max.   :-2.980e-06   Max.   :12.789972   Max.   : 4.2162  \n Pr(z != E(Ii))     \n Min.   :0.0000248  \n 1st Qu.:0.5703228  \n Median :0.6347460  \n Mean   :0.6120352  \n 3rd Qu.:0.7541930  \n Max.   :0.9892306  \n\n# Quantos são significativos?\nlm1 &lt;- as.data.frame(lm1)\ntable(lm1$`Pr(z &gt; 0)` &lt; 0.05)\n\n&lt; table of extent 0 &gt;"
  },
  {
    "objectID": "matrizes.html#diagrama-de-dispersão-de-moran",
    "href": "matrizes.html#diagrama-de-dispersão-de-moran",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.4 Diagrama de dispersão de Moran",
    "text": "3.4 Diagrama de dispersão de Moran\n\nmoran.plot(fp_mg.shp@data$Q, listw = w5)\n\n\n\n\n\n3.4.1 Sua vez\nCalcule o I de Moran local usando a matriz de vizinhança w1 para a variável ACe verifique quantas regiões são significativas. Depois, faça o diagrama de dispersão.\n\n\nCódigo\nhead(localmoran(fp_mg.shp@data$AC, listw = w1))\n\n\n            Ii          E.Ii       Var.Ii       Z.Ii Pr(z != E(Ii))\n1  0.008331081 -2.648711e-05 0.0004165402  0.4094977   0.6821744760\n2  0.849842734 -2.085884e-02 0.2071096162  1.9132389   0.0557174771\n3  0.529839200 -9.632289e-03 0.1500236654  1.3927995   0.1636804207\n4 -0.037360854 -6.355270e-03 0.0781466481 -0.1109136   0.9116848748\n5  0.276052134 -3.145335e-03 0.0317953356  1.5657765   0.1174009499\n6  2.695852306 -7.209967e-02 0.6784210807  3.3605386   0.0007779067\n\n\nCódigo\nmoran.plot(fp_mg.shp@data$AC, listw = w1)"
  },
  {
    "objectID": "matrizes.html#lisa-map",
    "href": "matrizes.html#lisa-map",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.5 LISA map",
    "text": "3.5 LISA map\nO R não tem uma função pronta para criar um mapa LISA, então nós criamos abaixo nossa própria função: lisaplot. Depois de declarada, uma função pode ser usada repetidamente variando seus argumentos.\nRode o código abaixo.\n\nlisaplot &lt;- function(shapefile, values, listw, pval = 0.05){\n  require(spdep)\n  \n  svalues &lt;- as.vector(scale(values, scale = FALSE))\n  lag_svalues &lt;- spdep::lag.listw(listw, svalues)\n  locm &lt;- spdep::localmoran(values, listw)\n  sig &lt;- rep(0, length(values))\n  \n  sig[(svalues &gt;= 0 & lag_svalues &gt;= 0) & (locm[,5] &lt;= pval)] &lt;- 1\n  sig[(svalues &lt;= 0 & lag_svalues &lt;= 0) & (locm[,5] &lt;= pval)] &lt;- 2\n  sig[(svalues &gt;= 0 & lag_svalues &lt;= 0) & (locm[,5] &lt;= pval)] &lt;- 3\n  sig[(svalues &lt;= 0 & lag_svalues &gt;= 0) & (locm[,5] &lt;= pval)] &lt;- 4\n  sig[locm[,5] &gt; pval] &lt;- 5\n  \n  breaks &lt;- seq(1, 5, 1)\n  labels &lt;- c(\"Alto-Alto\", \"Baixo-Baixo\", \"Alto-Baixo\", \"Baixo-Alto\", \"N. Sig.\")\n  np &lt;- findInterval(sig, breaks)\n  colors &lt;- c(\"red\", \"blue\", \"lightpink\", \"skyblue2\", \"white\")\n  plot(shapefile, col = colors[np])\n  mtext(\"LISA\", cex = 1.5, side = 3, line = 1)\n  legend(\"topleft\", legend = labels, fill = colors, bty = \"n\")\n}\n\nE o LISA para a variável TEMP.\n\nlisaplot(fp_mg.shp, fp_mg.shp@data$TEMP, w1)\n\n\n\n\n\n3.5.1 Sua vez\nFaça o LISA para a variável AP com a matriz w1.\n\n\nCódigo\nlisaplot(fp_mg.shp, fp_mg.shp@data$AP, w1)"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "Referências",
    "section": "",
    "text": "Almeida, Eduardo. 2012. Econometria Espacial Aplicada.\nCampinas: Alínea."
  },
  {
    "objectID": "modelos_corte_transversal.html#pacotes",
    "href": "modelos_corte_transversal.html#pacotes",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.1 Pacotes",
    "text": "4.1 Pacotes\n\nlibrary(spatialreg)\n\nLoading required package: spData\n\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\n\nLoading required package: Matrix\n\n\nLoading required package: sf\n\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(spdep)\n\n\nAttaching package: 'spdep'\n\n\nThe following objects are masked from 'package:spatialreg':\n\n    get.ClusterOption, get.coresOption, get.mcOption,\n    get.VerboseOption, get.ZeroPolicyOption, set.ClusterOption,\n    set.coresOption, set.mcOption, set.VerboseOption,\n    set.ZeroPolicyOption\n\n# remotes::install_github(\"gpiras/sphet\")\nlibrary(sphet)\n\n\nAttaching package: 'sphet'\n\n\nThe following object is masked from 'package:spatialreg':\n\n    impacts"
  },
  {
    "objectID": "modelos_corte_transversal.html#shapefile",
    "href": "modelos_corte_transversal.html#shapefile",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.2 Shapefile",
    "text": "4.2 Shapefile\n\n# Pacotes\nlibrary(sf)\nlibrary(sp)\n\n# Abra o arquivo\nmontana.shp &lt;- st_read(\"data/natregimes_montana.gml\")\n\nReading layer `natregimes_montana' from data source \n  `/home/rfsaldanha/projects/ecoespacial/data/natregimes_montana.gml' \n  using driver `GML'\nSimple feature collection with 55 features and 74 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -116.0625 ymin: 44.35373 xmax: -104.0426 ymax: 49\nGeodetic CRS:  WGS 84\n\nmontana.shp &lt;- st_make_valid(montana.shp)\nmontana.shp &lt;- as_Spatial(montana.shp)\n\n# Plotar o mapa\nplot(montana.shp)\n\n\n\n\n\nlibrary(leaflet)\nlibrary(RColorBrewer)\nlibrary(htmltools)\n\nqpal &lt;- colorQuantile(\"OrRd\", montana.shp@data$RD90, n=5) \n\nleaflet(montana.shp) %&gt;%\n  addPolygons(stroke = FALSE, fillOpacity = .8, smoothFactor = 0.2,\n              fillColor = ~qpal(RD90), popup = ~htmlEscape(NAME),\n              highlight = highlightOptions(fillOpacity = 0.5,\n                                           bringToFront = TRUE)) %&gt;%\n  addTiles()"
  },
  {
    "objectID": "modelos_corte_transversal.html#matriz-de-vizinhança",
    "href": "modelos_corte_transversal.html#matriz-de-vizinhança",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.3 Matriz de vizinhança",
    "text": "4.3 Matriz de vizinhança\n\nw1 &lt;- spdep::nb2listw(spdep::poly2nb(montana.shp, queen = FALSE), style = \"W\")\nW &lt;- as(w1, \"CsparseMatrix\")\ntrMat &lt;- trW(W, type=\"mult\")"
  },
  {
    "objectID": "modelos_corte_transversal.html#especificação-do-modelo",
    "href": "modelos_corte_transversal.html#especificação-do-modelo",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.4 Especificação do modelo",
    "text": "4.4 Especificação do modelo\n\nesp1 &lt;- HR90 ~ RD90\nendog &lt;- ~ UE90\ninstruments &lt;- ~ FH90\n\n\nHR: homicide rate per 100,000 (1960, 1970, 1980, 1990)\nRD: resource deprivation 1960, 1970, 1980, 1990 (principal component)\nUE: unemployment rate 1960, 1970, 1980, 1990\nFH: % female headed households 1960, 1970, 1980, 1990"
  },
  {
    "objectID": "modelos_corte_transversal.html#ols",
    "href": "modelos_corte_transversal.html#ols",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.5 OLS",
    "text": "4.5 OLS\n\\(y = \\alpha + X\\beta + \\varepsilon\\)\n\nmod1.mcrl &lt;- lm(formula = esp1, data = montana.shp@data)\nsummary(mod1.mcrl)\n\n\nCall:\nlm(formula = esp1, data = montana.shp@data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-6.546 -3.017 -1.025  2.422 16.951 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   3.7853     0.6129   6.176 9.49e-08 ***\nRD90          2.8836     1.0923   2.640   0.0109 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.433 on 53 degrees of freedom\nMultiple R-squared:  0.1162,    Adjusted R-squared:  0.09954 \nF-statistic: 6.969 on 1 and 53 DF,  p-value: 0.01087"
  },
  {
    "objectID": "modelos_corte_transversal.html#multiplicador-de-lagrange",
    "href": "modelos_corte_transversal.html#multiplicador-de-lagrange",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.6 Multiplicador de Lagrange",
    "text": "4.6 Multiplicador de Lagrange\n\nmod1.lagrange &lt;- lm.LMtests(model = mod1.mcrl, listw = w1,\n                            test = c(\"LMerr\",\"RLMerr\",\"LMlag\",\"RLMlag\"))\nmod1.lagrange\n\n\n    Lagrange multiplier diagnostics for spatial dependence\n\ndata:  \nmodel: lm(formula = esp1, data = montana.shp@data)\nweights: w1\n\nLMerr = 0.9605, df = 1, p-value = 0.3271\n\n\n    Lagrange multiplier diagnostics for spatial dependence\n\ndata:  \nmodel: lm(formula = esp1, data = montana.shp@data)\nweights: w1\n\nRLMerr = 0.13243, df = 1, p-value = 0.7159\n\n\n    Lagrange multiplier diagnostics for spatial dependence\n\ndata:  \nmodel: lm(formula = esp1, data = montana.shp@data)\nweights: w1\n\nLMlag = 0.84352, df = 1, p-value = 0.3584\n\n\n    Lagrange multiplier diagnostics for spatial dependence\n\ndata:  \nmodel: lm(formula = esp1, data = montana.shp@data)\nweights: w1\n\nRLMlag = 0.015448, df = 1, p-value = 0.9011"
  },
  {
    "objectID": "modelos_corte_transversal.html#sar-mv",
    "href": "modelos_corte_transversal.html#sar-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.7 SAR (MV)",
    "text": "4.7 SAR (MV)\n\\(y = \\rho W y + X \\beta + \\varepsilon\\)\n\nmod1.sar &lt;- lagsarlm(formula = esp1, data = montana.shp@data, listw = w1)\nsummary(mod1.sar)\n\n\nCall:lagsarlm(formula = esp1, data = montana.shp@data, listw = w1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4712 -3.0399 -1.3250  2.5259 16.8433 \n\nType: lag \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value  Pr(&gt;|z|)\n(Intercept)  3.16687    0.85033  3.7243 0.0001959\nRD90         2.91026    1.06059  2.7440 0.0060695\n\nRho: 0.1792, LR test value: 0.84239, p-value: 0.35871\nAsymptotic standard error: 0.18437\n    z-value: 0.97196, p-value: 0.33107\nWald statistic: 0.94472, p-value: 0.33107\n\nLog likelihood: -158.4951 for lag model\nML residual variance (sigma squared): 18.519, (sigma: 4.3034)\nNumber of observations: 55 \nNumber of parameters estimated: 4 \nAIC: 324.99, (AIC for lm: 323.83)\nLM test for residual autocorrelation\ntest value: 0.54172, p-value: 0.46172\n\nsummary(spatialreg::impacts(mod1.sar, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (lag, trace):\n       Direct  Indirect    Total\nRD90 2.930558 0.6150693 3.545627\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n       Direct Indirect    Total\nRD90 1.084639 1.368209 2.039442\n\nSimulated z-values:\n       Direct  Indirect    Total\nRD90 2.769392 0.6472818 1.907093\n\nSimulated p-values:\n     Direct    Indirect Total   \nRD90 0.0056161 0.51745  0.056509"
  },
  {
    "objectID": "modelos_corte_transversal.html#sac-stsls",
    "href": "modelos_corte_transversal.html#sac-stsls",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.8 SAC (STSLS)",
    "text": "4.8 SAC (STSLS)\n\nmod1.sac_stsls &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"lag\", het = TRUE, endog = endog, instruments = instruments\n)\nsummary(mod1.sac_stsls)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, model = \"lag\", het = TRUE)\n\nResiduals:\n    Min.  1st Qu.   Median  3rd Qu.     Max. \n-6.48374 -2.44405 -0.88756  1.14961 16.99149 \n\nCoefficients:\n            Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.22654    2.07993 -0.5897 0.5553893    \nRD90         0.25793    1.11656  0.2310 0.8173100    \nUE90         0.74020    0.20802  3.5583 0.0003733 ***\nlambda       0.05640    0.58238  0.0968 0.9228503    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nmod1.sac_stsls2 &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"lag\", het = TRUE\n)\nsummary(mod1.sac_stsls2)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, model = \"lag\", \n    het = TRUE)\n\nResiduals:\n   Min. 1st Qu.  Median 3rd Qu.    Max. \n-6.5149 -3.0147 -1.1715  2.4648 16.9064 \n\nCoefficients:\n            Estimate Std. Error t-value Pr(&gt;|t|)  \n(Intercept) 3.529675   2.405383  1.4674  0.14227  \nRD90        2.894640   1.215182  2.3821  0.01722 *\nlambda      0.074062   0.613635  0.1207  0.90393  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(sphet::impacts(mod1.sac_stsls2, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (lag, trace):\n       Direct  Indirect    Total\nRD90 2.897931 0.2282375 3.126169\n========================================================\nSimulation results (IV variance matrix):\n========================================================\nSimulated standard errors\n       Direct Indirect    Total\nRD90 1.388501 7.424321 8.080305\n\nSimulated z-values:\n       Direct  Indirect     Total\nRD90 2.276389 0.2945429 0.6618004\n\nSimulated p-values:\n     Direct   Indirect Total \nRD90 0.022823 0.76834  0.5081"
  },
  {
    "objectID": "modelos_corte_transversal.html#sem-mv",
    "href": "modelos_corte_transversal.html#sem-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.9 SEM (MV)",
    "text": "4.9 SEM (MV)\n\\(y = X \\beta + u \\\\ u = \\lambda Wu + \\varepsilon\\)\n\nmod1.sem &lt;- errorsarlm(formula = esp1, data = montana.shp@data, listw = w1)\nsummary(mod1.sem)\n\n\nCall:errorsarlm(formula = esp1, data = montana.shp@data, listw = w1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4097 -3.0084 -1.1481  2.5629 16.6659 \n\nType: error \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value  Pr(&gt;|z|)\n(Intercept)  3.75130    0.73537  5.1012 3.375e-07\nRD90         2.89021    1.03890  2.7820  0.005402\n\nLambda: 0.20192, LR test value: 0.98506, p-value: 0.32095\nAsymptotic standard error: 0.18804\n    z-value: 1.0738, p-value: 0.28291\nWald statistic: 1.153, p-value: 0.28291\n\nLog likelihood: -158.4237 for error model\nML residual variance (sigma squared): 18.436, (sigma: 4.2937)\nNumber of observations: 55 \nNumber of parameters estimated: 4 \nAIC: NA (not available for weighted model), (AIC for lm: 323.83)"
  },
  {
    "objectID": "modelos_corte_transversal.html#sem-gmm",
    "href": "modelos_corte_transversal.html#sem-gmm",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.10 SEM (GMM)",
    "text": "4.10 SEM (GMM)\n\nmod1.sem_gmm &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"error\", step1.c = TRUE, het = TRUE, endog = endog, instruments = instruments\n)\n\nsummary(mod1.sem_gmm)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, model = \"error\", het = TRUE, step1.c = TRUE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-6.3752 -2.4238 -0.8875  0.0024  1.0903 17.0276 \n\nCoefficients:\n            Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.00926    1.20513 -0.8375 0.4023291    \nRD90         0.26659    1.05846  0.2519 0.8011428    \nUE90         0.73641    0.19803  3.7188 0.0002002 ***\nrho          0.06864    0.30236  0.2270 0.8204140    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "modelos_corte_transversal.html#sac-mv",
    "href": "modelos_corte_transversal.html#sac-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.11 SAC (MV)",
    "text": "4.11 SAC (MV)\n\\(y = \\rho Wy + X \\beta + u \\\\ u = \\lambda Wu + \\varepsilon\\)\n\nmod1.sac &lt;- sacsarlm(formula = esp1, data = montana.shp@data, listw = w1)\nsummary(mod1.sac)\n\n\nCall:sacsarlm(formula = esp1, data = montana.shp@data, listw = w1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4318 -3.0064 -1.2061  2.5673 16.7131 \n\nType: sac \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)   3.5980     2.7176  1.3240 0.185507\nRD90          2.9052     1.0866  2.6736 0.007505\n\nRho: 0.047078\nAsymptotic standard error: 0.8077\n    z-value: 0.058287, p-value: 0.95352\nLambda: 0.16245\nAsymptotic standard error: 0.79051\n    z-value: 0.2055, p-value: 0.83718\n\nLR test value: 0.99918, p-value: 0.60678\n\nLog likelihood: -158.4167 for sac model\nML residual variance (sigma squared): 18.481, (sigma: 4.2989)\nNumber of observations: 55 \nNumber of parameters estimated: 5 \nAIC: 326.83, (AIC for lm: 323.83)\n\nsummary(spatialreg::impacts(mod1.sac, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (sac, trace):\n      Direct  Indirect    Total\nRD90 2.90656 0.1422079 3.048768\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n       Direct Indirect    Total\nRD90 1.297471 10.52833 11.31566\n\nSimulated z-values:\n       Direct  Indirect     Total\nRD90 2.481262 0.2904226 0.5547205\n\nSimulated p-values:\n     Direct   Indirect Total  \nRD90 0.013092 0.77149  0.57909"
  },
  {
    "objectID": "modelos_corte_transversal.html#sac-gmm",
    "href": "modelos_corte_transversal.html#sac-gmm",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.12 SAC (GMM)",
    "text": "4.12 SAC (GMM)\n\nmod1.sac_gmm &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"sarar\", step1.c = FALSE, het = TRUE, endog = endog, instruments = instruments\n)\n\nsummary(mod1.sac_gmm)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, model = \"sarar\", het = TRUE, step1.c = FALSE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-6.5102 -2.4510 -0.8904 -0.0013  1.1410 16.9844 \n\nCoefficients:\n             Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.282437   2.519760 -0.5090 0.6107858    \nRD90         0.240835   1.194968  0.2015 0.8402758    \nUE90         0.743794   0.207021  3.5928 0.0003271 ***\nlambda       0.065972   0.627655  0.1051 0.9162890    \nrho          0.302036   0.557139  0.5421 0.5877362    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nWald test that rho and lambda are both zero:\n Statistics: 0.65153 p-val: 0.41956 \n\n\n\nmod1.sac_gmm2 &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"sarar\", step1.c = FALSE, het = TRUE\n)\n\nsummary(mod1.sac_gmm2)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, model = \"sarar\", \n    het = TRUE, step1.c = FALSE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n -6.521  -3.003  -1.089   0.021   2.463  16.953 \n\nCoefficients:\n            Estimate Std. Error t-value Pr(&gt;|t|)  \n(Intercept) 3.651563   2.415507  1.5117  0.13061  \nRD90        2.897586   1.212861  2.3890  0.01689 *\nlambda      0.032985   0.615118  0.0536  0.95723  \nrho         0.012935   0.619914  0.0209  0.98335  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nWald test that rho and lambda are both zero:\n Statistics: 0.040424 p-val: 0.84065 \n\nsummary(sphet::impacts(mod1.sac_gmm2, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (lag, trace):\n       Direct   Indirect    Total\nRD90 2.898229 0.09819482 2.996424\n========================================================\nSimulation results (GSTSLS variance matrix):\n========================================================\nSimulated standard errors\n       Direct Indirect    Total\nRD90 1.379495 8.744658 9.399373\n\nSimulated z-values:\n       Direct Indirect     Total\nRD90 2.244783 0.240309 0.5530248\n\nSimulated p-values:\n     Direct   Indirect Total  \nRD90 0.024782 0.81009  0.58025"
  },
  {
    "objectID": "modelos_corte_transversal.html#slx-mv",
    "href": "modelos_corte_transversal.html#slx-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.13 SLX (MV)",
    "text": "4.13 SLX (MV)\n\\(y = X \\beta + WX \\theta + \\varepsilon\\)\n\nmod1.slx &lt;- lmSLX(formula = esp1, data = montana.shp@data, listw = w1)\nsummary(mod1.slx)\n\n\nCall:\nlm(formula = formula(paste(\"y ~ \", paste(colnames(x)[-1], collapse = \"+\"))), \n    data = as.data.frame(x), weights = weights)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-6.511 -3.005 -1.008  2.432 16.870 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   3.7377     0.7334   5.097 4.91e-06 ***\nRD90          2.8635     1.1151   2.568   0.0131 *  \nlag.RD90     -0.2870     2.3742  -0.121   0.9043    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.474 on 52 degrees of freedom\nMultiple R-squared:  0.1165,    Adjusted R-squared:  0.08248 \nF-statistic: 3.427 on 2 and 52 DF,  p-value: 0.03998\n\nsummary(spatialreg::impacts(mod1.slx, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (SlX, glht, n-k):\n      Direct  Indirect    Total\nRD90 2.86351 -0.286971 2.576539\n========================================================\nStandard errors:\n       Direct Indirect   Total\nRD90 1.115113 2.374184 2.76964\n========================================================\nZ-values:\n      Direct   Indirect     Total\nRD90 2.56791 -0.1208714 0.9302793\n\np-values:\n     Direct   Indirect Total  \nRD90 0.010231 0.90379  0.35223"
  },
  {
    "objectID": "modelos_corte_transversal.html#slx-stsls",
    "href": "modelos_corte_transversal.html#slx-stsls",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.14 SLX (STSLS)",
    "text": "4.14 SLX (STSLS)\n\nmod1.slx_stsls &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  lag.instr = FALSE, Durbin = TRUE, model = \"ols\", step1.c = TRUE, \n  het = TRUE, endog = endog, instruments = instruments\n)\n\nsummary(mod1.slx_stsls)\n\n\n Stsls with Spatial HAC standard errors\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, lag.instr = FALSE, model = \"ols\", \n    het = TRUE, step1.c = TRUE, Durbin = TRUE)\n\nResiduals:\n    Min.  1st Qu.   Median  3rd Qu.     Max. \n-6.40823 -2.46165 -0.84138  1.08488 17.06315 \n\nCoefficients:\n            Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.05506    1.15580 -0.9128 0.3613275    \nRD90         0.23420    1.04646  0.2238 0.8229104    \nlag_RD90     0.13117    2.06873  0.0634 0.9494441    \nUE90         0.74709    0.19354  3.8602 0.0001133 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nmod1.slx_stsls2 &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  lag.instr = FALSE, Durbin = TRUE, model = \"ols\", step1.c = TRUE, \n  het = TRUE\n)\n\nsummary(sphet::impacts(mod1.slx_stsls2, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (SlX, glht, n-k):\n      Direct  Indirect    Total\nRD90 2.86351 -0.286971 2.576539\n========================================================\nStandard errors:\n       Direct Indirect    Total\nRD90 1.213777 2.216879 2.652204\n========================================================\nZ-values:\n       Direct   Indirect     Total\nRD90 2.359174 -0.1294482 0.9714708\n\np-values:\n     Direct   Indirect Total  \nRD90 0.018316 0.897    0.33131"
  },
  {
    "objectID": "modelos_corte_transversal.html#sdm-mv",
    "href": "modelos_corte_transversal.html#sdm-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.15 SDM (MV)",
    "text": "4.15 SDM (MV)\n\\(y = \\rho Wy + X \\beta + WX \\theta + \\varepsilon\\)\n\nmod1.sdm &lt;- lagsarlm(formula = esp1, data = montana.shp@data, listw = w1, Durbin = TRUE)\nsummary(mod1.sdm)\n\n\nCall:lagsarlm(formula = esp1, data = montana.shp@data, listw = w1, \n    Durbin = TRUE)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.3395 -2.9909 -1.0769  2.5768 16.5460 \n\nType: mixed \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)  2.91618    0.98963  2.9467 0.003212\nRD90         2.84391    1.06989  2.6581 0.007857\nlag.RD90    -0.99818    2.33320 -0.4278 0.668785\n\nRho: 0.20387, LR test value: 1.002, p-value: 0.31682\nAsymptotic standard error: 0.18781\n    z-value: 1.0855, p-value: 0.27771\nWald statistic: 1.1783, p-value: 0.27771\n\nLog likelihood: -158.4075 for mixed model\nML residual variance (sigma squared): 18.422, (sigma: 4.2921)\nNumber of observations: 55 \nNumber of parameters estimated: 5 \nAIC: 326.82, (AIC for lm: 325.82)\nLM test for residual autocorrelation\ntest value: 1.0407, p-value: 0.30766\n\nsummary(spatialreg::impacts(mod1.sdm, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (mixed, trace):\n       Direct   Indirect    Total\nRD90 2.825151 -0.5067765 2.318375\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n       Direct Indirect    Total\nRD90 1.142923 3.197858 3.766895\n\nSimulated z-values:\n       Direct   Indirect     Total\nRD90 2.530523 -0.1496861 0.6407179\n\nSimulated p-values:\n     Direct   Indirect Total  \nRD90 0.011389 0.88101  0.52171"
  },
  {
    "objectID": "modelos_corte_transversal.html#sdem-mv",
    "href": "modelos_corte_transversal.html#sdem-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.16 SDEM (MV)",
    "text": "4.16 SDEM (MV)\n\\(y = X \\beta + WX \\theta + u \\\\ u = \\lambda Wu + \\varepsilon\\)\n\nmod1.sdem &lt;- errorsarlm(formula = esp1, data = montana.shp@data, listw = w1, Durbin = TRUE)\nsummary(mod1.sdem)\n\n\nCall:errorsarlm(formula = esp1, data = montana.shp@data, listw = w1, \n    Durbin = TRUE)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.3568 -2.9878 -1.0313  2.5668 16.5735 \n\nType: error \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value  Pr(&gt;|z|)\n(Intercept)  3.69127    0.85423  4.3212 1.552e-05\nRD90         2.83836    1.10454  2.5697   0.01018\nlag.RD90    -0.33914    2.45675 -0.1380   0.89021\n\nLambda: 0.20244, LR test value: 0.98866, p-value: 0.32007\nAsymptotic standard error: 0.18799\n    z-value: 1.0769, p-value: 0.28153\nWald statistic: 1.1597, p-value: 0.28153\n\nLog likelihood: -158.4142 for error model\nML residual variance (sigma squared): 18.429, (sigma: 4.2929)\nNumber of observations: 55 \nNumber of parameters estimated: 5 \nAIC: NA (not available for weighted model), (AIC for lm: 325.82)"
  },
  {
    "objectID": "modelos_corte_transversal.html#sdem-gmm",
    "href": "modelos_corte_transversal.html#sdem-gmm",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.17 SDEM (GMM)",
    "text": "4.17 SDEM (GMM)\n\nmod1.sdem_gmm &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"error\", Durbin = TRUE, \n  step1.c = TRUE, het = TRUE, endog = endog, instruments = instruments\n)\n\nsummary(mod1.sdem_gmm)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, model = \"error\", het = TRUE, step1.c = TRUE, \n    Durbin = TRUE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-6.3805 -2.4459 -0.8510  0.0021  1.0907 17.0541 \n\nCoefficients:\n             Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.012074   1.163428 -0.8699 0.3843513    \nRD90         0.265070   1.061400  0.2497 0.8027915    \nlag_RD90     0.092892   2.131567  0.0436 0.9652397    \nUE90         0.739299   0.195456  3.7824 0.0001553 ***\nrho          0.064293   0.302432  0.2126 0.8316499    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nmod1.sdem_gmm2 &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"error\", Durbin = TRUE, \n  step1.c = TRUE, het = TRUE\n)\n\nsummary(mod1.sdem_gmm2)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, model = \"error\", \n    het = TRUE, step1.c = TRUE, Durbin = TRUE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-6.4510 -2.9793 -0.9784  0.0323  2.4635 16.8868 \n\nCoefficients:\n            Estimate Std. Error t-value Pr(&gt;|t|)    \n(Intercept)  3.69503    0.78036  4.7350 2.19e-06 ***\nRD90         2.84006    1.26364  2.2475  0.02461 *  \nlag_RD90    -0.33439    2.40223 -0.1392  0.88929    \nrho          0.19018    0.20037  0.9491  0.34256    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(sphet::impacts(mod1.sdem_gmm2, tr=w_matrix$tr, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (SlX, glht, n-k):\n       Direct   Indirect    Total\nRD90 2.840057 -0.3343859 2.505671\n========================================================\nStandard errors:\n       Direct Indirect   Total\nRD90 1.263635 2.402231 3.03313\n========================================================\nZ-values:\n      Direct  Indirect     Total\nRD90 2.24753 -0.139198 0.8261007\n\np-values:\n     Direct   Indirect Total  \nRD90 0.024606 0.88929  0.40875"
  },
  {
    "objectID": "gwr.html#pacote",
    "href": "gwr.html#pacote",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.1 Pacote",
    "text": "5.1 Pacote\n\nlibrary(mgwrsar)\n\nLoading required package: Rcpp\n\n\nLoading required package: sp\n\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n\nLoading required package: leaflet\n\n\nLoading required package: Matrix"
  },
  {
    "objectID": "gwr.html#shapefile",
    "href": "gwr.html#shapefile",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.2 Shapefile",
    "text": "5.2 Shapefile\n\n# Pacotes\nlibrary(sf)\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(sp)\n\n# Abra o arquivo 'gm10.shp'\nbrmicro.shp &lt;- st_read(\"data/br_micro.shp\", options = \"ENCODING=WINDOWS-1252\")\n\noptions:        ENCODING=WINDOWS-1252 \nReading layer `br_micro' from data source \n  `/home/rfsaldanha/projects/ecoespacial/data/br_micro.shp' using driver `ESRI Shapefile'\nSimple feature collection with 558 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -73.99095 ymin: -33.75086 xmax: -32.37889 ymax: 5.272225\nCRS:           NA\n\nbrmicro.shp &lt;- st_make_valid(brmicro.shp)\nbrmicro.shp &lt;- as_Spatial(brmicro.shp)\n\n# Plotar o mapa\nplot(brmicro.shp)"
  },
  {
    "objectID": "gwr.html#dados",
    "href": "gwr.html#dados",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.3 Dados",
    "text": "5.3 Dados\n\ndados &lt;- read.csv2(\"data/Dados_GWR.csv\", header = TRUE)\nstr(dados)\n\n'data.frame':   558 obs. of  17 variables:\n $ ID     : int  110001 110002 110003 110004 110005 110006 110007 110008 120001 120002 ...\n $ X_COORD: num  -64.5 -63.8 -62.6 -62.5 -62.8 ...\n $ Y_COORD: num  -9.42 -11.68 -9.53 -10.54 -11.67 ...\n $ P9303  : num  -0.0492 0.0584 0.2066 0.0747 0.157 ...\n $ Q9303  : num  0.881 0.148 0.195 -0.627 0.366 ...\n $ P93    : num  8.3 4.64 2.54 3.1 1.82 ...\n $ G0     : num  0 0.44 0.694 0.626 0.781 ...\n $ CT9303 : num  1.91 1.71 1.66 2.21 3.08 ...\n $ CI9303 : num  1.147 2.03 -1.385 -0.294 1.647 ...\n $ CC9303 : num  1.206 -0.165 1.662 1.975 2.734 ...\n $ WP9303 : num  0.2632 0.0802 0.1186 0.0738 0.0905 ...\n $ WQ9303 : num  0.853 0.146 1.075 0.42 -0.171 ...\n $ WP93   : num  3.79 3.54 3.96 2.65 2.89 ...\n $ WG0    : num  0.409 0.544 0.372 0.546 0.612 ...\n $ WCT9303: num  1.62 2.49 1.15 2.08 2.23 ...\n $ WCI9303: num  -0.817 0.809 0.718 1.654 0.824 ...\n $ WCC9303: num  1.64 2.09 1.02 1.33 1.42 ..."
  },
  {
    "objectID": "gwr.html#especificação",
    "href": "gwr.html#especificação",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.4 Especificação",
    "text": "5.4 Especificação\nQ9303 : Taxa de crescimento da produção agrícola microrregional no período de 1993 a 2003 P9303: Taxa de crescimento da produtividade da terra no período de 1993 a 2003 G0: medida de gap tecnológico CI9303: taxa de crescimento do crédito para investimento agrícola no período de 1993 a 2003.\n\nesp &lt;-  Q9303 ~ P9303 + G0 + CI9303"
  },
  {
    "objectID": "gwr.html#modelo-ols",
    "href": "gwr.html#modelo-ols",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.5 Modelo OLS",
    "text": "5.5 Modelo OLS\n\nmod1 &lt;- lm(formula = esp, data = dados)\nsummary(mod1)\n\n\nCall:\nlm(formula = esp, data = dados)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.2571 -0.3653 -0.0417  0.2531 12.1204 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.255015   0.054681   4.664  3.9e-06 ***\nP9303        1.692115   0.124878  13.550  &lt; 2e-16 ***\nG0           0.041733   0.033751   1.236    0.217    \nCI9303      -0.002689   0.019658  -0.137    0.891    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9564 on 554 degrees of freedom\nMultiple R-squared:  0.2672,    Adjusted R-squared:  0.2632 \nF-statistic: 67.33 on 3 and 554 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "gwr.html#verificando-erros-do-modelo",
    "href": "gwr.html#verificando-erros-do-modelo",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.6 Verificando erros do modelo",
    "text": "5.6 Verificando erros do modelo\n\nplot(mod1, which=3)"
  },
  {
    "objectID": "gwr.html#verificando-resíduos-no-espaço",
    "href": "gwr.html#verificando-resíduos-no-espaço",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.7 Verificando resíduos no espaço",
    "text": "5.7 Verificando resíduos no espaço\n\nresids &lt;- residuals(mod1)\ncores &lt;- c(\"dark blue\", \"blue\", \"red\", \"dark red\") \nmap.resids &lt;- SpatialPointsDataFrame(data=data.frame(resids), coords=cbind(dados$X_COORD,dados$Y_COORD)) \nspplot(map.resids, cuts=quantile(resids), col.regions=cores, cex=1)"
  },
  {
    "objectID": "gwr.html#gwr-com-kernel-gaussiano",
    "href": "gwr.html#gwr-com-kernel-gaussiano",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.8 GWR com kernel gaussiano",
    "text": "5.8 GWR com kernel gaussiano\n\ncoord &lt;- as.matrix(cbind(dados$X_COORD,dados$Y_COORD))\n\n\nmod1.gwr &lt;- MGWRSAR(formula = esp, data = dados, \n                    coord = coord,\n                    fixed_vars = NULL, kernels = c('gauss'), H = 0.60,\n                    Model = 'GWR',\n                    control=list(SE = TRUE, doMC = TRUE, ncore = 4))\n\nsummary_mgwrsar(mod1.gwr)\n\nCall:\nMGWRSAR(formula = esp, data = dados, coord = coord, fixed_vars = NULL, \n    kernels = c(\"gauss\"), H = 0.6, Model = \"GWR\", control = list(SE = TRUE, \n        doMC = TRUE, ncore = 4))\nModel: GWR \nKernels function: gauss \nKernels adaptive: NO \nKernels type: GD \nBandwidth: 0.6 \nComputation time: 0.547 \nUse of parallel computing: TRUE  ncore = 4 \nUse of rough kernel: NO \nUse of Target Points: NO \nNumber of data points: 558 \nVarying parameters: Intercept P9303 G0 CI9303 \n          Intercept       P9303          G0  CI9303\nMin.    -8.2811e+02 -2.1688e+01 -7.6471e+00 -2.6374\n1st Qu. -1.9185e-01  9.8576e-01 -2.7433e-01 -0.0609\nMedian   1.1666e-01  1.8369e+00 -1.5489e-03  0.0025\nMean    -1.9452e+00  1.8003e+00  2.1188e+00  0.0377\n3rd Qu.  5.2344e-01  2.3682e+00  3.2038e-01  0.0652\nMax.     6.2005e+00  3.3002e+01  8.3419e+02  2.1745\nEffective degrees of freedom: 214.4194 \nAIC 1286.154 \nResidual sum of squares: 176.9171 \nRMSE: 0.5630771 \n\nplot_mgwrsar(mod1.gwr,type='B_coef',var='CI9303', radius = 20000)\n\n\n\n\nplot_mgwrsar(mod1.gwr,type='t_coef',var='CI9303', radius = 20000)"
  },
  {
    "objectID": "gwr.html#gwr-com-cv-leave-one-out-e-kernel-adaptativo-biquadrado-considerando-20-vizinhos-e-remoção-de-outliers",
    "href": "gwr.html#gwr-com-cv-leave-one-out-e-kernel-adaptativo-biquadrado-considerando-20-vizinhos-e-remoção-de-outliers",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.9 GWR com ‘CV leave one out’ e kernel adaptativo biquadrado (considerando 20 vizinhos) e remoção de outliers",
    "text": "5.9 GWR com ‘CV leave one out’ e kernel adaptativo biquadrado (considerando 20 vizinhos) e remoção de outliers\n\nmod2.gwr &lt;- MGWRSAR(formula = esp, data = dados, coord=coord,\n                    fixed_vars = NULL, kernels = c('bisq'), H=20,\n                    Model = 'GWR',\n                    control=list(isgcv=TRUE,remove_local_outlier=TRUE,outv=0.01))\nsummary_mgwrsar(mod2.gwr)\n\nCall:\nMGWRSAR(formula = esp, data = dados, coord = coord, fixed_vars = NULL, \n    kernels = c(\"bisq\"), H = 20, Model = \"GWR\", control = list(isgcv = TRUE, \n        remove_local_outlier = TRUE, outv = 0.01))\nModel: GWR \nKernels function: bisq \nKernels adaptive: NO \nKernels type: GD \nBandwidth: 20 \nComputation time: 1.224 \nUse of parallel computing: FALSE  ncore = 1 \nUse of rough kernel: NO \nUse of Target Points: NO \nNumber of data points: 558 \nVarying parameters: Intercept P9303 G0 CI9303 \n          Intercept       P9303          G0  CI9303\nMin.     0.10424379  0.90006692 -1.34446628 -0.1101\n1st Qu.  0.15206433  1.67545203  0.00461598 -0.0202\nMedian   0.21499269  1.70988054  0.02319197 -0.0138\nMean     0.24363087  1.71237373  0.00073565 -0.0121\n3rd Qu.  0.27568400  1.77191031  0.08011017 -0.0071\nMax.     1.23604439  2.16398074  0.10863633  0.0588\nResidual sum of squares: 499.5637 \nRMSE: 0.94619 \n\n\nSaiba mais em: https://cran.r-project.org/web/packages/mgwrsar/vignettes/mgwrsar-basic_examples.html"
  },
  {
    "objectID": "gwr.html#usando-o-pacote-spgwr",
    "href": "gwr.html#usando-o-pacote-spgwr",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.10 Usando o pacote spgwr",
    "text": "5.10 Usando o pacote spgwr\n\nlibrary(spgwr)\n\nLoading required package: spData\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\n\nNOTE: This package does not constitute approval of GWR\nas a method of spatial analysis; see example(gwr)\n\n\n\n5.10.1 Kernel bandwith\n\nGWRbandwidth &lt;- gwr.sel(esp, data=dados, coords = cbind(dados$X_COORD,dados$Y_COORD), adapt = TRUE) \n\nAdaptive q: 0.381966 CV score: 513.9403 \nAdaptive q: 0.618034 CV score: 514.5733 \nAdaptive q: 0.236068 CV score: 510.1655 \nAdaptive q: 0.145898 CV score: 509.9981 \nAdaptive q: 0.1818601 CV score: 509.6378 \nAdaptive q: 0.1867464 CV score: 509.5685 \nAdaptive q: 0.2055856 CV score: 509.9121 \nAdaptive q: 0.1894925 CV score: 509.6879 \nAdaptive q: 0.1852418 CV score: 509.6098 \nAdaptive q: 0.1877954 CV score: 509.6292 \nAdaptive q: 0.1864049 CV score: 509.5482 \nAdaptive q: 0.1861779 CV score: 509.5577 \nAdaptive q: 0.1864456 CV score: 509.5506 \nAdaptive q: 0.1863466 CV score: 509.5485 \nAdaptive q: 0.1864049 CV score: 509.5482 \n\n\n\n\n5.10.2 Modelo GWR\n\nmod4.gwr = gwr(esp, data=dados, coords = cbind(dados$X_COORD,dados$Y_COORD), adapt=GWRbandwidth, hatmatrix=TRUE, se.fit=TRUE) \nmod4.gwr\n\nCall:\ngwr(formula = esp, data = dados, coords = cbind(dados$X_COORD, \n    dados$Y_COORD), adapt = GWRbandwidth, hatmatrix = TRUE, se.fit = TRUE)\nKernel function: gwr.Gauss \nAdaptive quantile: 0.1864049 (about 104 of 558 data points)\nSummary of GWR coefficient estimates at data points:\n                  Min.   1st Qu.    Median   3rd Qu.      Max.  Global\nX.Intercept. -0.276464 -0.066091  0.143081  0.367378  0.612604  0.2550\nP9303         1.207676  1.483514  1.872278  2.474311  2.747145  1.6921\nG0           -0.081195 -0.034559  0.015841  0.118441  0.173140  0.0417\nCI9303       -0.046286 -0.028744  0.016651  0.074686  0.121517 -0.0027\nNumber of data points: 558 \nEffective number of parameters (residual: 2traceS - traceS'S): 17.35644 \nEffective degrees of freedom (residual: 2traceS - traceS'S): 540.6436 \nSigma (residual: 2traceS - traceS'S): 0.9203189 \nEffective number of parameters (model: traceS): 13.31951 \nEffective degrees of freedom (model: traceS): 544.6805 \nSigma (model: traceS): 0.9169021 \nSigma (ML): 0.9058927 \nAICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 1502.684 \nAIC (GWR p. 96, eq. 4.22): 1486.556 \nResidual sum of squares: 457.918 \nQuasi-global R2: 0.3378047"
  }
]