[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Econometria Espacial aplicada com R",
    "section": "",
    "text": "Apresentação\nEste livro on-line apresenta uma introdução a Econometria Espacial aplicada com R. Recomendamos como referência o livro Econometria Espacial aplicada (Almeida 2012).\n\nRaphael Saldanha é geógrafo, mestre em saúde pública, doutor em Informação e Comunicação em Saúde, postdoc researcher no Inria (Institut national de recherche en sciences et technologies du numérique, France).\nEduardo Almeida é economista, mestre e doutor em Economia, postdoc pela Escola Superior de Agricultura “Luiz de Queiroz”, professor adjunto da Faculdade de Economia da Universidade Federal de Juiz de Fora (UFJF) desde 2005.\n\n\n\n\nAlmeida, Eduardo. 2012. Econometria espacial aplicada. Campinas: Alínea."
  },
  {
    "objectID": "intro_r.html",
    "href": "intro_r.html",
    "title": "1  Introdução ao R",
    "section": "",
    "text": "2 Comandos básicos\nA interface do R não é recomendada para a criação de banco de dados. Como já existem centenas de opções de softwares de qualidade e gratuitos para este fim, os bancos de dados podem ser criados em outros softwares como o Excel e importados posteriormente para o R.\nExistem diversos pacotes para ler aquivos de banco de dados no R, como DBF, SAV, Stata e etc. Mas a forma mais segura e recomendada é exportar os dados no formato CSV para ser importados no R.\nAbaixo temos uma lista comandos para obter estatísticas básicas com o R e alguns gráficos.\n# Importar o arquivo 'notas.csv'\ndados &lt;- read.csv2(file = \"data/notas.csv\", header = TRUE)\n\n# Média\nmean(dados$nota)\n\n[1] 25.22667\n\n# Mediana\nmedian(dados$nota)\n\n[1] 26.3\n\n# Variância\nvar(dados$nota)\n\n[1] 144.4083\n\n# Desvio padrão\nsd(dados$nota)\n\n[1] 12.017\n\n# Valor máximo\nmax(dados$nota)\n\n[1] 40.9\n\n# Valor mínimo\nmin(dados$nota)\n\n[1] 10\n\n# Amplitude\nrange(dados$nota)\n\n[1] 10.0 40.9\n\n# Coeficiente de variação\nsd(dados$nota)/mean(dados$nota)\n\n[1] 0.476361\n\n# Quartis\nquantile(dados$nota)\n\n    0%    25%    50%    75%   100% \n10.000 16.250 26.300 32.795 40.900 \n\n# Sumário\nsummary(dados$nota)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  10.00   16.25   26.30   25.23   32.80   40.90 \n\n# Boxplot\nboxplot(dados$nota)\n\n\n\n# Histograma\nhist(dados$nota, main = \"Boxplot\", xlab = \"Classes\", ylab = \"Frequências\", col = \"tan\")"
  },
  {
    "objectID": "intro_r.html#instalando-o-r",
    "href": "intro_r.html#instalando-o-r",
    "title": "1  Introdução ao R",
    "section": "1.1 Instalando o R",
    "text": "1.1 Instalando o R\nUma copia do R pode ser obtida gratuitamente no site https://cran.r-project.org/. Atente para o sistema operacional antes de efetuar o download."
  },
  {
    "objectID": "intro_r.html#rstudio",
    "href": "intro_r.html#rstudio",
    "title": "1  Introdução ao R",
    "section": "1.2 RStudio",
    "text": "1.2 RStudio\nApós a instalação do R, ele já pode ser usado através de sua interface gráfica padrão. Contudo, é comum a utilização de interfaces de desenvolvimento (IDE - Integrated Development Environment) criada por terceiros.\nNeste material, iremos utilizar uma IDE chamada RStudio. Ela pode ser obtida gratuitamente no site https://www.rstudio.com/products/RStudio/.\nApós instalar e abrir o RStudio, você verá na tela duas áreas principais. A primeira é chamada de script e a segunda de console.\nA área de script é onde digitamos os comandos utilizados no R. Após preparar um comando, ele é executado pressionando o botão run na interface ou pressionando Ctrl + r no teclado. Ao executar um comando, ele será reproduzido na área do console e seu resultado virá logo abaixo.\nO script é um arquivo de texto que pode ser salvo e reaproveitado posteriormente. É comum encontrarmos em scripts do R linhas precedidas com o caractere #. Este simbolo indica um comentário, ou seja, um texto que não será interpretado como um comando no R.\n\n1.2.1 Que documento é este?\nO script é a forma mais tradicional de criar códigos para o R, mas ele tem algumas limitações. Por ser apenas um arquivo de texto simples, ele não é capaz de armazenar os resultados produzidos pelo R, guardar figuras e ser esteticamente apresentável.\nPor estes motivos e na onda da ciência reprodutível, foi criado o R Notebook. Um notebook é uma uma espécie de script versão 2.0, onde é possível escrever comentários com formatação, inserir código do R e ver o seu resultado logo abaixo. E a melhor parte: um notebook pode ser exportado para HTML ou PDF facilmente, facilitando o envio de pesquisas feitas com o R.\nEste arquivo que você está visualizando é um R Notebook. Os asteríscos e alguns símbolos que você está vendo no texto é uma forma de formatação chamada Markdown. Por exemplo, dois asterísticos entre uma palavra fazem com que ela fique em negrito. Neste link tem um guia desta linguagem.\nPara ver como está ficando o seu notebook, clique no botão Preview. Uma página irá aparecer com a pré-visualização do seu notebook. Para exportar para HTML ou PDF, use a seta para abaixo ao lado do botão (Knit to…)."
  },
  {
    "objectID": "intro_r.html#operações-matemáticas",
    "href": "intro_r.html#operações-matemáticas",
    "title": "1  Introdução ao R",
    "section": "2.1 Operações matemáticas",
    "text": "2.1 Operações matemáticas\nOs primeiros comandos no R são funções muito básicas para operações matemáticas. A parte verde abaixo é um chunk de código R no notebook. Isto indica ao RStudio que esta parte do texto deve ser intepretada como código R e não como texto. Para executar um chunk, pressione Ctrl + Shift + Enter.\n\n# Soma\n2+2\n\n[1] 4\n\n# Subtração\n4-2\n\n[1] 2\n\n# Multiplicação\n2*3\n\n[1] 6\n\n# Divisão\n4/2\n\n[1] 2\n\n# Exponenciação\n2^3\n\n[1] 8\n\n\nSe tudo correu bem, você deve ver acima o resultado das operações. Use o preview do notebook para ver como está ficando o resultado do documento.\n\n2.1.1 Sua vez\nRealize a seguinte operação no R \\(((2+3(5))/10)^2\\).\n\n\nCódigo\n((2+3*5)/10)^2\n\n\n[1] 2.89\n\n\nResultado correto: 2,89."
  },
  {
    "objectID": "intro_r.html#funções",
    "href": "intro_r.html#funções",
    "title": "1  Introdução ao R",
    "section": "2.2 Funções",
    "text": "2.2 Funções\nFunções são comandos que apresentam resultados com base em um ou mais argumentos. Teste os exemplos abaixo.\n\n# Raiz quadrada\nsqrt(x=9)\n\n[1] 3\n\n# Combinação de 10 elementos tomados 2 a 2\nchoose(n=10, k=2)\n\n[1] 45\n\n# e^x\nexp(2)\n\n[1] 7.389056\n\n# Logarítmo natural\nlog(1)\n\n[1] 0\n\n\n\n2.2.1 Sua vez\nCalcule a raiz quadrada do logaritmo de 10 no R.\n\n\nCódigo\nsqrt(log(x = 10))\n\n\n[1] 1.517427\n\n\nResultado correto: 1,51."
  },
  {
    "objectID": "intro_r.html#objetos",
    "href": "intro_r.html#objetos",
    "title": "1  Introdução ao R",
    "section": "2.3 Objetos",
    "text": "2.3 Objetos\nOs resultados de operações simples e funções no R podem ser armazenados na memória para utilização posterior através de objetos.\nNa linguagem R, objetos são abstrações na memória que podem conter desde um simples número até complexos bancos de dados. Estude os comandos abaixo.\n\n# Criar o objeto x\nx &lt;- 2\n\n# Imprimir o objeto x\nx\n\n[1] 2\n\n# Operações com o objeto x\nx^2\n\n[1] 4\n\nx+x\n\n[1] 4\n\n# Apagar o objeto x\nrm(x)\n\n# Criar o vetor y\ny &lt;- c(2, 5, 10, 11.3, 12)\n\n# Imprimir o vetor y\ny\n\n[1]  2.0  5.0 10.0 11.3 12.0\n\n# Elevar o vetor y ao quadrado\ny^2\n\n[1]   4.00  25.00 100.00 127.69 144.00\n\n# Apagar o vetor y\nrm(y)\n\n# Criar o vetor 'notas'\nnotas &lt;- c(60, 50, 20, 50, 90)\n\n# Ordenar o vetor 'notas'\nnotas &lt;- sort(notas)\n\n# Imprimir o vetor 'notas'\nnotas\n\n[1] 20 50 50 60 90\n\n\n\n2.3.1 Sua vez\nCrie um objeto chamado dados com os valores {5, 7, 12.7, 13, 15}. Eleve ao quadrado e obtenha o resultado da soma dos valores elevados com a função sum(x).\n\n\nCódigo\ndados &lt;- c(5, 7, 12.7, 13, 15)\nsum(dados^2)\n\n\n[1] 629.29\n\n\nResultado correto: 629,29."
  },
  {
    "objectID": "intro_r.html#operadores-lógicos",
    "href": "intro_r.html#operadores-lógicos",
    "title": "1  Introdução ao R",
    "section": "2.4 Operadores lógicos",
    "text": "2.4 Operadores lógicos\nEstes operados verificam afirmações de lógica, veja os comandos abaixo.\n\n# Igualdade\n2 == 2\n\n[1] TRUE\n\n2 == 5\n\n[1] FALSE\n\n\"a\" == \"a\"\n\n[1] TRUE\n\n\"a\" == 'A'\n\n[1] FALSE\n\n# Maior\n2 &gt; 3\n\n[1] FALSE\n\n2 &gt;= 3\n\n[1] FALSE\n\n# Menor\n2 &lt; 4\n\n[1] TRUE\n\n2 &lt;= 1\n\n[1] FALSE\n\nc(1,2,2,4,7,10) &lt; 7\n\n[1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE"
  },
  {
    "objectID": "intro_r.html#arquivos-csv",
    "href": "intro_r.html#arquivos-csv",
    "title": "1  Introdução ao R",
    "section": "3.1 Arquivos CSV",
    "text": "3.1 Arquivos CSV\nPara importar este arquivo CSV no R, teste o código abaixo. Se não funcionar, tente trocar “/” por “\\”.\n\n# Importar o arquivo 'notas.csv'\ndados &lt;- read.csv2(file = \"data/notas.csv\", header = TRUE)\n\nAtenção para os nomes das variáveis! Evite a utilização de nomes muito longos, caracteres especiais e acentos.\nApós importar um banco de dados, verifique se tudo correu bem com estes comandos.\n\n# Estrutura do objeto\nstr(dados)\n\n'data.frame':   6 obs. of  3 variables:\n $ id  : int  1 2 3 4 5 6\n $ nome: chr  \"Maria\" \"João\" \"José\" \"Maria\" ...\n $ nota: num  10 20 32.6 15 40.9 ...\n\n# Listar os nomes das variáveis\nnames(dados)\n\n[1] \"id\"   \"nome\" \"nota\"\n\n# Imprimir as seis primeiras linhas\nhead(dados)\n\n  id    nome  nota\n1  1   Maria 10.00\n2  2    João 20.00\n3  3    José 32.60\n4  4   Maria 15.00\n5  5 Gustavo 40.90\n6  6 Alfredo 32.86\n\n# Imprimir as seis últimas linhas\ntail(dados)\n\n  id    nome  nota\n1  1   Maria 10.00\n2  2    João 20.00\n3  3    José 32.60\n4  4   Maria 15.00\n5  5 Gustavo 40.90\n6  6 Alfredo 32.86\n\n\nPara acessar uma variável específica:\n\ndados$nota \n\n[1] 10.00 20.00 32.60 15.00 40.90 32.86\n\n\n\n3.1.1 Sua vez\nImporte o mesmo arquivo do exemplo mas com o argumento header = FALSE. Execute o comando str(x) e veja o que mudou.\n\n\nCódigo\ndados &lt;- read.csv2(file = \"data/notas.csv\", header = TRUE)\nstr(dados)\n\n\n'data.frame':   6 obs. of  3 variables:\n $ id  : int  1 2 3 4 5 6\n $ nome: chr  \"Maria\" \"João\" \"José\" \"Maria\" ...\n $ nota: num  10 20 32.6 15 40.9 ..."
  },
  {
    "objectID": "aede.html#leitura-do-shapefile",
    "href": "aede.html#leitura-do-shapefile",
    "title": "2  Análise Exploratória de Dados Espaciais (AED-E)",
    "section": "2.1 Leitura do shapefile",
    "text": "2.1 Leitura do shapefile\nPara a leitura de arquivos shapefile no R, precisamos usar alguns pacotes. Após a instalação dos pacotes, use os seguintes comandos.\n\n# Pacotes\nlibrary(sf)\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(sp)\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n# Abra o arquivo 'gm10.shp'\nfp_mg.shp &lt;- st_read(\"data/FP_MG.shp\", options = \"ENCODING=WINDOWS-1252\")\n\noptions:        ENCODING=WINDOWS-1252 \nReading layer `FP_MG' from data source \n  `/home/rfsaldanha/projects/ecoespacial/data/FP_MG.shp' using driver `ESRI Shapefile'\n\n\nWarning in CPL_read_ogr(dsn, layer, query, as.character(options), quiet, : GDAL\nMessage 1: organizePolygons() received an unexpected geometry.  Either a\npolygon with interior rings, or a polygon with less than 4 points, or a\nnon-Polygon geometry.  Return arguments as a collection.\n\n\nSimple feature collection with 66 features and 41 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -51.06258 ymin: -22.91696 xmax: -39.85724 ymax: -14.23725\nCRS:           NA\n\nfp_mg.shp &lt;- st_make_valid(fp_mg.shp)\nfp_mg.shp &lt;- as_Spatial(fp_mg.shp)\n# encoding = \"UTF-8\"\n\n# Plotar o mapa\nplot(fp_mg.shp)"
  },
  {
    "objectID": "aede.html#atributos-do-shapefile",
    "href": "aede.html#atributos-do-shapefile",
    "title": "2  Análise Exploratória de Dados Espaciais (AED-E)",
    "section": "2.2 Atributos do shapefile",
    "text": "2.2 Atributos do shapefile\nPodemos ver a tabela de atributos do shapefile desta forma.\n\nhead(fp_mg.shp@data)\n\n  CODMIC      NOMMIC      Q     AC     AP    K   R  RP RNP DRNP   F    AREA\n1     41     Aimorés 134310  60132  60132 1833 363 155 208   25  84  8354.1\n2     49     Alfenas 564476 113253 113253 7203 312 273  39    8   1  4998.9\n3     14    Almenara  84631  20737  20737  783 383 150 233   15   1 15504.5\n4     55 Andrelândia  59164  27764  27764 1154 264 200  64   13 227  5047.3\n5     12     Araçuaí 159897  36779  36779  552 315 162 153   15   1 10299.4\n6     23       Araxá 495102 160580 160643 7582 645 564  81    6 327 14145.6\n  ESCTOT POPTOT    LP   ACP    KP   ETOTP   DRNPP       FP     RNPP      RPP\n1    347 152658 0.111 0.394 0.012 0.00227 0.00016 0.000550 0.001363 0.001015\n2    229 179366 0.111 0.631 0.040 0.00128 0.00004 0.000006 0.000217 0.001522\n3    384 213342 0.047 0.097 0.004 0.00180 0.00007 0.000005 0.001092 0.000703\n4    191  70783 0.037 0.392 0.016 0.00270 0.00018 0.003207 0.000904 0.002826\n5    327 143468 0.143 0.256 0.004 0.00228 0.00010 0.000007 0.001066 0.001129\n6    182 158275 0.043 1.015 0.048 0.00115 0.00004 0.002066 0.000512 0.003563\n       R_P       QP   X_COORD   Y_COORD CMICRO     VP      VPP    LA   LM     L\n1 0.002378 0.879810 -41.38876 -19.53116  31041  78349 0.513232 42737 3997 46734\n2 0.001739 3.147062 -46.01852 -21.37551  31049 216064 1.204598 33737 1118 34855\n3 0.001795 0.396692 -40.65978 -16.35385  31014  40164 0.188261 30920 4259 35179\n4 0.003730 0.835850 -44.44562 -21.95045  31055  42360 0.598449 15135  908 16043\n5 0.002196 1.114513 -41.87023 -17.00645  31012  28864 0.201188 45015 7069 52084\n6 0.004075 3.128112 -46.95948 -19.59779  31023 197010 1.244732 23442 1488 24930\n  CO_RUR  NU_RUR   CO_TOT      EER      K_L VEG TEMP PREC     KL\n1   4937 1314045  4402218 0.003757 0.039222   1    4    1 0.0392\n2   6736 2957879 12228817 0.002277 0.206656   2    2    3 0.2067\n3   1431  282421  3363297 0.005067 0.022258   2    5    1 0.0223\n4   1717  498819  2819950 0.003442 0.071932   2    1    4 0.0719\n5   1431  365829  2404595 0.003912 0.010598   3    4    1 0.0106\n6   4357 1476959 14220985 0.002950 0.304132   1    2    4 0.3041"
  },
  {
    "objectID": "aede.html#mapa",
    "href": "aede.html#mapa",
    "title": "2  Análise Exploratória de Dados Espaciais (AED-E)",
    "section": "2.3 Mapa",
    "text": "2.3 Mapa\nPodemos produzir um mapa colorido com os seguintes comandos.\n\np &lt;- colorRampPalette(c(\"white\", \"blue\"))(128)\npalette(p)\nplot(fp_mg.shp, col = fp_mg.shp@data$Q)\n\n\n\n\n\n2.3.1 Sua vez\nFaça um mapa com a variável AC com a cor vermelha.\n\n\nCódigo\np &lt;- colorRampPalette(c(\"yellow\", \"red\"))(128)\npalette(p)\nplot(fp_mg.shp, col = fp_mg.shp@data$AC)"
  },
  {
    "objectID": "matrizes.html#leitura-do-shapefile",
    "href": "matrizes.html#leitura-do-shapefile",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.1 Leitura do shapefile",
    "text": "3.1 Leitura do shapefile\nPara a leitura de arquivos shapefile no R, precisamos usar alguns pacotes. Após a instalação dos pacotes, use os seguintes comandos.\n\n# Pacotes\nlibrary(sf)\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(sp)\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n# Abra o arquivo 'gm10.shp'\nfp_mg.shp &lt;- st_read(\"data/FP_MG.shp\", options = \"ENCODING=WINDOWS-1252\")\n\noptions:        ENCODING=WINDOWS-1252 \nReading layer `FP_MG' from data source \n  `/home/rfsaldanha/projects/ecoespacial/data/FP_MG.shp' using driver `ESRI Shapefile'\n\n\nWarning in CPL_read_ogr(dsn, layer, query, as.character(options), quiet, : GDAL\nMessage 1: organizePolygons() received an unexpected geometry.  Either a\npolygon with interior rings, or a polygon with less than 4 points, or a\nnon-Polygon geometry.  Return arguments as a collection.\n\n\nSimple feature collection with 66 features and 41 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -51.06258 ymin: -22.91696 xmax: -39.85724 ymax: -14.23725\nCRS:           NA\n\nfp_mg.shp &lt;- st_make_valid(fp_mg.shp)\nfp_mg.shp &lt;- as_Spatial(fp_mg.shp)\n\n# Plotar o mapa\nplot(fp_mg.shp)\n\n\n\n\nPara a criação de matrizes de vizinhos espaciais, iremos utilizar o pacote spdep.\n\n# Pacote\nlibrary(spdep)\n\nLoading required package: spData\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\n\n\n3.1.1 Matriz queen e rook\n\n# Matriz queen\nw1 &lt;- nb2listw(poly2nb(fp_mg.shp, queen = TRUE))\nsummary(w1)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 336 \nPercentage nonzero weights: 7.713499 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 2  9 12 16 16  8  2  1 \n2 least connected regions:\n29 38 with 2 links\n1 most connected region:\n65 with 9 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 27.58858 269.8006\n\n# Matriz queen 2ª ordem\nw1.2 &lt;- nb2listw(nblag_cumul(nblag(poly2nb(fp_mg.shp, queen = TRUE), maxlag = 2)))\n\n# Matrix queen padronizada na linha\nw1.w &lt;- nb2listw(poly2nb(fp_mg.shp, queen=TRUE), style=\"W\")\nsummary(w1.w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 336 \nPercentage nonzero weights: 7.713499 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 2  9 12 16 16  8  2  1 \n2 least connected regions:\n29 38 with 2 links\n1 most connected region:\n65 with 9 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 27.58858 269.8006\n\n# Matriz rook\nw2 &lt;- nb2listw(poly2nb(fp_mg.shp, queen = FALSE))\nsummary(w2)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 332 \nPercentage nonzero weights: 7.621671 \nAverage number of links: 5.030303 \nLink number distribution:\n\n 2  3  4  5  6  7  8 \n 2  9 12 18 15  7  3 \n2 least connected regions:\n29 38 with 2 links\n3 most connected regions:\n12 26 65 with 8 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 27.82221 269.6778\n\n# Matriz rook padronizada globalmente\nw2.c &lt;- nb2listw(poly2nb(fp_mg.shp, queen = FALSE), style = \"C\")\nsummary(w2.c)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 332 \nPercentage nonzero weights: 7.621671 \nAverage number of links: 5.030303 \nLink number distribution:\n\n 2  3  4  5  6  7  8 \n 2  9 12 18 15  7  3 \n2 least connected regions:\n29 38 with 2 links\n3 most connected regions:\n12 26 65 with 8 links\n\nWeights style: C \nWeights constants summary:\n   n   nn S0       S1      S2\nC 66 4356 66 26.24096 285.489\n\n\n\n\n3.1.2 Distância inversa\n\ncoords &lt;- coordinates(fp_mg.shp)\nnb &lt;- dnearneigh(coords, 0, 1000)\ndlist &lt;- nbdists(nb, coords)\ndlist &lt;- lapply(dlist, function(x) 1/x^2)\nw3 &lt;- nb2listw(nb, glist=dlist)\nsummary(w3)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 4290 \nPercentage nonzero weights: 98.48485 \nAverage number of links: 65 \nLink number distribution:\n\n65 \n66 \n66 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n66 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 8.369751 267.6908\n\n# Distância inversa padronizada pelo número de vizinhos\nw3.u &lt;- nb2listw(nb, glist=dlist, style=\"U\")\nsummary(w3.u)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 4290 \nPercentage nonzero weights: 98.48485 \nAverage number of links: 65 \nLink number distribution:\n\n65 \n66 \n66 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n66 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n\nWeights style: U \nWeights constants summary:\n   n   nn S0          S1         S2\nU 66 4356  1 0.002368187 0.07316268\n\n\nPara ver mais opções, veja a ajuda deste comando: ?nb2listw\n\n\n3.1.3 Matriz de k-vizinhos espaciais\nA escolha do número ideal de \\(k\\) vizinhos será realizada testando-se vários \\(k\\) e utilizando-se o que retornou o maior valor para a estatística \\(I\\) de Moran significativo.\n\n# Número de permutações\nper &lt;- 999\n\n# Número máximo de k vizinhos testados\nkv &lt;- 20\n\n# Nome dos registros\nIDs &lt;- row.names(fp_mg.shp@data)\n\n# Criação da tabela que irá receber a estatística I de Moran e significância para cada k testado\nres.pesos &lt;- data.frame(k=numeric(),i=numeric(),valorp=numeric())\n\n# Início do loop\nfor(k in 1:kv)\n{\n  # Armazenando número k atual\n  res.pesos[k,1] &lt;- k\n  # Calculando o I e significância para o k atual\n  moran.k &lt;- moran.mc(fp_mg.shp@data$Q,\n                      listw=nb2listw(knn2nb(\n                      knearneigh(coords, k=k),\n                      row.names=IDs),style=\"B\"),\n                      nsim=per)\n  # Armazenando o valor I para o k atual\n  res.pesos[k,2] &lt;- moran.k$statistic\n  # Armazenando o p-value para o k atual\n  res.pesos[k,3] &lt;- moran.k$p.value\n}\n\n# Ver a tabela de k vizinhos, I de Moran e significância\nres.pesos\n\n    k         i valorp\n1   1 0.5228074  0.002\n2   2 0.3875458  0.002\n3   3 0.4531317  0.001\n4   4 0.4199339  0.001\n5   5 0.3944831  0.001\n6   6 0.3595862  0.001\n7   7 0.3461349  0.001\n8   8 0.3286129  0.001\n9   9 0.3064023  0.001\n10 10 0.3157462  0.001\n11 11 0.3028398  0.001\n12 12 0.2942354  0.001\n13 13 0.2791438  0.001\n14 14 0.2620697  0.001\n15 15 0.2541920  0.001\n16 16 0.2429784  0.001\n17 17 0.2320723  0.001\n18 18 0.2213339  0.001\n19 19 0.2117356  0.001\n20 20 0.2017898  0.001\n\n# Sendo todos significativos, iremos usar o k que retornou o maior valor I\nmaxi &lt;- which.max(res.pesos[,2])\n\n# Criação da matriz usando o k escolhido\nw5 &lt;- nb2listw(knn2nb(knearneigh(coords, k=maxi),row.names=IDs),style=\"B\")\nsummary(w5)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 66 \nPercentage nonzero weights: 1.515152 \nAverage number of links: 1 \nNon-symmetric neighbours list\nLink number distribution:\n\n 1 \n66 \n66 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 1 link\n66 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 1 link\n\nWeights style: B \nWeights constants summary:\n   n   nn S0 S1  S2\nB 66 4356 66 98 308"
  },
  {
    "objectID": "matrizes.html#autocorrelação-espacial-global",
    "href": "matrizes.html#autocorrelação-espacial-global",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.2 Autocorrelação espacial global",
    "text": "3.2 Autocorrelação espacial global\n\n3.2.1 I de Moran\n\nmoran.test(fp_mg.shp@data$Q, listw = w5)\n\n\n    Moran I test under randomisation\n\ndata:  fp_mg.shp@data$Q  \nweights: w5    \n\nMoran I statistic standard deviate = 3.8645, p-value = 5.566e-05\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n       0.52280745       -0.01538462        0.01939499 \n\nmoran.mc(fp_mg.shp@data$Q, listw = w5, nsim = 999)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  fp_mg.shp@data$Q \nweights: w5  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.52281, observed rank = 998, p-value = 0.002\nalternative hypothesis: greater\n\n\n\n\n3.2.2 C de Geary\n\ngeary.test(fp_mg.shp@data$Q, listw = w5)\n\n\n    Geary C test under randomisation\n\ndata:  fp_mg.shp@data$Q \nweights: w5 \n\nGeary C statistic standard deviate = 2.6176, p-value = 0.004428\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n       0.46130049        1.00000000        0.04235442 \n\ngeary.mc(fp_mg.shp@data$Q, listw = w5, nsim = 999)\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  fp_mg.shp@data$Q \nweights: w5 \nnumber of simulations + 1: 1000 \n\nstatistic = 0.4613, observed rank = 6, p-value = 0.006\nalternative hypothesis: greater\n\n\n\n\n3.2.3 G de Getis-Ord\n\nglobalG.test(as.vector(scale(fp_mg.shp@data$Q, center = FALSE)), listw = w5, B1correct = TRUE)\n\n\n    Getis-Ord global G statistic\n\ndata:  as.vector(scale(fp_mg.shp@data$Q, center = FALSE)) \nweights: w5 \n\nstandard deviate = 3.2113, p-value = 0.0006607\nalternative hypothesis: greater\nsample estimates:\nGlobal G statistic        Expectation           Variance \n      3.071155e-02       1.538462e-02       2.277991e-05"
  },
  {
    "objectID": "matrizes.html#autocorrelação-espacial-local",
    "href": "matrizes.html#autocorrelação-espacial-local",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.3 Autocorrelação espacial local",
    "text": "3.3 Autocorrelação espacial local\n\n3.3.1 G de Gettis-Ords\n\nlg1 &lt;- localG(fp_mg.shp@data$Q, listw = w5)\nsummary(lg1)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.69900 -0.53552 -0.44190 -0.04454 -0.06779  4.21616 \n\nhist(lg1)\n\n\n\n\n\n\n3.3.2 I de Moran\n\n# Cálculo\nlm1 &lt;- localmoran(fp_mg.shp@data$Q, listw = w5)\nsummary(lm1)\n\n       Ii                E.Ii                Var.Ii               Z.Ii        \n Min.   :-0.83956   Min.   :-2.629e-01   Min.   : 0.000197   Min.   :-4.1007  \n 1st Qu.: 0.07066   1st Qu.:-4.908e-03   1st Qu.: 0.089934   1st Qu.: 0.2869  \n Median : 0.20075   Median :-3.384e-03   Median : 0.222559   Median : 0.4695  \n Mean   : 0.52281   Mean   :-1.538e-02   Mean   : 0.860585   Mean   : 0.3957  \n 3rd Qu.: 0.27959   3rd Qu.:-1.365e-03   3rd Qu.: 0.322327   3rd Qu.: 0.5559  \n Max.   :11.31579   Max.   :-2.980e-06   Max.   :12.789972   Max.   : 4.2162  \n Pr(z != E(Ii))     \n Min.   :0.0000248  \n 1st Qu.:0.5703228  \n Median :0.6347460  \n Mean   :0.6120352  \n 3rd Qu.:0.7541930  \n Max.   :0.9892306  \n\n# Quantos são significativos?\nlm1 &lt;- as.data.frame(lm1)\ntable(lm1$`Pr(z &gt; 0)` &lt; 0.05)\n\n&lt; table of extent 0 &gt;"
  },
  {
    "objectID": "matrizes.html#diagrama-de-dispersão-de-moran",
    "href": "matrizes.html#diagrama-de-dispersão-de-moran",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.4 Diagrama de dispersão de Moran",
    "text": "3.4 Diagrama de dispersão de Moran\n\nmoran.plot(fp_mg.shp@data$Q, listw = w5)\n\n\n\n\n\n3.4.1 Sua vez\nCalcule o I de Moran local usando a matriz de vizinhança w1 para a variável ACe verifique quantas regiões são significativas. Depois, faça o diagrama de dispersão.\n\n\nCódigo\nhead(localmoran(fp_mg.shp@data$AC, listw = w1))\n\n\n            Ii          E.Ii       Var.Ii       Z.Ii Pr(z != E(Ii))\n1  0.008331081 -2.648711e-05 0.0004165402  0.4094977   0.6821744760\n2  0.849842734 -2.085884e-02 0.2071096162  1.9132389   0.0557174771\n3  0.529839200 -9.632289e-03 0.1500236654  1.3927995   0.1636804207\n4 -0.037360854 -6.355270e-03 0.0781466481 -0.1109136   0.9116848748\n5  0.276052134 -3.145335e-03 0.0317953356  1.5657765   0.1174009499\n6  2.695852306 -7.209967e-02 0.6784210807  3.3605386   0.0007779067\n\n\nCódigo\nmoran.plot(fp_mg.shp@data$AC, listw = w1)"
  },
  {
    "objectID": "matrizes.html#lisa-map",
    "href": "matrizes.html#lisa-map",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.5 LISA map",
    "text": "3.5 LISA map\nO R não tem uma função pronta para criar um mapa LISA, então nós criamos abaixo nossa própria função: lisaplot. Depois de declarada, uma função pode ser usada repetidamente variando seus argumentos.\nRode o código abaixo.\n\nlisaplot &lt;- function(shapefile, values, listw, pval = 0.05){\n  require(spdep)\n  \n  svalues &lt;- as.vector(scale(values, scale = FALSE))\n  lag_svalues &lt;- spdep::lag.listw(listw, svalues)\n  locm &lt;- spdep::localmoran(values, listw)\n  sig &lt;- rep(0, length(values))\n  \n  sig[(svalues &gt;= 0 & lag_svalues &gt;= 0) & (locm[,5] &lt;= pval)] &lt;- 1\n  sig[(svalues &lt;= 0 & lag_svalues &lt;= 0) & (locm[,5] &lt;= pval)] &lt;- 2\n  sig[(svalues &gt;= 0 & lag_svalues &lt;= 0) & (locm[,5] &lt;= pval)] &lt;- 3\n  sig[(svalues &lt;= 0 & lag_svalues &gt;= 0) & (locm[,5] &lt;= pval)] &lt;- 4\n  sig[locm[,5] &gt; pval] &lt;- 5\n  \n  breaks &lt;- seq(1, 5, 1)\n  labels &lt;- c(\"Alto-Alto\", \"Baixo-Baixo\", \"Alto-Baixo\", \"Baixo-Alto\", \"N. Sig.\")\n  np &lt;- findInterval(sig, breaks)\n  colors &lt;- c(\"red\", \"blue\", \"lightpink\", \"skyblue2\", \"white\")\n  plot(shapefile, col = colors[np])\n  mtext(\"LISA\", cex = 1.5, side = 3, line = 1)\n  legend(\"topleft\", legend = labels, fill = colors, bty = \"n\")\n}\n\nE o LISA para a variável TEMP.\n\nlisaplot(fp_mg.shp, fp_mg.shp@data$TEMP, w1)\n\n\n\n\n\n3.5.1 Sua vez\nFaça o LISA para a variável AP com a matriz w1.\n\n\nCódigo\nlisaplot(fp_mg.shp, fp_mg.shp@data$AP, w1)"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "Referências",
    "section": "",
    "text": "Almeida, Eduardo. 2012. Econometria Espacial Aplicada.\nCampinas: Alínea."
  }
]