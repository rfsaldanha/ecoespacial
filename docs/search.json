[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Econometria Espacial aplicada com R",
    "section": "",
    "text": "Apresentação\nEste livro on-line apresenta uma introdução a Econometria Espacial aplicada com R. Recomendamos como referência o livro Econometria Espacial aplicada (Almeida 2012).\n\nRaphael Saldanha é geógrafo, mestre em saúde pública, doutor em Informação e Comunicação em Saúde, postdoc researcher no Inria (Institut national de recherche en sciences et technologies du numérique, France).\nEduardo Almeida é economista, mestre e doutor em Economia, postdoc pela Escola Superior de Agricultura “Luiz de Queiroz”, professor adjunto da Faculdade de Economia da Universidade Federal de Juiz de Fora (UFJF) desde 2005.\n\n\n\n\nAlmeida, Eduardo. 2012. Econometria espacial aplicada. Campinas: Alínea."
  },
  {
    "objectID": "intro_r.html",
    "href": "intro_r.html",
    "title": "1  Introdução ao R",
    "section": "",
    "text": "2 Comandos básicos\nA interface do R não é recomendada para a criação de banco de dados. Como já existem centenas de opções de softwares de qualidade e gratuitos para este fim, os bancos de dados podem ser criados em outros softwares como o Excel e importados posteriormente para o R.\nExistem diversos pacotes para ler aquivos de banco de dados no R, como DBF, SAV, Stata e etc. Mas a forma mais segura e recomendada é exportar os dados no formato CSV para ser importados no R.\nAbaixo temos uma lista comandos para obter estatísticas básicas com o R e alguns gráficos.\n# Importar o arquivo 'notas.csv'\ndados &lt;- read.csv2(file = \"data/notas.csv\", header = TRUE)\n\n# Média\nmean(dados$nota)\n\n[1] 25.22667\n\n# Mediana\nmedian(dados$nota)\n\n[1] 26.3\n\n# Variância\nvar(dados$nota)\n\n[1] 144.4083\n\n# Desvio padrão\nsd(dados$nota)\n\n[1] 12.017\n\n# Valor máximo\nmax(dados$nota)\n\n[1] 40.9\n\n# Valor mínimo\nmin(dados$nota)\n\n[1] 10\n\n# Amplitude\nrange(dados$nota)\n\n[1] 10.0 40.9\n\n# Coeficiente de variação\nsd(dados$nota)/mean(dados$nota)\n\n[1] 0.476361\n\n# Quartis\nquantile(dados$nota)\n\n    0%    25%    50%    75%   100% \n10.000 16.250 26.300 32.795 40.900 \n\n# Sumário\nsummary(dados$nota)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  10.00   16.25   26.30   25.23   32.80   40.90 \n\n# Boxplot\nboxplot(dados$nota)\n\n\n\n# Histograma\nhist(dados$nota, main = \"Boxplot\", xlab = \"Classes\", ylab = \"Frequências\", col = \"tan\")"
  },
  {
    "objectID": "intro_r.html#instalando-o-r",
    "href": "intro_r.html#instalando-o-r",
    "title": "1  Introdução ao R",
    "section": "1.1 Instalando o R",
    "text": "1.1 Instalando o R\nUma copia do R pode ser obtida gratuitamente no site https://cran.r-project.org/. Atente para o sistema operacional antes de efetuar o download."
  },
  {
    "objectID": "intro_r.html#rstudio",
    "href": "intro_r.html#rstudio",
    "title": "1  Introdução ao R",
    "section": "1.2 RStudio",
    "text": "1.2 RStudio\nApós a instalação do R, ele já pode ser usado através de sua interface gráfica padrão. Contudo, é comum a utilização de interfaces de desenvolvimento (IDE - Integrated Development Environment) criada por terceiros.\nNeste material, iremos utilizar uma IDE chamada RStudio. Ela pode ser obtida gratuitamente no site https://posit.co/products/open-source/rstudio/.\nApós instalar e abrir o RStudio, você verá na tela duas áreas principais. A primeira é chamada de script e a segunda de console.\nA área de script é onde digitamos os comandos utilizados no R. Após preparar um comando, ele é executado pressionando o botão run na interface ou pressionando Ctrl + r no teclado. Ao executar um comando, ele será reproduzido na área do console e seu resultado virá logo abaixo.\nO script é um arquivo de texto que pode ser salvo e reaproveitado posteriormente. É comum encontrarmos em scripts do R linhas precedidas com o caractere #. Este simbolo indica um comentário, ou seja, um texto que não será interpretado como um comando no R.\n\n1.2.1 Que documento é este?\nO script é a forma mais tradicional de criar códigos para o R, mas ele tem algumas limitações. Por ser apenas um arquivo de texto simples, ele não é capaz de armazenar os resultados produzidos pelo R, guardar figuras e ser esteticamente apresentável.\nPor estes motivos e na onda da ciência reprodutível, foi criado o R Notebook. Um notebook é uma uma espécie de script versão 2.0, onde é possível escrever comentários com formatação, inserir código do R e ver o seu resultado logo abaixo. E a melhor parte: um notebook pode ser exportado para HTML ou PDF facilmente, facilitando o envio de pesquisas feitas com o R.\nEste arquivo que você está visualizando é um R Notebook. Os asteríscos e alguns símbolos que você está vendo no texto é uma forma de formatação chamada Markdown. Por exemplo, dois asterísticos entre uma palavra fazem com que ela fique em negrito. Neste link tem um guia desta linguagem.\nPara ver como está ficando o seu notebook, clique no botão Preview. Uma página irá aparecer com a pré-visualização do seu notebook. Para exportar para HTML ou PDF, use a seta para abaixo ao lado do botão (Knit to…)."
  },
  {
    "objectID": "intro_r.html#operações-matemáticas",
    "href": "intro_r.html#operações-matemáticas",
    "title": "1  Introdução ao R",
    "section": "2.1 Operações matemáticas",
    "text": "2.1 Operações matemáticas\nOs primeiros comandos no R são funções muito básicas para operações matemáticas. A parte verde abaixo é um chunk de código R no notebook. Isto indica ao RStudio que esta parte do texto deve ser intepretada como código R e não como texto. Para executar um chunk, pressione Ctrl + Shift + Enter.\n\n# Soma\n2+2\n\n[1] 4\n\n# Subtração\n4-2\n\n[1] 2\n\n# Multiplicação\n2*3\n\n[1] 6\n\n# Divisão\n4/2\n\n[1] 2\n\n# Exponenciação\n2^3\n\n[1] 8\n\n\nSe tudo correu bem, você deve ver acima o resultado das operações. Use o preview do notebook para ver como está ficando o resultado do documento.\n\n2.1.1 Sua vez\nRealize a seguinte operação no R \\(((2+3(5))/10)^2\\).\n\n\nCódigo\n((2+3*5)/10)^2\n\n\n[1] 2.89\n\n\nResultado correto: 2,89."
  },
  {
    "objectID": "intro_r.html#funções",
    "href": "intro_r.html#funções",
    "title": "1  Introdução ao R",
    "section": "2.2 Funções",
    "text": "2.2 Funções\nFunções são comandos que apresentam resultados com base em um ou mais argumentos. Teste os exemplos abaixo.\n\n# Raiz quadrada\nsqrt(x=9)\n\n[1] 3\n\n# Combinação de 10 elementos tomados 2 a 2\nchoose(n=10, k=2)\n\n[1] 45\n\n# e^x\nexp(2)\n\n[1] 7.389056\n\n# Logarítmo natural\nlog(1)\n\n[1] 0\n\n\n\n2.2.1 Sua vez\nCalcule a raiz quadrada do logaritmo de 10 no R.\n\n\nCódigo\nsqrt(log(x = 10))\n\n\n[1] 1.517427\n\n\nResultado correto: 1,51."
  },
  {
    "objectID": "intro_r.html#objetos",
    "href": "intro_r.html#objetos",
    "title": "1  Introdução ao R",
    "section": "2.3 Objetos",
    "text": "2.3 Objetos\nOs resultados de operações simples e funções no R podem ser armazenados na memória para utilização posterior através de objetos.\nNa linguagem R, objetos são abstrações na memória que podem conter desde um simples número até complexos bancos de dados. Estude os comandos abaixo.\n\n# Criar o objeto x\nx &lt;- 2\n\n# Imprimir o objeto x\nx\n\n[1] 2\n\n# Operações com o objeto x\nx^2\n\n[1] 4\n\nx+x\n\n[1] 4\n\n# Apagar o objeto x\nrm(x)\n\n# Criar o vetor y\ny &lt;- c(2, 5, 10, 11.3, 12)\n\n# Imprimir o vetor y\ny\n\n[1]  2.0  5.0 10.0 11.3 12.0\n\n# Elevar o vetor y ao quadrado\ny^2\n\n[1]   4.00  25.00 100.00 127.69 144.00\n\n# Apagar o vetor y\nrm(y)\n\n# Criar o vetor 'notas'\nnotas &lt;- c(60, 50, 20, 50, 90)\n\n# Ordenar o vetor 'notas'\nnotas &lt;- sort(notas)\n\n# Imprimir o vetor 'notas'\nnotas\n\n[1] 20 50 50 60 90\n\n\n\n2.3.1 Sua vez\nCrie um objeto chamado dados com os valores {5, 7, 12.7, 13, 15}. Eleve ao quadrado e obtenha o resultado da soma dos valores elevados com a função sum(x).\n\n\nCódigo\ndados &lt;- c(5, 7, 12.7, 13, 15)\nsum(dados^2)\n\n\n[1] 629.29\n\n\nResultado correto: 629,29."
  },
  {
    "objectID": "intro_r.html#operadores-lógicos",
    "href": "intro_r.html#operadores-lógicos",
    "title": "1  Introdução ao R",
    "section": "2.4 Operadores lógicos",
    "text": "2.4 Operadores lógicos\nEstes operados verificam afirmações de lógica, veja os comandos abaixo.\n\n# Igualdade\n2 == 2\n\n[1] TRUE\n\n2 == 5\n\n[1] FALSE\n\n\"a\" == \"a\"\n\n[1] TRUE\n\n\"a\" == 'A'\n\n[1] FALSE\n\n# Maior\n2 &gt; 3\n\n[1] FALSE\n\n2 &gt;= 3\n\n[1] FALSE\n\n# Menor\n2 &lt; 4\n\n[1] TRUE\n\n2 &lt;= 1\n\n[1] FALSE\n\nc(1,2,2,4,7,10) &lt; 7\n\n[1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE"
  },
  {
    "objectID": "intro_r.html#arquivos-csv",
    "href": "intro_r.html#arquivos-csv",
    "title": "1  Introdução ao R",
    "section": "3.1 Arquivos CSV",
    "text": "3.1 Arquivos CSV\nPara importar este arquivo CSV no R, teste o código abaixo. Se não funcionar, tente trocar “/” por “\\”.\n\n# Importar o arquivo 'notas.csv'\ndados &lt;- read.csv2(file = \"data/notas.csv\", header = TRUE)\n\nAtenção para os nomes das variáveis! Evite a utilização de nomes muito longos, caracteres especiais e acentos.\nApós importar um banco de dados, verifique se tudo correu bem com estes comandos.\n\n# Estrutura do objeto\nstr(dados)\n\n'data.frame':   6 obs. of  3 variables:\n $ id  : int  1 2 3 4 5 6\n $ nome: chr  \"Maria\" \"João\" \"José\" \"Maria\" ...\n $ nota: num  10 20 32.6 15 40.9 ...\n\n# Listar os nomes das variáveis\nnames(dados)\n\n[1] \"id\"   \"nome\" \"nota\"\n\n# Imprimir as seis primeiras linhas\nhead(dados)\n\n  id    nome  nota\n1  1   Maria 10.00\n2  2    João 20.00\n3  3    José 32.60\n4  4   Maria 15.00\n5  5 Gustavo 40.90\n6  6 Alfredo 32.86\n\n# Imprimir as seis últimas linhas\ntail(dados)\n\n  id    nome  nota\n1  1   Maria 10.00\n2  2    João 20.00\n3  3    José 32.60\n4  4   Maria 15.00\n5  5 Gustavo 40.90\n6  6 Alfredo 32.86\n\n\nPara acessar uma variável específica:\n\ndados$nota \n\n[1] 10.00 20.00 32.60 15.00 40.90 32.86\n\n\n\n3.1.1 Sua vez\nImporte o mesmo arquivo do exemplo mas com o argumento header = FALSE. Execute o comando str(x) e veja o que mudou.\n\n\nCódigo\ndados &lt;- read.csv2(file = \"data/notas.csv\", header = TRUE)\nstr(dados)\n\n\n'data.frame':   6 obs. of  3 variables:\n $ id  : int  1 2 3 4 5 6\n $ nome: chr  \"Maria\" \"João\" \"José\" \"Maria\" ...\n $ nota: num  10 20 32.6 15 40.9 ..."
  },
  {
    "objectID": "aede.html#leitura-do-shapefile",
    "href": "aede.html#leitura-do-shapefile",
    "title": "2  Análise Exploratória de Dados Espaciais (AED-E)",
    "section": "2.1 Leitura do shapefile",
    "text": "2.1 Leitura do shapefile\nPara a leitura de arquivos shapefile no R, precisamos usar alguns pacotes. Após a instalação dos pacotes, use os seguintes comandos.\n\n# Pacotes\nlibrary(sf)\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(sp)\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n# Abra o arquivo 'gm10.shp'\nfp_mg.shp &lt;- st_read(\"data/FP_MG.shp\", options = \"ENCODING=WINDOWS-1252\")\n\noptions:        ENCODING=WINDOWS-1252 \nReading layer `FP_MG' from data source \n  `/home/raphael/projects/ecoespacial/data/FP_MG.shp' using driver `ESRI Shapefile'\n\n\nWarning in CPL_read_ogr(dsn, layer, query, as.character(options), quiet, : GDAL\nMessage 1: organizePolygons() received an unexpected geometry.  Either a\npolygon with interior rings, or a polygon with less than 4 points, or a\nnon-Polygon geometry.  Return arguments as a collection.\n\n\nSimple feature collection with 66 features and 41 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -51.06258 ymin: -22.91696 xmax: -39.85724 ymax: -14.23725\nCRS:           NA\n\nfp_mg.shp &lt;- st_make_valid(fp_mg.shp)\nfp_mg.shp &lt;- as_Spatial(fp_mg.shp)\n# encoding = \"UTF-8\"\n\n# Plotar o mapa\nplot(fp_mg.shp)"
  },
  {
    "objectID": "aede.html#atributos-do-shapefile",
    "href": "aede.html#atributos-do-shapefile",
    "title": "2  Análise Exploratória de Dados Espaciais (AED-E)",
    "section": "2.2 Atributos do shapefile",
    "text": "2.2 Atributos do shapefile\nPodemos ver a tabela de atributos do shapefile desta forma.\n\nhead(fp_mg.shp@data)\n\n  CODMIC      NOMMIC      Q     AC     AP    K   R  RP RNP DRNP   F    AREA\n1     41     Aimorés 134310  60132  60132 1833 363 155 208   25  84  8354.1\n2     49     Alfenas 564476 113253 113253 7203 312 273  39    8   1  4998.9\n3     14    Almenara  84631  20737  20737  783 383 150 233   15   1 15504.5\n4     55 Andrelândia  59164  27764  27764 1154 264 200  64   13 227  5047.3\n5     12     Araçuaí 159897  36779  36779  552 315 162 153   15   1 10299.4\n6     23       Araxá 495102 160580 160643 7582 645 564  81    6 327 14145.6\n  ESCTOT POPTOT    LP   ACP    KP   ETOTP   DRNPP       FP     RNPP      RPP\n1    347 152658 0.111 0.394 0.012 0.00227 0.00016 0.000550 0.001363 0.001015\n2    229 179366 0.111 0.631 0.040 0.00128 0.00004 0.000006 0.000217 0.001522\n3    384 213342 0.047 0.097 0.004 0.00180 0.00007 0.000005 0.001092 0.000703\n4    191  70783 0.037 0.392 0.016 0.00270 0.00018 0.003207 0.000904 0.002826\n5    327 143468 0.143 0.256 0.004 0.00228 0.00010 0.000007 0.001066 0.001129\n6    182 158275 0.043 1.015 0.048 0.00115 0.00004 0.002066 0.000512 0.003563\n       R_P       QP   X_COORD   Y_COORD CMICRO     VP      VPP    LA   LM     L\n1 0.002378 0.879810 -41.38876 -19.53116  31041  78349 0.513232 42737 3997 46734\n2 0.001739 3.147062 -46.01852 -21.37551  31049 216064 1.204598 33737 1118 34855\n3 0.001795 0.396692 -40.65978 -16.35385  31014  40164 0.188261 30920 4259 35179\n4 0.003730 0.835850 -44.44562 -21.95045  31055  42360 0.598449 15135  908 16043\n5 0.002196 1.114513 -41.87023 -17.00645  31012  28864 0.201188 45015 7069 52084\n6 0.004075 3.128112 -46.95948 -19.59779  31023 197010 1.244732 23442 1488 24930\n  CO_RUR  NU_RUR   CO_TOT      EER      K_L VEG TEMP PREC     KL\n1   4937 1314045  4402218 0.003757 0.039222   1    4    1 0.0392\n2   6736 2957879 12228817 0.002277 0.206656   2    2    3 0.2067\n3   1431  282421  3363297 0.005067 0.022258   2    5    1 0.0223\n4   1717  498819  2819950 0.003442 0.071932   2    1    4 0.0719\n5   1431  365829  2404595 0.003912 0.010598   3    4    1 0.0106\n6   4357 1476959 14220985 0.002950 0.304132   1    2    4 0.3041"
  },
  {
    "objectID": "aede.html#mapa",
    "href": "aede.html#mapa",
    "title": "2  Análise Exploratória de Dados Espaciais (AED-E)",
    "section": "2.3 Mapa",
    "text": "2.3 Mapa\nPodemos produzir um mapa colorido com os seguintes comandos.\n\np &lt;- colorRampPalette(c(\"white\", \"blue\"))(128)\npalette(p)\nplot(fp_mg.shp, col = fp_mg.shp@data$Q)\n\n\n\n\n\n2.3.1 Sua vez\nFaça um mapa com a variável AC com a cor vermelha.\n\n\nCódigo\np &lt;- colorRampPalette(c(\"yellow\", \"red\"))(128)\npalette(p)\nplot(fp_mg.shp, col = fp_mg.shp@data$AC)"
  },
  {
    "objectID": "matrizes.html#leitura-do-shapefile",
    "href": "matrizes.html#leitura-do-shapefile",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.1 Leitura do shapefile",
    "text": "3.1 Leitura do shapefile\nPara a leitura de arquivos shapefile no R, precisamos usar alguns pacotes. Após a instalação dos pacotes, use os seguintes comandos.\n\n# Pacotes\nlibrary(sf)\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(sp)\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n# Abra o arquivo 'gm10.shp'\nfp_mg.shp &lt;- st_read(\"data/FP_MG.shp\", options = \"ENCODING=WINDOWS-1252\")\n\noptions:        ENCODING=WINDOWS-1252 \nReading layer `FP_MG' from data source \n  `/home/raphael/projects/ecoespacial/data/FP_MG.shp' using driver `ESRI Shapefile'\n\n\nWarning in CPL_read_ogr(dsn, layer, query, as.character(options), quiet, : GDAL\nMessage 1: organizePolygons() received an unexpected geometry.  Either a\npolygon with interior rings, or a polygon with less than 4 points, or a\nnon-Polygon geometry.  Return arguments as a collection.\n\n\nSimple feature collection with 66 features and 41 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -51.06258 ymin: -22.91696 xmax: -39.85724 ymax: -14.23725\nCRS:           NA\n\nfp_mg.shp &lt;- st_make_valid(fp_mg.shp)\nfp_mg.shp &lt;- as_Spatial(fp_mg.shp)\n\n# Plotar o mapa\nplot(fp_mg.shp)\n\n\n\n\nPara a criação de matrizes de vizinhos espaciais, iremos utilizar o pacote spdep.\n\n# Pacote\nlibrary(spdep)\n\nLoading required package: spData\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\n\n\n3.1.1 Matriz queen e rook\n\n# Matriz queen\nw1 &lt;- nb2listw(poly2nb(fp_mg.shp, queen = TRUE))\nsummary(w1)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 336 \nPercentage nonzero weights: 7.713499 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 2  9 12 16 16  8  2  1 \n2 least connected regions:\n29 38 with 2 links\n1 most connected region:\n65 with 9 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 27.58858 269.8006\n\n# Matriz queen 2ª ordem\nw1.2 &lt;- nb2listw(nblag_cumul(nblag(poly2nb(fp_mg.shp, queen = TRUE), maxlag = 2)))\n\n# Matrix queen padronizada na linha\nw1.w &lt;- nb2listw(poly2nb(fp_mg.shp, queen=TRUE), style=\"W\")\nsummary(w1.w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 336 \nPercentage nonzero weights: 7.713499 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 2  9 12 16 16  8  2  1 \n2 least connected regions:\n29 38 with 2 links\n1 most connected region:\n65 with 9 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 27.58858 269.8006\n\n# Matriz rook\nw2 &lt;- nb2listw(poly2nb(fp_mg.shp, queen = FALSE))\nsummary(w2)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 332 \nPercentage nonzero weights: 7.621671 \nAverage number of links: 5.030303 \nLink number distribution:\n\n 2  3  4  5  6  7  8 \n 2  9 12 18 15  7  3 \n2 least connected regions:\n29 38 with 2 links\n3 most connected regions:\n12 26 65 with 8 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 27.82221 269.6778\n\n# Matriz rook padronizada globalmente\nw2.c &lt;- nb2listw(poly2nb(fp_mg.shp, queen = FALSE), style = \"C\")\nsummary(w2.c)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 332 \nPercentage nonzero weights: 7.621671 \nAverage number of links: 5.030303 \nLink number distribution:\n\n 2  3  4  5  6  7  8 \n 2  9 12 18 15  7  3 \n2 least connected regions:\n29 38 with 2 links\n3 most connected regions:\n12 26 65 with 8 links\n\nWeights style: C \nWeights constants summary:\n   n   nn S0       S1      S2\nC 66 4356 66 26.24096 285.489\n\n\n\n\n3.1.2 Distância inversa\n\ncoords &lt;- coordinates(fp_mg.shp)\nnb &lt;- dnearneigh(coords, 0, 1000)\ndlist &lt;- nbdists(nb, coords)\ndlist &lt;- lapply(dlist, function(x) 1/x^2)\nw3 &lt;- nb2listw(nb, glist=dlist)\nsummary(w3)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 4290 \nPercentage nonzero weights: 98.48485 \nAverage number of links: 65 \nLink number distribution:\n\n65 \n66 \n66 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n66 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 66 4356 66 8.369751 267.6908\n\n# Distância inversa padronizada pelo número de vizinhos\nw3.u &lt;- nb2listw(nb, glist=dlist, style=\"U\")\nsummary(w3.u)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 4290 \nPercentage nonzero weights: 98.48485 \nAverage number of links: 65 \nLink number distribution:\n\n65 \n66 \n66 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n66 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 65 links\n\nWeights style: U \nWeights constants summary:\n   n   nn S0          S1         S2\nU 66 4356  1 0.002368187 0.07316268\n\n\nPara ver mais opções, veja a ajuda deste comando: ?nb2listw\n\n\n3.1.3 Matriz de k-vizinhos espaciais\nA escolha do número ideal de \\(k\\) vizinhos será realizada testando-se vários \\(k\\) e utilizando-se o que retornou o maior valor para a estatística \\(I\\) de Moran significativo.\n\n# Número de permutações\nper &lt;- 999\n\n# Número máximo de k vizinhos testados\nkv &lt;- 20\n\n# Nome dos registros\nIDs &lt;- row.names(fp_mg.shp@data)\n\n# Criação da tabela que irá receber a estatística I de Moran e significância para cada k testado\nres.pesos &lt;- data.frame(k=numeric(),i=numeric(),valorp=numeric())\n\n# Início do loop\nfor(k in 1:kv)\n{\n  # Armazenando número k atual\n  res.pesos[k,1] &lt;- k\n  # Calculando o I e significância para o k atual\n  moran.k &lt;- moran.mc(fp_mg.shp@data$Q,\n                      listw=nb2listw(knn2nb(\n                      knearneigh(coords, k=k),\n                      row.names=IDs),style=\"B\"),\n                      nsim=per)\n  # Armazenando o valor I para o k atual\n  res.pesos[k,2] &lt;- moran.k$statistic\n  # Armazenando o p-value para o k atual\n  res.pesos[k,3] &lt;- moran.k$p.value\n}\n\n# Ver a tabela de k vizinhos, I de Moran e significância\nres.pesos\n\n    k         i valorp\n1   1 0.5228074  0.005\n2   2 0.3875458  0.003\n3   3 0.4531317  0.001\n4   4 0.4199339  0.001\n5   5 0.3944831  0.001\n6   6 0.3595862  0.001\n7   7 0.3461349  0.001\n8   8 0.3286129  0.001\n9   9 0.3064023  0.001\n10 10 0.3157462  0.001\n11 11 0.3028398  0.001\n12 12 0.2942354  0.001\n13 13 0.2791438  0.001\n14 14 0.2620697  0.001\n15 15 0.2541920  0.001\n16 16 0.2429784  0.001\n17 17 0.2320723  0.001\n18 18 0.2213339  0.001\n19 19 0.2117356  0.001\n20 20 0.2017898  0.001\n\n# Sendo todos significativos, iremos usar o k que retornou o maior valor I\nmaxi &lt;- which.max(res.pesos[,2])\n\n# Criação da matriz usando o k escolhido\nw5 &lt;- nb2listw(knn2nb(knearneigh(coords, k=maxi),row.names=IDs),style=\"B\")\nsummary(w5)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 66 \nNumber of nonzero links: 66 \nPercentage nonzero weights: 1.515152 \nAverage number of links: 1 \nNon-symmetric neighbours list\nLink number distribution:\n\n 1 \n66 \n66 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 1 link\n66 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 with 1 link\n\nWeights style: B \nWeights constants summary:\n   n   nn S0 S1  S2\nB 66 4356 66 98 308"
  },
  {
    "objectID": "matrizes.html#autocorrelação-espacial-global",
    "href": "matrizes.html#autocorrelação-espacial-global",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.2 Autocorrelação espacial global",
    "text": "3.2 Autocorrelação espacial global\n\n3.2.1 I de Moran\n\nmoran.test(fp_mg.shp@data$Q, listw = w5)\n\n\n    Moran I test under randomisation\n\ndata:  fp_mg.shp@data$Q  \nweights: w5    \n\nMoran I statistic standard deviate = 3.8645, p-value = 5.566e-05\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n       0.52280745       -0.01538462        0.01939499 \n\nmoran.mc(fp_mg.shp@data$Q, listw = w5, nsim = 999)\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  fp_mg.shp@data$Q \nweights: w5  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.52281, observed rank = 998, p-value = 0.002\nalternative hypothesis: greater\n\n\n\n\n3.2.2 C de Geary\n\ngeary.test(fp_mg.shp@data$Q, listw = w5)\n\n\n    Geary C test under randomisation\n\ndata:  fp_mg.shp@data$Q \nweights: w5 \n\nGeary C statistic standard deviate = 2.6176, p-value = 0.004428\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n       0.46130049        1.00000000        0.04235442 \n\ngeary.mc(fp_mg.shp@data$Q, listw = w5, nsim = 999)\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  fp_mg.shp@data$Q \nweights: w5 \nnumber of simulations + 1: 1000 \n\nstatistic = 0.4613, observed rank = 3, p-value = 0.003\nalternative hypothesis: greater\n\n\n\n\n3.2.3 G de Getis-Ord\n\nglobalG.test(as.vector(scale(fp_mg.shp@data$Q, center = FALSE)), listw = w5, B1correct = TRUE)\n\n\n    Getis-Ord global G statistic\n\ndata:  as.vector(scale(fp_mg.shp@data$Q, center = FALSE)) \nweights: w5 \n\nstandard deviate = 3.2113, p-value = 0.0006607\nalternative hypothesis: greater\nsample estimates:\nGlobal G statistic        Expectation           Variance \n      3.071155e-02       1.538462e-02       2.277991e-05"
  },
  {
    "objectID": "matrizes.html#autocorrelação-espacial-local",
    "href": "matrizes.html#autocorrelação-espacial-local",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.3 Autocorrelação espacial local",
    "text": "3.3 Autocorrelação espacial local\n\n3.3.1 G de Gettis-Ords\n\nlg1 &lt;- localG(fp_mg.shp@data$Q, listw = w5)\nsummary(lg1)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.69900 -0.53552 -0.44190 -0.04454 -0.06779  4.21616 \n\nhist(lg1)\n\n\n\n\n\n\n3.3.2 I de Moran\n\n# Cálculo\nlm1 &lt;- localmoran(fp_mg.shp@data$Q, listw = w5)\nsummary(lm1)\n\n       Ii                E.Ii                Var.Ii               Z.Ii        \n Min.   :-0.83956   Min.   :-2.629e-01   Min.   : 0.000197   Min.   :-4.1007  \n 1st Qu.: 0.07066   1st Qu.:-4.908e-03   1st Qu.: 0.089934   1st Qu.: 0.2869  \n Median : 0.20075   Median :-3.384e-03   Median : 0.222559   Median : 0.4695  \n Mean   : 0.52281   Mean   :-1.538e-02   Mean   : 0.860585   Mean   : 0.3957  \n 3rd Qu.: 0.27959   3rd Qu.:-1.365e-03   3rd Qu.: 0.322327   3rd Qu.: 0.5559  \n Max.   :11.31579   Max.   :-2.980e-06   Max.   :12.789972   Max.   : 4.2162  \n Pr(z != E(Ii))     \n Min.   :0.0000248  \n 1st Qu.:0.5703228  \n Median :0.6347460  \n Mean   :0.6120352  \n 3rd Qu.:0.7541930  \n Max.   :0.9892306  \n\n# Quantos são significativos?\nlm1 &lt;- as.data.frame(lm1)\ntable(lm1$`Pr(z != E(Ii))` &lt; 0.05)\n\n\nFALSE  TRUE \n   61     5"
  },
  {
    "objectID": "matrizes.html#diagrama-de-dispersão-de-moran",
    "href": "matrizes.html#diagrama-de-dispersão-de-moran",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.4 Diagrama de dispersão de Moran",
    "text": "3.4 Diagrama de dispersão de Moran\n\nmoran.plot(fp_mg.shp@data$Q, listw = w5)\n\n\n\n\n\n3.4.1 Sua vez\nCalcule o I de Moran local usando a matriz de vizinhança w1 para a variável ACe verifique quantas regiões são significativas. Depois, faça o diagrama de dispersão.\n\n\nCódigo\nhead(localmoran(fp_mg.shp@data$AC, listw = w1))\n\n\n            Ii          E.Ii       Var.Ii       Z.Ii Pr(z != E(Ii))\n1  0.008331081 -2.648711e-05 0.0004165402  0.4094977   0.6821744760\n2  0.849842734 -2.085884e-02 0.2071096162  1.9132389   0.0557174771\n3  0.529839200 -9.632289e-03 0.1500236654  1.3927995   0.1636804207\n4 -0.037360854 -6.355270e-03 0.0781466481 -0.1109136   0.9116848748\n5  0.276052134 -3.145335e-03 0.0317953356  1.5657765   0.1174009499\n6  2.695852306 -7.209967e-02 0.6784210807  3.3605386   0.0007779067\n\n\nCódigo\nmoran.plot(fp_mg.shp@data$AC, listw = w1)"
  },
  {
    "objectID": "matrizes.html#lisa-map",
    "href": "matrizes.html#lisa-map",
    "title": "3  Matrizes de vizinhos espaciais",
    "section": "3.5 LISA map",
    "text": "3.5 LISA map\nO R não tem uma função pronta para criar um mapa LISA, então nós criamos abaixo nossa própria função: lisaplot. Depois de declarada, uma função pode ser usada repetidamente variando seus argumentos.\nRode o código abaixo.\n\nlisaplot &lt;- function(shapefile, values, listw, pval = 0.05){\n  require(spdep)\n  \n  svalues &lt;- as.vector(scale(values, scale = FALSE))\n  lag_svalues &lt;- spdep::lag.listw(listw, svalues)\n  locm &lt;- spdep::localmoran(values, listw)\n  sig &lt;- rep(0, length(values))\n  \n  sig[(svalues &gt;= 0 & lag_svalues &gt;= 0) & (locm[,5] &lt;= pval)] &lt;- 1\n  sig[(svalues &lt;= 0 & lag_svalues &lt;= 0) & (locm[,5] &lt;= pval)] &lt;- 2\n  sig[(svalues &gt;= 0 & lag_svalues &lt;= 0) & (locm[,5] &lt;= pval)] &lt;- 3\n  sig[(svalues &lt;= 0 & lag_svalues &gt;= 0) & (locm[,5] &lt;= pval)] &lt;- 4\n  sig[locm[,5] &gt; pval] &lt;- 5\n  \n  breaks &lt;- seq(1, 5, 1)\n  labels &lt;- c(\"Alto-Alto\", \"Baixo-Baixo\", \"Alto-Baixo\", \"Baixo-Alto\", \"N. Sig.\")\n  np &lt;- findInterval(sig, breaks)\n  colors &lt;- c(\"red\", \"blue\", \"lightpink\", \"skyblue2\", \"white\")\n  plot(shapefile, col = colors[np])\n  mtext(\"LISA\", cex = 1.5, side = 3, line = 1)\n  legend(\"topleft\", legend = labels, fill = colors, bty = \"n\")\n}\n\nE o LISA para a variável TEMP.\n\nlisaplot(fp_mg.shp, fp_mg.shp@data$TEMP, w1)\n\n\n\n\n\n3.5.1 Sua vez\nFaça o LISA para a variável AP com a matriz w1.\n\n\nCódigo\nlisaplot(fp_mg.shp, fp_mg.shp@data$AP, w1)"
  },
  {
    "objectID": "modelos_corte_transversal.html#pacotes",
    "href": "modelos_corte_transversal.html#pacotes",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.1 Pacotes",
    "text": "4.1 Pacotes\n\nlibrary(spatialreg)\n\nLoading required package: spData\n\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\n\nLoading required package: Matrix\n\n\nLoading required package: sf\n\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(spdep)\n\n\nAttaching package: 'spdep'\n\n\nThe following objects are masked from 'package:spatialreg':\n\n    get.ClusterOption, get.coresOption, get.mcOption,\n    get.VerboseOption, get.ZeroPolicyOption, set.ClusterOption,\n    set.coresOption, set.mcOption, set.VerboseOption,\n    set.ZeroPolicyOption\n\n# remotes::install_github(\"gpiras/sphet\")\nlibrary(sphet)\n\n\nAttaching package: 'sphet'\n\n\nThe following object is masked from 'package:spatialreg':\n\n    impacts"
  },
  {
    "objectID": "modelos_corte_transversal.html#shapefile",
    "href": "modelos_corte_transversal.html#shapefile",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.2 Shapefile",
    "text": "4.2 Shapefile\n\n# Pacotes\nlibrary(sf)\nlibrary(sp)\n\n# Abra o arquivo\nmontana.shp &lt;- st_read(\"data/natregimes_montana.gml\")\n\nReading layer `natregimes_montana' from data source \n  `/home/raphael/projects/ecoespacial/data/natregimes_montana.gml' \n  using driver `GML'\nSimple feature collection with 55 features and 74 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -116.0625 ymin: 44.35373 xmax: -104.0426 ymax: 49\nGeodetic CRS:  WGS 84\n\nmontana.shp &lt;- st_make_valid(montana.shp)\nmontana.shp &lt;- as_Spatial(montana.shp)\n\n# Plotar o mapa\nplot(montana.shp)\n\n\n\n\n\nlibrary(leaflet)\nlibrary(RColorBrewer)\nlibrary(htmltools)\n\nqpal &lt;- colorQuantile(\"OrRd\", montana.shp@data$RD90, n=5) \n\nleaflet(montana.shp) %&gt;%\n  addPolygons(stroke = FALSE, fillOpacity = .8, smoothFactor = 0.2,\n              fillColor = ~qpal(RD90), popup = ~htmlEscape(NAME),\n              highlight = highlightOptions(fillOpacity = 0.5,\n                                           bringToFront = TRUE)) %&gt;%\n  addTiles()"
  },
  {
    "objectID": "modelos_corte_transversal.html#matriz-de-vizinhança",
    "href": "modelos_corte_transversal.html#matriz-de-vizinhança",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.3 Matriz de vizinhança",
    "text": "4.3 Matriz de vizinhança\n\nw1 &lt;- spdep::nb2listw(spdep::poly2nb(montana.shp, queen = FALSE), style = \"W\")\nW &lt;- as(w1, \"CsparseMatrix\")\ntrMat &lt;- trW(W, type=\"mult\")"
  },
  {
    "objectID": "modelos_corte_transversal.html#especificação-do-modelo",
    "href": "modelos_corte_transversal.html#especificação-do-modelo",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.4 Especificação do modelo",
    "text": "4.4 Especificação do modelo\n\nesp1 &lt;- HR90 ~ RD90\nendog &lt;- ~ UE90\ninstruments &lt;- ~ FH90\n\n\nHR: homicide rate per 100,000 (1960, 1970, 1980, 1990)\nRD: resource deprivation 1960, 1970, 1980, 1990 (principal component)\nUE: unemployment rate 1960, 1970, 1980, 1990\nFH: % female headed households 1960, 1970, 1980, 1990"
  },
  {
    "objectID": "modelos_corte_transversal.html#ols",
    "href": "modelos_corte_transversal.html#ols",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.5 OLS",
    "text": "4.5 OLS\n\\(y = \\alpha + X\\beta + \\varepsilon\\)\n\nmod1.mcrl &lt;- lm(formula = esp1, data = montana.shp@data)\nsummary(mod1.mcrl)\n\n\nCall:\nlm(formula = esp1, data = montana.shp@data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-6.546 -3.017 -1.025  2.422 16.951 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   3.7853     0.6129   6.176 9.49e-08 ***\nRD90          2.8836     1.0923   2.640   0.0109 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.433 on 53 degrees of freedom\nMultiple R-squared:  0.1162,    Adjusted R-squared:  0.09954 \nF-statistic: 6.969 on 1 and 53 DF,  p-value: 0.01087"
  },
  {
    "objectID": "modelos_corte_transversal.html#multiplicador-de-lagrange",
    "href": "modelos_corte_transversal.html#multiplicador-de-lagrange",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.6 Multiplicador de Lagrange",
    "text": "4.6 Multiplicador de Lagrange\n\nmod1.lagrange &lt;- lm.LMtests(model = mod1.mcrl, listw = w1,\n                            test = c(\"LMerr\",\"RLMerr\",\"LMlag\",\"RLMlag\"))\nmod1.lagrange\n\n\n    Lagrange multiplier diagnostics for spatial dependence\n\ndata:  \nmodel: lm(formula = esp1, data = montana.shp@data)\nweights: w1\n\nLMerr = 0.9605, df = 1, p-value = 0.3271\n\n\n    Lagrange multiplier diagnostics for spatial dependence\n\ndata:  \nmodel: lm(formula = esp1, data = montana.shp@data)\nweights: w1\n\nRLMerr = 0.13243, df = 1, p-value = 0.7159\n\n\n    Lagrange multiplier diagnostics for spatial dependence\n\ndata:  \nmodel: lm(formula = esp1, data = montana.shp@data)\nweights: w1\n\nLMlag = 0.84352, df = 1, p-value = 0.3584\n\n\n    Lagrange multiplier diagnostics for spatial dependence\n\ndata:  \nmodel: lm(formula = esp1, data = montana.shp@data)\nweights: w1\n\nRLMlag = 0.015448, df = 1, p-value = 0.9011"
  },
  {
    "objectID": "modelos_corte_transversal.html#sar-mv",
    "href": "modelos_corte_transversal.html#sar-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.7 SAR (MV)",
    "text": "4.7 SAR (MV)\n\\(y = \\rho W y + X \\beta + \\varepsilon\\)\n\nmod1.sar &lt;- lagsarlm(formula = esp1, data = montana.shp@data, listw = w1)\nsummary(mod1.sar)\n\n\nCall:lagsarlm(formula = esp1, data = montana.shp@data, listw = w1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4712 -3.0399 -1.3250  2.5259 16.8433 \n\nType: lag \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value  Pr(&gt;|z|)\n(Intercept)  3.16687    0.85033  3.7243 0.0001959\nRD90         2.91026    1.06059  2.7440 0.0060695\n\nRho: 0.1792, LR test value: 0.84239, p-value: 0.35871\nAsymptotic standard error: 0.18437\n    z-value: 0.97196, p-value: 0.33107\nWald statistic: 0.94472, p-value: 0.33107\n\nLog likelihood: -158.4951 for lag model\nML residual variance (sigma squared): 18.519, (sigma: 4.3034)\nNumber of observations: 55 \nNumber of parameters estimated: 4 \nAIC: 324.99, (AIC for lm: 323.83)\nLM test for residual autocorrelation\ntest value: 0.54172, p-value: 0.46172\n\nsummary(spatialreg::impacts(mod1.sar, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (lag, trace):\n       Direct  Indirect    Total\nRD90 2.930558 0.6150693 3.545627\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n       Direct Indirect    Total\nRD90 1.082814 1.055907 1.737506\n\nSimulated z-values:\n       Direct  Indirect    Total\nRD90 2.726874 0.7755076 2.170675\n\nSimulated p-values:\n     Direct    Indirect Total   \nRD90 0.0063937 0.43804  0.029956"
  },
  {
    "objectID": "modelos_corte_transversal.html#sac-stsls",
    "href": "modelos_corte_transversal.html#sac-stsls",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.8 SAC (STSLS)",
    "text": "4.8 SAC (STSLS)\n\nmod1.sac_stsls &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"lag\", het = TRUE, endog = endog, instruments = instruments\n)\nsummary(mod1.sac_stsls)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, model = \"lag\", het = TRUE)\n\nResiduals:\n    Min.  1st Qu.   Median  3rd Qu.     Max. \n-6.48374 -2.44405 -0.88756  1.14961 16.99149 \n\nCoefficients:\n            Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.22654    2.07993 -0.5897 0.5553893    \nRD90         0.25793    1.11656  0.2310 0.8173100    \nUE90         0.74020    0.20802  3.5583 0.0003733 ***\nlambda       0.05640    0.58238  0.0968 0.9228503    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nmod1.sac_stsls2 &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"lag\", het = TRUE\n)\nsummary(mod1.sac_stsls2)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, model = \"lag\", \n    het = TRUE)\n\nResiduals:\n   Min. 1st Qu.  Median 3rd Qu.    Max. \n-6.5149 -3.0147 -1.1715  2.4648 16.9064 \n\nCoefficients:\n            Estimate Std. Error t-value Pr(&gt;|t|)  \n(Intercept) 3.529675   2.405383  1.4674  0.14227  \nRD90        2.894640   1.215182  2.3821  0.01722 *\nlambda      0.074062   0.613635  0.1207  0.90393  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(sphet::impacts(mod1.sac_stsls2, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (lag, trace):\n       Direct  Indirect    Total\nRD90 2.897931 0.2282375 3.126169\n========================================================\nSimulation results (IV variance matrix):\n========================================================\nSimulated standard errors\n      Direct Indirect    Total\nRD90 1.34087  7.16599 7.784841\n\nSimulated z-values:\n       Direct  Indirect     Total\nRD90 2.365747 0.2695954 0.6556433\n\nSimulated p-values:\n     Direct   Indirect Total  \nRD90 0.017994 0.78747  0.51205"
  },
  {
    "objectID": "modelos_corte_transversal.html#sem-mv",
    "href": "modelos_corte_transversal.html#sem-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.9 SEM (MV)",
    "text": "4.9 SEM (MV)\n\\(y = X \\beta + u \\\\ u = \\lambda Wu + \\varepsilon\\)\n\nmod1.sem &lt;- errorsarlm(formula = esp1, data = montana.shp@data, listw = w1)\nsummary(mod1.sem)\n\n\nCall:errorsarlm(formula = esp1, data = montana.shp@data, listw = w1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4097 -3.0084 -1.1481  2.5629 16.6659 \n\nType: error \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value  Pr(&gt;|z|)\n(Intercept)  3.75130    0.73537  5.1012 3.375e-07\nRD90         2.89021    1.03890  2.7820  0.005402\n\nLambda: 0.20192, LR test value: 0.98506, p-value: 0.32095\nAsymptotic standard error: 0.18804\n    z-value: 1.0738, p-value: 0.28291\nWald statistic: 1.153, p-value: 0.28291\n\nLog likelihood: -158.4237 for error model\nML residual variance (sigma squared): 18.436, (sigma: 4.2937)\nNumber of observations: 55 \nNumber of parameters estimated: 4 \nAIC: NA (not available for weighted model), (AIC for lm: 323.83)"
  },
  {
    "objectID": "modelos_corte_transversal.html#sem-gmm",
    "href": "modelos_corte_transversal.html#sem-gmm",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.10 SEM (GMM)",
    "text": "4.10 SEM (GMM)\n\nmod1.sem_gmm &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"error\", step1.c = TRUE, het = TRUE, endog = endog, instruments = instruments\n)\n\nsummary(mod1.sem_gmm)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, model = \"error\", het = TRUE, step1.c = TRUE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-6.3752 -2.4238 -0.8875  0.0024  1.0903 17.0276 \n\nCoefficients:\n            Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.00926    1.20513 -0.8375 0.4023291    \nRD90         0.26659    1.05846  0.2519 0.8011428    \nUE90         0.73641    0.19803  3.7188 0.0002002 ***\nrho          0.06864    0.30236  0.2270 0.8204140    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "modelos_corte_transversal.html#sac-mv",
    "href": "modelos_corte_transversal.html#sac-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.11 SAC (MV)",
    "text": "4.11 SAC (MV)\n\\(y = \\rho Wy + X \\beta + u \\\\ u = \\lambda Wu + \\varepsilon\\)\n\nmod1.sac &lt;- sacsarlm(formula = esp1, data = montana.shp@data, listw = w1)\nsummary(mod1.sac)\n\n\nCall:sacsarlm(formula = esp1, data = montana.shp@data, listw = w1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4318 -3.0064 -1.2061  2.5673 16.7131 \n\nType: sac \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)   3.5980     2.7176  1.3240 0.185507\nRD90          2.9052     1.0866  2.6736 0.007505\n\nRho: 0.047078\nAsymptotic standard error: 0.8077\n    z-value: 0.058287, p-value: 0.95352\nLambda: 0.16245\nAsymptotic standard error: 0.79051\n    z-value: 0.2055, p-value: 0.83718\n\nLR test value: 0.99918, p-value: 0.60678\n\nLog likelihood: -158.4167 for sac model\nML residual variance (sigma squared): 18.481, (sigma: 4.2989)\nNumber of observations: 55 \nNumber of parameters estimated: 5 \nAIC: 326.83, (AIC for lm: 323.83)\n\nsummary(spatialreg::impacts(mod1.sac, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (sac, trace):\n      Direct  Indirect    Total\nRD90 2.90656 0.1422079 3.048768\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n       Direct Indirect    Total\nRD90 1.281712 10.26618 11.06283\n\nSimulated z-values:\n       Direct  Indirect     Total\nRD90 2.560148 0.3007061 0.5756642\n\nSimulated p-values:\n     Direct   Indirect Total  \nRD90 0.010463 0.76364  0.56484"
  },
  {
    "objectID": "modelos_corte_transversal.html#sac-gmm",
    "href": "modelos_corte_transversal.html#sac-gmm",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.12 SAC (GMM)",
    "text": "4.12 SAC (GMM)\n\nmod1.sac_gmm &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"sarar\", step1.c = FALSE, het = TRUE, endog = endog, instruments = instruments\n)\n\nsummary(mod1.sac_gmm)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, model = \"sarar\", het = TRUE, step1.c = FALSE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-6.5102 -2.4510 -0.8904 -0.0013  1.1410 16.9844 \n\nCoefficients:\n             Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.282437   2.519760 -0.5090 0.6107858    \nRD90         0.240835   1.194968  0.2015 0.8402758    \nUE90         0.743794   0.207021  3.5928 0.0003271 ***\nlambda       0.065972   0.627655  0.1051 0.9162890    \nrho          0.302036   0.557139  0.5421 0.5877362    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nWald test that rho and lambda are both zero:\n Statistics: 0.65153 p-val: 0.41956 \n\n\n\nmod1.sac_gmm2 &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"sarar\", step1.c = FALSE, het = TRUE\n)\n\nsummary(mod1.sac_gmm2)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, model = \"sarar\", \n    het = TRUE, step1.c = FALSE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n -6.521  -3.003  -1.089   0.021   2.463  16.953 \n\nCoefficients:\n            Estimate Std. Error t-value Pr(&gt;|t|)  \n(Intercept) 3.651563   2.415507  1.5117  0.13061  \nRD90        2.897586   1.212861  2.3890  0.01689 *\nlambda      0.032985   0.615118  0.0536  0.95723  \nrho         0.012935   0.619914  0.0209  0.98335  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nWald test that rho and lambda are both zero:\n Statistics: 0.040424 p-val: 0.84065 \n\nsummary(sphet::impacts(mod1.sac_gmm2, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (lag, trace):\n       Direct   Indirect    Total\nRD90 2.898229 0.09819482 2.996424\n========================================================\nSimulation results (GSTSLS variance matrix):\n========================================================\nSimulated standard errors\n       Direct Indirect    Total\nRD90 1.433497  11.1196 11.89106\n\nSimulated z-values:\n       Direct  Indirect     Total\nRD90 2.213154 0.2619944 0.5117984\n\nSimulated p-values:\n     Direct   Indirect Total  \nRD90 0.026887 0.79333  0.60879"
  },
  {
    "objectID": "modelos_corte_transversal.html#slx-mv",
    "href": "modelos_corte_transversal.html#slx-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.13 SLX (MV)",
    "text": "4.13 SLX (MV)\n\\(y = X \\beta + WX \\theta + \\varepsilon\\)\n\nmod1.slx &lt;- lmSLX(formula = esp1, data = montana.shp@data, listw = w1)\nsummary(mod1.slx)\n\n\nCall:\nlm(formula = formula(paste(\"y ~ \", paste(colnames(x)[-1], collapse = \"+\"))), \n    data = as.data.frame(x), weights = weights)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-6.511 -3.005 -1.008  2.432 16.870 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   3.7377     0.7334   5.097 4.91e-06 ***\nRD90          2.8635     1.1151   2.568   0.0131 *  \nlag.RD90     -0.2870     2.3742  -0.121   0.9043    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.474 on 52 degrees of freedom\nMultiple R-squared:  0.1165,    Adjusted R-squared:  0.08248 \nF-statistic: 3.427 on 2 and 52 DF,  p-value: 0.03998\n\nsummary(spatialreg::impacts(mod1.slx, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (SlX, glht, n-k):\n      Direct  Indirect    Total\nRD90 2.86351 -0.286971 2.576539\n========================================================\nStandard errors:\n       Direct Indirect   Total\nRD90 1.115113 2.374184 2.76964\n========================================================\nZ-values:\n      Direct   Indirect     Total\nRD90 2.56791 -0.1208714 0.9302793\n\np-values:\n     Direct   Indirect Total  \nRD90 0.010231 0.90379  0.35223"
  },
  {
    "objectID": "modelos_corte_transversal.html#slx-stsls",
    "href": "modelos_corte_transversal.html#slx-stsls",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.14 SLX (STSLS)",
    "text": "4.14 SLX (STSLS)\n\nmod1.slx_stsls &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  lag.instr = FALSE, Durbin = TRUE, model = \"ols\", step1.c = TRUE, \n  het = TRUE, endog = endog, instruments = instruments\n)\n\nsummary(mod1.slx_stsls)\n\n\n Stsls with Spatial HAC standard errors\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, lag.instr = FALSE, model = \"ols\", \n    het = TRUE, step1.c = TRUE, Durbin = TRUE)\n\nResiduals:\n    Min.  1st Qu.   Median  3rd Qu.     Max. \n-6.40823 -2.46165 -0.84138  1.08488 17.06315 \n\nCoefficients:\n            Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.05506    1.15580 -0.9128 0.3613275    \nRD90         0.23420    1.04646  0.2238 0.8229104    \nlag_RD90     0.13117    2.06873  0.0634 0.9494441    \nUE90         0.74709    0.19354  3.8602 0.0001133 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nmod1.slx_stsls2 &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  lag.instr = FALSE, Durbin = TRUE, model = \"ols\", step1.c = TRUE, \n  het = TRUE\n)\n\nsummary(sphet::impacts(mod1.slx_stsls2, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (SlX, glht, n-k):\n      Direct  Indirect    Total\nRD90 2.86351 -0.286971 2.576539\n========================================================\nStandard errors:\n       Direct Indirect    Total\nRD90 1.213777 2.216879 2.652204\n========================================================\nZ-values:\n       Direct   Indirect     Total\nRD90 2.359174 -0.1294482 0.9714708\n\np-values:\n     Direct   Indirect Total  \nRD90 0.018316 0.897    0.33131"
  },
  {
    "objectID": "modelos_corte_transversal.html#sdm-mv",
    "href": "modelos_corte_transversal.html#sdm-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.15 SDM (MV)",
    "text": "4.15 SDM (MV)\n\\(y = \\rho Wy + X \\beta + WX \\theta + \\varepsilon\\)\n\nmod1.sdm &lt;- lagsarlm(formula = esp1, data = montana.shp@data, listw = w1, Durbin = TRUE)\nsummary(mod1.sdm)\n\n\nCall:lagsarlm(formula = esp1, data = montana.shp@data, listw = w1, \n    Durbin = TRUE)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.3395 -2.9909 -1.0769  2.5768 16.5460 \n\nType: mixed \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)  2.91618    0.98963  2.9467 0.003212\nRD90         2.84391    1.06989  2.6581 0.007857\nlag.RD90    -0.99818    2.33320 -0.4278 0.668785\n\nRho: 0.20387, LR test value: 1.002, p-value: 0.31682\nAsymptotic standard error: 0.18781\n    z-value: 1.0855, p-value: 0.27771\nWald statistic: 1.1783, p-value: 0.27771\n\nLog likelihood: -158.4075 for mixed model\nML residual variance (sigma squared): 18.422, (sigma: 4.2921)\nNumber of observations: 55 \nNumber of parameters estimated: 5 \nAIC: 326.82, (AIC for lm: 325.82)\nLM test for residual autocorrelation\ntest value: 1.0407, p-value: 0.30766\n\nsummary(spatialreg::impacts(mod1.sdm, tr=trMat, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (mixed, trace):\n       Direct   Indirect    Total\nRD90 2.825151 -0.5067765 2.318375\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n       Direct Indirect    Total\nRD90 1.133103  3.02785 3.622303\n\nSimulated z-values:\n       Direct   Indirect     Total\nRD90 2.471098 -0.1734147 0.6280354\n\nSimulated p-values:\n     Direct  Indirect Total  \nRD90 0.01347 0.86233  0.52998"
  },
  {
    "objectID": "modelos_corte_transversal.html#sdem-mv",
    "href": "modelos_corte_transversal.html#sdem-mv",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.16 SDEM (MV)",
    "text": "4.16 SDEM (MV)\n\\(y = X \\beta + WX \\theta + u \\\\ u = \\lambda Wu + \\varepsilon\\)\n\nmod1.sdem &lt;- errorsarlm(formula = esp1, data = montana.shp@data, listw = w1, Durbin = TRUE)\nsummary(mod1.sdem)\n\n\nCall:errorsarlm(formula = esp1, data = montana.shp@data, listw = w1, \n    Durbin = TRUE)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.3568 -2.9878 -1.0313  2.5668 16.5735 \n\nType: error \nCoefficients: (asymptotic standard errors) \n            Estimate Std. Error z value  Pr(&gt;|z|)\n(Intercept)  3.69127    0.85423  4.3212 1.552e-05\nRD90         2.83836    1.10454  2.5697   0.01018\nlag.RD90    -0.33914    2.45675 -0.1380   0.89021\n\nLambda: 0.20244, LR test value: 0.98866, p-value: 0.32007\nAsymptotic standard error: 0.18799\n    z-value: 1.0769, p-value: 0.28153\nWald statistic: 1.1597, p-value: 0.28153\n\nLog likelihood: -158.4142 for error model\nML residual variance (sigma squared): 18.429, (sigma: 4.2929)\nNumber of observations: 55 \nNumber of parameters estimated: 5 \nAIC: NA (not available for weighted model), (AIC for lm: 325.82)"
  },
  {
    "objectID": "modelos_corte_transversal.html#sdem-gmm",
    "href": "modelos_corte_transversal.html#sdem-gmm",
    "title": "4  Modelos espaciais de corte transversal (cross-section)",
    "section": "4.17 SDEM (GMM)",
    "text": "4.17 SDEM (GMM)\n\nmod1.sdem_gmm &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"error\", Durbin = TRUE, \n  step1.c = TRUE, het = TRUE, endog = endog, instruments = instruments\n)\n\nsummary(mod1.sdem_gmm)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, endog = endog, \n    instruments = instruments, model = \"error\", het = TRUE, step1.c = TRUE, \n    Durbin = TRUE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-6.3805 -2.4459 -0.8510  0.0021  1.0907 17.0541 \n\nCoefficients:\n             Estimate Std. Error t-value  Pr(&gt;|t|)    \n(Intercept) -1.012074   1.163428 -0.8699 0.3843513    \nRD90         0.265070   1.061400  0.2497 0.8027915    \nlag_RD90     0.092892   2.131567  0.0436 0.9652397    \nUE90         0.739299   0.195456  3.7824 0.0001553 ***\nrho          0.064293   0.302432  0.2126 0.8316499    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nmod1.sdem_gmm2 &lt;- spreg(\n  formula = esp1, data = montana.shp@data, listw = w1,\n  model = \"error\", Durbin = TRUE, \n  step1.c = TRUE, het = TRUE\n)\n\nsummary(mod1.sdem_gmm2)\n\n\n Generalized stsls\n\nCall:\nspreg(formula = esp1, data = montana.shp@data, listw = w1, model = \"error\", \n    het = TRUE, step1.c = TRUE, Durbin = TRUE)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-6.4510 -2.9793 -0.9784  0.0323  2.4635 16.8868 \n\nCoefficients:\n            Estimate Std. Error t-value Pr(&gt;|t|)    \n(Intercept)  3.69503    0.78036  4.7350 2.19e-06 ***\nRD90         2.84006    1.26364  2.2475  0.02461 *  \nlag_RD90    -0.33439    2.40223 -0.1392  0.88929    \nrho          0.19018    0.20037  0.9491  0.34256    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(sphet::impacts(mod1.sdem_gmm2, tr=w_matrix$tr, R=1000), zstats=TRUE, short=TRUE)\n\nImpact measures (SlX, glht, n-k):\n       Direct   Indirect    Total\nRD90 2.840057 -0.3343859 2.505671\n========================================================\nStandard errors:\n       Direct Indirect   Total\nRD90 1.263635 2.402231 3.03313\n========================================================\nZ-values:\n      Direct  Indirect     Total\nRD90 2.24753 -0.139198 0.8261007\n\np-values:\n     Direct   Indirect Total  \nRD90 0.024606 0.88929  0.40875"
  },
  {
    "objectID": "gwr.html#pacote",
    "href": "gwr.html#pacote",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.1 Pacote",
    "text": "5.1 Pacote\n\nlibrary(mgwrsar)\n\nLoading required package: Rcpp\n\n\nLoading required package: sp\n\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n\nLoading required package: leaflet\n\n\nLoading required package: Matrix"
  },
  {
    "objectID": "gwr.html#shapefile",
    "href": "gwr.html#shapefile",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.2 Shapefile",
    "text": "5.2 Shapefile\n\n# Pacotes\nlibrary(sf)\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(sp)\n\n# Abra o arquivo 'gm10.shp'\nbrmicro.shp &lt;- st_read(\"data/br_micro.shp\", options = \"ENCODING=WINDOWS-1252\")\n\noptions:        ENCODING=WINDOWS-1252 \nReading layer `br_micro' from data source \n  `/home/raphael/projects/ecoespacial/data/br_micro.shp' using driver `ESRI Shapefile'\nSimple feature collection with 558 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -73.99095 ymin: -33.75086 xmax: -32.37889 ymax: 5.272225\nCRS:           NA\n\nbrmicro.shp &lt;- st_make_valid(brmicro.shp)\nbrmicro.shp &lt;- as_Spatial(brmicro.shp)\n\n# Plotar o mapa\nplot(brmicro.shp)"
  },
  {
    "objectID": "gwr.html#dados",
    "href": "gwr.html#dados",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.3 Dados",
    "text": "5.3 Dados\n\ndados &lt;- read.csv2(\"data/Dados_GWR.csv\", header = TRUE)\nstr(dados)\n\n'data.frame':   558 obs. of  17 variables:\n $ ID     : int  110001 110002 110003 110004 110005 110006 110007 110008 120001 120002 ...\n $ X_COORD: num  -64.5 -63.8 -62.6 -62.5 -62.8 ...\n $ Y_COORD: num  -9.42 -11.68 -9.53 -10.54 -11.67 ...\n $ P9303  : num  -0.0492 0.0584 0.2066 0.0747 0.157 ...\n $ Q9303  : num  0.881 0.148 0.195 -0.627 0.366 ...\n $ P93    : num  8.3 4.64 2.54 3.1 1.82 ...\n $ G0     : num  0 0.44 0.694 0.626 0.781 ...\n $ CT9303 : num  1.91 1.71 1.66 2.21 3.08 ...\n $ CI9303 : num  1.147 2.03 -1.385 -0.294 1.647 ...\n $ CC9303 : num  1.206 -0.165 1.662 1.975 2.734 ...\n $ WP9303 : num  0.2632 0.0802 0.1186 0.0738 0.0905 ...\n $ WQ9303 : num  0.853 0.146 1.075 0.42 -0.171 ...\n $ WP93   : num  3.79 3.54 3.96 2.65 2.89 ...\n $ WG0    : num  0.409 0.544 0.372 0.546 0.612 ...\n $ WCT9303: num  1.62 2.49 1.15 2.08 2.23 ...\n $ WCI9303: num  -0.817 0.809 0.718 1.654 0.824 ...\n $ WCC9303: num  1.64 2.09 1.02 1.33 1.42 ..."
  },
  {
    "objectID": "gwr.html#especificação",
    "href": "gwr.html#especificação",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.4 Especificação",
    "text": "5.4 Especificação\nQ9303 : Taxa de crescimento da produção agrícola microrregional no período de 1993 a 2003 P9303: Taxa de crescimento da produtividade da terra no período de 1993 a 2003 G0: medida de gap tecnológico CI9303: taxa de crescimento do crédito para investimento agrícola no período de 1993 a 2003.\n\nesp &lt;-  Q9303 ~ P9303 + G0 + CI9303"
  },
  {
    "objectID": "gwr.html#modelo-ols",
    "href": "gwr.html#modelo-ols",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.5 Modelo OLS",
    "text": "5.5 Modelo OLS\n\nmod1 &lt;- lm(formula = esp, data = dados)\nsummary(mod1)\n\n\nCall:\nlm(formula = esp, data = dados)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.2571 -0.3653 -0.0417  0.2531 12.1204 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.255015   0.054681   4.664  3.9e-06 ***\nP9303        1.692115   0.124878  13.550  &lt; 2e-16 ***\nG0           0.041733   0.033751   1.236    0.217    \nCI9303      -0.002689   0.019658  -0.137    0.891    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9564 on 554 degrees of freedom\nMultiple R-squared:  0.2672,    Adjusted R-squared:  0.2632 \nF-statistic: 67.33 on 3 and 554 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "gwr.html#verificando-erros-do-modelo",
    "href": "gwr.html#verificando-erros-do-modelo",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.6 Verificando erros do modelo",
    "text": "5.6 Verificando erros do modelo\n\nplot(mod1, which=3)"
  },
  {
    "objectID": "gwr.html#verificando-resíduos-no-espaço",
    "href": "gwr.html#verificando-resíduos-no-espaço",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.7 Verificando resíduos no espaço",
    "text": "5.7 Verificando resíduos no espaço\n\nresids &lt;- residuals(mod1)\ncores &lt;- c(\"dark blue\", \"blue\", \"red\", \"dark red\") \nmap.resids &lt;- SpatialPointsDataFrame(data=data.frame(resids), coords=cbind(dados$X_COORD,dados$Y_COORD)) \nspplot(map.resids, cuts=quantile(resids), col.regions=cores, cex=1)"
  },
  {
    "objectID": "gwr.html#gwr-com-kernel-gaussiano",
    "href": "gwr.html#gwr-com-kernel-gaussiano",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.8 GWR com kernel gaussiano",
    "text": "5.8 GWR com kernel gaussiano\n\ncoord &lt;- as.matrix(cbind(dados$X_COORD,dados$Y_COORD))\n\n\nmod1.gwr &lt;- MGWRSAR(formula = esp, data = dados, \n                    coord = coord,\n                    fixed_vars = NULL, kernels = c('gauss'), H = 0.60,\n                    Model = 'GWR',\n                    control=list(SE = TRUE, doMC = TRUE, ncore = 4))\n\nsummary_mgwrsar(mod1.gwr)\n\nCall:\nMGWRSAR(formula = esp, data = dados, coord = coord, fixed_vars = NULL, \n    kernels = c(\"gauss\"), H = 0.6, Model = \"GWR\", control = list(SE = TRUE, \n        doMC = TRUE, ncore = 4))\nModel: GWR \nKernels function: gauss \nKernels adaptive: NO \nKernels type: GD \nBandwidth: 0.6 \nComputation time: 0.731 \nUse of parallel computing: TRUE  ncore = 4 \nUse of rough kernel: NO \nUse of Target Points: NO \nNumber of data points: 558 \nVarying parameters: Intercept P9303 G0 CI9303 \n          Intercept       P9303          G0  CI9303\nMin.    -8.2811e+02 -2.1688e+01 -7.6471e+00 -2.6374\n1st Qu. -1.9185e-01  9.8576e-01 -2.7433e-01 -0.0609\nMedian   1.1666e-01  1.8369e+00 -1.5489e-03  0.0025\nMean    -1.9452e+00  1.8003e+00  2.1188e+00  0.0377\n3rd Qu.  5.2344e-01  2.3682e+00  3.2038e-01  0.0652\nMax.     6.2005e+00  3.3002e+01  8.3419e+02  2.1745\nEffective degrees of freedom: 214.4194 \nAIC 1286.154 \nResidual sum of squares: 176.9171 \nRMSE: 0.5630771 \n\nplot_mgwrsar(mod1.gwr,type='B_coef',var='CI9303', radius = 20000)\n\n\n\n\nplot_mgwrsar(mod1.gwr,type='t_coef',var='CI9303', radius = 20000)"
  },
  {
    "objectID": "gwr.html#gwr-com-cv-leave-one-out-e-kernel-adaptativo-biquadrado-considerando-20-vizinhos-e-remoção-de-outliers",
    "href": "gwr.html#gwr-com-cv-leave-one-out-e-kernel-adaptativo-biquadrado-considerando-20-vizinhos-e-remoção-de-outliers",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.9 GWR com ‘CV leave one out’ e kernel adaptativo biquadrado (considerando 20 vizinhos) e remoção de outliers",
    "text": "5.9 GWR com ‘CV leave one out’ e kernel adaptativo biquadrado (considerando 20 vizinhos) e remoção de outliers\n\nmod2.gwr &lt;- MGWRSAR(formula = esp, data = dados, coord=coord,\n                    fixed_vars = NULL, kernels = c('bisq'), H=20,\n                    Model = 'GWR',\n                    control=list(isgcv=TRUE,remove_local_outlier=TRUE,outv=0.01))\nsummary_mgwrsar(mod2.gwr)\n\nCall:\nMGWRSAR(formula = esp, data = dados, coord = coord, fixed_vars = NULL, \n    kernels = c(\"bisq\"), H = 20, Model = \"GWR\", control = list(isgcv = TRUE, \n        remove_local_outlier = TRUE, outv = 0.01))\nModel: GWR \nKernels function: bisq \nKernels adaptive: NO \nKernels type: GD \nBandwidth: 20 \nComputation time: 0.628 \nUse of parallel computing: FALSE  ncore = 1 \nUse of rough kernel: NO \nUse of Target Points: NO \nNumber of data points: 558 \nVarying parameters: Intercept P9303 G0 CI9303 \n          Intercept       P9303          G0  CI9303\nMin.     0.10424379  0.90006692 -1.34446628 -0.1101\n1st Qu.  0.15206433  1.67545203  0.00461598 -0.0202\nMedian   0.21499269  1.70988054  0.02319197 -0.0138\nMean     0.24363087  1.71237373  0.00073565 -0.0121\n3rd Qu.  0.27568400  1.77191031  0.08011017 -0.0071\nMax.     1.23604439  2.16398074  0.10863633  0.0588\nResidual sum of squares: 499.5637 \nRMSE: 0.94619 \n\n\nSaiba mais em: https://cran.r-project.org/web/packages/mgwrsar/vignettes/mgwrsar-basic_examples.html"
  },
  {
    "objectID": "gwr.html#usando-o-pacote-spgwr",
    "href": "gwr.html#usando-o-pacote-spgwr",
    "title": "5  Regressão Ponderada Geograficamente (GWR)",
    "section": "5.10 Usando o pacote spgwr",
    "text": "5.10 Usando o pacote spgwr\n\nlibrary(spgwr)\n\nLoading required package: spData\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\n\nNOTE: This package does not constitute approval of GWR\nas a method of spatial analysis; see example(gwr)\n\n\n\n5.10.1 Kernel bandwith\n\nGWRbandwidth &lt;- gwr.sel(esp, data=dados, coords = cbind(dados$X_COORD,dados$Y_COORD), adapt = TRUE) \n\nAdaptive q: 0.381966 CV score: 513.9403 \nAdaptive q: 0.618034 CV score: 514.5733 \nAdaptive q: 0.236068 CV score: 510.1655 \nAdaptive q: 0.145898 CV score: 509.9981 \nAdaptive q: 0.1818601 CV score: 509.6378 \nAdaptive q: 0.1867464 CV score: 509.5685 \nAdaptive q: 0.2055856 CV score: 509.9121 \nAdaptive q: 0.1894925 CV score: 509.6879 \nAdaptive q: 0.1852418 CV score: 509.6098 \nAdaptive q: 0.1877954 CV score: 509.6292 \nAdaptive q: 0.1864049 CV score: 509.5482 \nAdaptive q: 0.1861779 CV score: 509.5577 \nAdaptive q: 0.1864456 CV score: 509.5506 \nAdaptive q: 0.1863466 CV score: 509.5485 \nAdaptive q: 0.1864049 CV score: 509.5482 \n\n\n\n\n5.10.2 Modelo GWR\n\nmod4.gwr = gwr(esp, data=dados, coords = cbind(dados$X_COORD,dados$Y_COORD), adapt=GWRbandwidth, hatmatrix=TRUE, se.fit=TRUE) \nmod4.gwr\n\nCall:\ngwr(formula = esp, data = dados, coords = cbind(dados$X_COORD, \n    dados$Y_COORD), adapt = GWRbandwidth, hatmatrix = TRUE, se.fit = TRUE)\nKernel function: gwr.Gauss \nAdaptive quantile: 0.1864049 (about 104 of 558 data points)\nSummary of GWR coefficient estimates at data points:\n                  Min.   1st Qu.    Median   3rd Qu.      Max.  Global\nX.Intercept. -0.276464 -0.066091  0.143081  0.367378  0.612604  0.2550\nP9303         1.207676  1.483514  1.872278  2.474311  2.747145  1.6921\nG0           -0.081195 -0.034559  0.015841  0.118441  0.173140  0.0417\nCI9303       -0.046286 -0.028744  0.016651  0.074686  0.121517 -0.0027\nNumber of data points: 558 \nEffective number of parameters (residual: 2traceS - traceS'S): 17.35644 \nEffective degrees of freedom (residual: 2traceS - traceS'S): 540.6436 \nSigma (residual: 2traceS - traceS'S): 0.9203189 \nEffective number of parameters (model: traceS): 13.31951 \nEffective degrees of freedom (model: traceS): 544.6805 \nSigma (model: traceS): 0.9169021 \nSigma (ML): 0.9058927 \nAICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 1502.684 \nAIC (GWR p. 96, eq. 4.22): 1486.556 \nResidual sum of squares: 457.918 \nQuasi-global R2: 0.3378047"
  },
  {
    "objectID": "modelos_painel.html#pacotes",
    "href": "modelos_painel.html#pacotes",
    "title": "6  Modelos espaciais em painel",
    "section": "6.1 Pacotes",
    "text": "6.1 Pacotes\nO pacote plm é responsável pelos painéis convencionais (não espaciais) que usaremos para comparação. O pacote splm é responsável pelos painéis espaciais. Os autores do pacote lançaram um artigo sobre ele neste link.\n\nlibrary(spatialreg)\n\nLoading required package: spData\n\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\n\nLoading required package: Matrix\n\n\nLoading required package: sf\n\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(plm)\nlibrary(splm)\n\n\nAttaching package: 'splm'\n\n\nThe following object is masked from 'package:spatialreg':\n\n    impacts"
  },
  {
    "objectID": "modelos_painel.html#shapefile",
    "href": "modelos_painel.html#shapefile",
    "title": "6  Modelos espaciais em painel",
    "section": "6.2 Shapefile",
    "text": "6.2 Shapefile\n\n# Pacotes\nlibrary(sf)\nlibrary(sp)\n\n# Abra o arquivo\nnatregimes_montana.shp &lt;- st_read(\"data/natregimes_montana.gml\")\n\nReading layer `natregimes_montana' from data source \n  `/home/raphael/projects/ecoespacial/data/natregimes_montana.gml' \n  using driver `GML'\nSimple feature collection with 55 features and 74 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -116.0625 ymin: 44.35373 xmax: -104.0426 ymax: 49\nGeodetic CRS:  WGS 84\n\nnatregimes_montana.shp &lt;- st_make_valid(natregimes_montana.shp)\nnatregimes_montana.shp &lt;- as_Spatial(natregimes_montana.shp)\n\n# Plotar o mapa\nplot(natregimes_montana.shp)"
  },
  {
    "objectID": "modelos_painel.html#dados",
    "href": "modelos_painel.html#dados",
    "title": "6  Modelos espaciais em painel",
    "section": "6.3 Dados",
    "text": "6.3 Dados\nUma olhada nos dados.\n\nstr(natregimes_montana.shp@data)\n\n'data.frame':   55 obs. of  74 variables:\n $ fid       : chr  \"natregimes_montana.0\" \"natregimes_montana.1\" \"natregimes_montana.2\" \"natregimes_montana.3\" ...\n $ REGIONS   : num  2 2 2 2 2 2 2 2 2 2 ...\n $ NOSOUTH   : num  1 1 1 1 1 1 1 1 1 1 ...\n $ POLY_ID   : int  7 8 9 10 11 12 13 24 25 26 ...\n $ NAME      : chr  \"Lincoln\" \"Flathead\" \"Glacier\" \"Toole\" ...\n $ STATE_NAME: chr  \"Montana\" \"Montana\" \"Montana\" \"Montana\" ...\n $ STATE_FIPS: int  30 30 30 30 30 30 30 30 30 30 ...\n $ CNTY_FIPS : int  53 29 35 101 51 41 91 5 71 105 ...\n $ FIPS      : int  30053 30029 30035 30101 30051 30041 30091 30005 30071 30105 ...\n $ STFIPS    : int  30 30 30 30 30 30 30 30 30 30 ...\n $ COFIPS    : int  53 29 35 101 51 41 91 5 71 105 ...\n $ FIPSNO    : int  30053 30029 30035 30101 30051 30041 30091 30005 30071 30105 ...\n $ SOUTH     : int  0 0 0 0 0 0 0 0 0 0 ...\n $ HR60      : num  7.98 1.01 11.53 0 0 ...\n $ HR70      : num  5.54 1.69 9.27 5.71 0 ...\n $ HR80      : num  5.63 4.49 28.23 0 0 ...\n $ HR90      : num  5.72 2.81 5.5 6.61 0 ...\n $ HC60      : num  1 0.333 1.333 0 0 ...\n $ HC70      : num  1 0.667 1 0.333 0 ...\n $ HC80      : num  1 2.33 3 0 0 ...\n $ HC90      : num  1 1.667 0.667 0.333 0 ...\n $ PO60      : int  12537 32965 11565 7904 2624 18653 6458 8091 6027 17080 ...\n $ PO70      : int  18063 39460 10783 5839 2359 17358 5779 6727 5386 11471 ...\n $ PO80      : int  17752 51966 10628 5559 2329 17985 5414 6999 5367 10250 ...\n $ PO90      : int  17481 59218 12121 5046 2295 17654 4732 6728 5163 8239 ...\n $ RD60      : num  -1.404 -1.136 -0.315 -1.246 -0.972 ...\n $ RD70      : num  -1.543 -0.885 0.201 -0.636 -0.73 ...\n $ RD80      : num  -0.907 -0.939 0.413 -0.314 -0.181 ...\n $ RD90      : num  -0.234 -0.305 1.479 -0.649 -0.298 ...\n $ PS60      : num  -0.982 -0.346 -0.967 -1.117 -1.865 ...\n $ PS70      : num  -0.698 -0.232 -1.002 -1.314 -1.878 ...\n $ PS80      : num  -0.797 -0.131 -1.107 -1.433 -1.965 ...\n $ PS90      : num  -0.8041 -0.0598 -1.0004 -1.4703 -1.9292 ...\n $ UE60      : num  17.3 13.8 12.8 5.5 5.1 6.3 5.5 7.1 4.3 8.6 ...\n $ UE70      : num  10.3 9.8 12.6 3.6 0.5 4.3 3 10.6 4.3 5.1 ...\n $ UE80      : num  27.53 14.23 8.56 3.55 1.83 ...\n $ UE90      : num  16.12 7.72 16.96 1.85 2.6 ...\n $ DV60      : num  3.44 2.6 3.86 3.3 2.4 ...\n $ DV70      : num  3.8 3.3 3.5 4.07 3.11 ...\n $ DV80      : num  6.13 6.22 5.84 4.64 4.21 ...\n $ DV90      : num  9.57 9.28 7.82 7.69 4.44 ...\n $ MA60      : num  24.8 30.1 22.8 25.9 24.8 24 29.2 25.3 28.9 23.4 ...\n $ MA70      : num  25.1 28 22.1 29.4 26.9 24.2 31.3 26.8 29 25.2 ...\n $ MA80      : num  28.3 29.7 26.8 29.9 30 27.2 33.4 27.5 29.6 29.4 ...\n $ MA90      : num  34.7 35.3 28.2 35.3 34 31.7 39.6 31.6 34 36.9 ...\n $ POL60     : num  9.44 10.4 9.36 8.98 7.87 ...\n $ POL70     : num  9.8 10.58 9.29 8.67 7.77 ...\n $ POL80     : num  9.78 10.86 9.27 8.62 7.75 ...\n $ POL90     : num  9.77 10.99 9.4 8.53 7.74 ...\n $ DNL60     : num  1.217 1.859 1.361 1.4 0.601 ...\n $ DNL70     : num  1.582 2.039 1.291 1.097 0.494 ...\n $ DNL80     : num  1.59 2.32 1.27 1.06 0.49 ...\n $ DNL90     : num  1.577 2.452 1.398 0.971 0.473 ...\n $ MFIL59    : num  8.61 8.59 8.55 8.7 8.68 ...\n $ MFIL69    : num  9.18 9.06 8.94 9.05 9.06 ...\n $ MFIL79    : num  9.77 9.83 9.66 9.76 9.76 ...\n $ MFIL89    : num  10.13 10.26 9.98 10.3 10.24 ...\n $ FP59      : num  16.8 20 28.7 12.7 16 14.7 27.9 30.8 30.6 21.1 ...\n $ FP69      : num  5.9 10.1 23.4 10.9 8.1 11.1 8.2 25.2 13.1 14 ...\n $ FP79      : num  9.55 6.91 16.72 9.4 14.15 ...\n $ FP89      : num  11.7 11.7 30.5 10 11.9 ...\n $ BLK60     : num  0.0239 0.0819 0.2075 0.0127 0 ...\n $ BLK70     : num  0.0221 0.076 0.0278 0 0 ...\n $ BLK80     : num  0.0394 0.0712 0.0282 0.018 0 ...\n $ BLK90     : num  0.0629 0.0946 0.0908 0.0991 0.1307 ...\n $ GI59      : num  0.211 0.242 0.317 0.24 0.286 ...\n $ GI69      : num  0.296 0.335 0.381 0.355 0.379 ...\n $ GI79      : num  0.312 0.336 0.382 0.38 0.391 ...\n $ GI89      : num  0.367 0.373 0.428 0.344 0.378 ...\n $ FH60      : num  6.87 7.86 12.64 9.44 9.23 ...\n $ FH70      : num  3.7 6.4 11.4 8 5.6 7.5 6 10.3 7.2 8.1 ...\n $ FH80      : num  8.53 8.03 14.35 9.47 5.85 ...\n $ FH90      : num  10.7 10.8 18 10.7 9.5 ...\n $ West      : int  1 1 1 1 1 1 1 1 1 1 ...\n\nhead(natregimes_montana.shp@data)\n\n                   fid REGIONS NOSOUTH POLY_ID     NAME STATE_NAME STATE_FIPS\n1 natregimes_montana.0       2       1       7  Lincoln    Montana         30\n2 natregimes_montana.1       2       1       8 Flathead    Montana         30\n3 natregimes_montana.2       2       1       9  Glacier    Montana         30\n4 natregimes_montana.3       2       1      10    Toole    Montana         30\n5 natregimes_montana.4       2       1      11  Liberty    Montana         30\n6 natregimes_montana.5       2       1      12     Hill    Montana         30\n  CNTY_FIPS  FIPS STFIPS COFIPS FIPSNO SOUTH      HR60     HR70      HR80\n1        53 30053     30     53  30053     0  7.976390 5.536179  5.633168\n2        29 30029     30     29  30029     0  1.011173 1.689475  4.490115\n3        35 30035     30     35  30035     0 11.529039 9.273857 28.227324\n4       101 30101     30    101  30101     0  0.000000 5.708740  0.000000\n5        51 30051     30     51  30051     0  0.000000 0.000000  0.000000\n6        41 30041     30     41  30041     0  3.574045 3.840688  7.413585\n      HR90      HC60      HC70     HC80      HC90  PO60  PO70  PO80  PO90\n1 5.720497 1.0000000 1.0000000 1.000000 1.0000000 12537 18063 17752 17481\n2 2.814460 0.3333333 0.6666667 2.333333 1.6666667 32965 39460 51966 59218\n3 5.500096 1.3333333 1.0000000 3.000000 0.6666667 11565 10783 10628 12121\n4 6.605892 0.0000000 0.3333333 0.000000 0.3333333  7904  5839  5559  5046\n5 0.000000 0.0000000 0.0000000 0.000000 0.0000000  2624  2359  2329  2295\n6 1.888146 0.6666667 0.6666667 1.333333 0.3333333 18653 17358 17985 17654\n        RD60       RD70       RD80       RD90       PS60       PS70       PS80\n1 -1.4042598 -1.5426214 -0.9071029 -0.2342999 -0.9820457 -0.6979686 -0.7968777\n2 -1.1362915 -0.8845592 -0.9385383 -0.3047841 -0.3460932 -0.2317217 -0.1310444\n3 -0.3145964  0.2010717  0.4129320  1.4785661 -0.9666818 -1.0020089 -1.1072647\n4 -1.2456903 -0.6362448 -0.3137972 -0.6494730 -1.1167019 -1.3137875 -1.4332524\n5 -0.9720294 -0.7303135 -0.1811841 -0.2980633 -1.8648430 -1.8784566 -1.9652599\n6 -1.1497843 -0.7690945 -0.5384804 -0.2891518 -0.5925901 -0.6484952 -0.7144108\n         PS90 UE60 UE70      UE80      UE90     DV60     DV70     DV80     DV90\n1 -0.80405473 17.3 10.3 27.534319 16.118209 3.437140 3.796674 6.129678 9.566015\n2 -0.05980789 13.8  9.8 14.229821  7.722523 2.596485 3.299732 6.217617 9.281914\n3 -1.00040768 12.8 12.6  8.560477 16.961060 3.861104 3.501281 5.840611 7.820672\n4 -1.47026101  5.5  3.6  3.545493  1.850329 3.300825 4.065828 4.637681 7.688201\n5 -1.92917594  5.1  0.5  1.831897  2.598870 2.399128 3.113772 4.208195 4.441624\n6 -0.72631046  6.3  4.3  6.504457  7.372424 2.485284 2.514011 5.130874 7.643013\n  MA60 MA70 MA80 MA90     POL60     POL70     POL80     POL90     DNL60\n1 24.8 25.1 28.3 34.7  9.436440  9.801621  9.784253  9.768870 1.2165748\n2 30.1 28.0 29.7 35.3 10.403202 10.583043 10.858345 10.988981 1.8589771\n3 22.8 22.1 26.8 28.2  9.355739  9.285726  9.271247  9.402695 1.3614436\n4 25.9 29.4 29.9 35.3  8.975124  8.672315  8.623174  8.526351 1.3995396\n5 24.8 26.9 30.0 34.0  7.872455  7.765993  7.753194  7.738488 0.6007514\n6 24.0 24.2 27.2 31.7  9.833762  9.761809  9.797293  9.778718 1.8520290\n      DNL70     DNL80     DNL90   MFIL59   MFIL69   MFIL79   MFIL89 FP59 FP69\n1 1.5817562 1.5911574 1.5766315 8.609408 9.181015 9.768813 10.12999 16.8  5.9\n2 2.0388182 2.3189207 2.4522596 8.592672 9.055673 9.830218 10.26004 20.0 10.1\n3 1.2914311 1.2667148 1.3980954 8.550435 8.942984 9.660843  9.97525 28.7 23.4\n4 1.0967302 1.0575356 0.9710215 8.703341 9.047821 9.760483 10.29958 12.7 10.9\n5 0.4942894 0.4902151 0.4731983 8.675564 9.059517 9.762903 10.24256 16.0  8.1\n6 1.7800755 1.8257588 1.8074938 8.733916 9.096163 9.902337 10.34358 14.7 11.1\n       FP79     FP89      BLK60      BLK70      BLK80      BLK90      GI59\n1  9.547634 11.67276 0.02392917 0.02214472 0.03943218 0.06292546 0.2114246\n2  6.907224 11.71484 0.08190505 0.07602636 0.07120040 0.09456584 0.2419263\n3 16.722284 30.50017 0.20752270 0.02782157 0.02822732 0.09075159 0.3168864\n4  9.404990 10.04601 0.01265182 0.00000000 0.01798885 0.09908839 0.2399049\n5 14.146341 11.91710 0.00000000 0.00000000 0.00000000 0.13071895 0.2863521\n6  9.838504 12.41975 0.12866563 0.45512156 0.05004170 0.10762433 0.2596779\n       GI69      GI79      GI89      FH60 FH70      FH80      FH90 West\n1 0.2955510 0.3123898 0.3667044  6.872739  3.7  8.526162 10.738936    1\n2 0.3353569 0.3364158 0.3732165  7.863412  6.4  8.025603 10.842786    1\n3 0.3813661 0.3815989 0.4278562 12.644595 11.4 14.349277 18.013291    1\n4 0.3548186 0.3798462 0.3438127  9.444444  8.0  9.468970 10.736196    1\n5 0.3793765 0.3908409 0.3779590  9.225700  5.6  5.853659  9.499136    1\n6 0.3441587 0.3586575 0.3694063  9.356043  7.5 11.432214 13.194598    1\n\n\n\n6.3.1 Filtrando dados\nVamos separar algumas variáveis para usarmos no modelo\n\ndados &lt;- natregimes_montana.shp@data\ndados &lt;- subset(dados, select=c(\"POLY_ID\", \"HR90\", \"HR80\", \"RD90\", \"RD80\",\"UE90\", \"UE80\"))"
  },
  {
    "objectID": "modelos_painel.html#matriz-de-vizinhança",
    "href": "modelos_painel.html#matriz-de-vizinhança",
    "title": "6  Modelos espaciais em painel",
    "section": "6.4 Matriz de vizinhança",
    "text": "6.4 Matriz de vizinhança\nPara rodar os paineis espaciais, vamos precisar de uma matriz de vizinhança.\n\nlibrary(spdep)\n\n\nAttaching package: 'spdep'\n\n\nThe following objects are masked from 'package:spatialreg':\n\n    get.ClusterOption, get.coresOption, get.mcOption,\n    get.VerboseOption, get.ZeroPolicyOption, set.ClusterOption,\n    set.coresOption, set.mcOption, set.VerboseOption,\n    set.ZeroPolicyOption\n\nw1 &lt;- nb2listw(poly2nb(natregimes_montana.shp, queen = TRUE))\nsummary(w1)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 55 \nNumber of nonzero links: 272 \nPercentage nonzero weights: 8.991736 \nAverage number of links: 4.945455 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 3  8 11 16  6  7  3  1 \n3 least connected regions:\n1 7 28 with 2 links\n1 most connected region:\n2 with 9 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 55 3025 55 23.70729 228.2789\n\n\n\n6.4.1 Variáveis defasadas espacialmente\n\ndados$lag_HR90 &lt;- lag.listw(w1, dados$HR90)\ndados$lag_HR80 &lt;- lag.listw(w1, dados$HR80)\ndados$lag_RD90 &lt;- lag.listw(w1, dados$RD90)\ndados$lag_RD80 &lt;- lag.listw(w1, dados$RD80)\ndados$lag_UE90 &lt;- lag.listw(w1, dados$UE90)\ndados$lag_UE80 &lt;- lag.listw(w1, dados$UE80)"
  },
  {
    "objectID": "modelos_painel.html#empilhar-dados",
    "href": "modelos_painel.html#empilhar-dados",
    "title": "6  Modelos espaciais em painel",
    "section": "6.5 Empilhar dados",
    "text": "6.5 Empilhar dados\nPara empilhar os dados de modo automático, vamos precisar que a base de dados tenha uma organização básica.\n\nO primeiro campo deve ser o de identificação;\nOs nomes das variáveis devem conter a especificação da variável e o ano, algo como “PIB2000” e “PIB2010”.\nNão devem existir outras variáveis além da identificação e dados do painel.\n\nVejamos a base de dados do exemplo.\n\nnames(dados)\n\n [1] \"POLY_ID\"  \"HR90\"     \"HR80\"     \"RD90\"     \"RD80\"     \"UE90\"    \n [7] \"UE80\"     \"lag_HR90\" \"lag_HR80\" \"lag_RD90\" \"lag_RD80\" \"lag_UE90\"\n[13] \"lag_UE80\"\n\n\nPara colocar os dados em painel, criamos uma função. Veja abaixo.\n\npainel &lt;- function(id, dados){\n  require(reshape2)\n  \n  dadosp &lt;- reshape2::melt(dados, id=id)\n  dadosp$varname &lt;- as.character(gsub(\"[[:digit:]]\", \"\", dadosp$variable))\n  dadosp$year &lt;-  as.character(gsub(\"[[:alpha:]]\", \"\", dadosp$variable))\n  \n  sp &lt;- split(dadosp, f = dadosp$varname)\n  \n  dadosp &lt;- data.frame(sp[[1]][,1], sp[[1]]$year)\n  \n  for(i in 1:length(sp)){\n    dadosp &lt;- cbind(dadosp, sp[[i]]$value)\n  }\n  \n  names(dadosp) &lt;- c(\"id\",\"ano\",names(sp)) \n  \n  return(dadosp)\n}\n\nDepois de declarada, vamos colocar os dados em painel.\n\ndadosp &lt;- painel(\"POLY_ID\", dados)\n\nLoading required package: reshape2\n\n\n\nhead(dadosp)\n\n  id ano       HR   lag_HR      lag_RD   lag_UE         RD        UE\n1  7  90 5.720497 3.329789 -0.22352606 8.606974 -0.2342999 16.118209\n2  8  90 2.814460 5.257950  0.03762522 8.897906 -0.3047841  7.722523\n3  9  90 5.500096 4.867323 -0.41474938 5.425459  1.4785661 16.961060\n4 10  90 6.605892 3.560571  0.29683726 8.754485 -0.6494730  1.850329\n5 11  90 0.000000 3.418914 -0.34637004 4.856264 -0.2980633  2.598870\n6 12  90 1.888146 4.954419  0.20961082 5.438876 -0.2891518  7.372424\n\n\n\n6.5.1 Verifica se o painél é balanceado\n\nis.pbalanced(dadosp)\n\n[1] TRUE"
  },
  {
    "objectID": "modelos_painel.html#especificação-do-modelo",
    "href": "modelos_painel.html#especificação-do-modelo",
    "title": "6  Modelos espaciais em painel",
    "section": "6.6 Especificação do modelo",
    "text": "6.6 Especificação do modelo\n\nesp &lt;- HR ~ RD + UE"
  },
  {
    "objectID": "modelos_painel.html#testes",
    "href": "modelos_painel.html#testes",
    "title": "6  Modelos espaciais em painel",
    "section": "6.7 Testes",
    "text": "6.7 Testes\n\n6.7.1 Teste de Hausman\n\nfe &lt;- plm(esp, data = dadosp)\nre &lt;- plm(esp, data = dadosp, model = \"random\")\nph &lt;- phtest(fe, re) # H0: efeitos aleatórios\nprint(ph)\n\n\n    Hausman Test\n\ndata:  esp\nchisq = 18.503, df = 2, p-value = 9.598e-05\nalternative hypothesis: one model is inconsistent\n\n\n\n\n6.7.2 Teste espacial de Hausman\n\nerror_type &lt;- \"b\"\n    \nsar_random &lt;- spml(esp, data = dadosp, listw = w1, lag = TRUE, model = \"random\", effect = \"individual\", spatial.error = \"none\")\n    \nsar_fixed &lt;- spml(esp, data = dadosp, listw = w1, lag = TRUE, model = \"within\", effect = \"individual\", spatial.error = \"none\")\n    \nsem_random &lt;- spml(esp, data = dadosp, listw = w1, lag = FALSE, model = \"random\", effect = \"individual\", spatial.error = error_type)\n    \nsem_fixed &lt;- spml(esp, data = dadosp, listw = w1, lag = FALSE, model = \"within\", effect = \"individual\", spatial.error = error_type)\n    \nsac_random &lt;- spml(esp, data = dadosp, listw = w1, lag = TRUE, model = \"random\", effect = \"individual\", spatial.error = error_type)\n    \nsac_fixed &lt;- spml(esp, data = dadosp, listw = w1, lag = TRUE, model = \"within\", effect = \"individual\", spatial.error = error_type)\n    \ntest_sar &lt;- sphtest(sar_random, sar_fixed)\ntest_sem &lt;- sphtest(sem_random, sem_fixed)\ntest_sac &lt;- sphtest(sac_random, sac_fixed)\n    \nres &lt;- cbind(\n  c(test_sar$statistic, test_sar$p.value),\n  c(test_sem$statistic, test_sem$p.value),\n  c(test_sac$statistic, test_sac$p.value)\n)\n\ndimnames(res) &lt;- list(c(\"test\", \"p-value\"), c(\"SAR\",\"SEM\",\"SAC\"))\nround(x = res, digits = 5)\n\n             SAR      SEM      SAC\ntest    57.60107 59.82911 73.12357\np-value  0.00000  0.00000  0.00000\n\n\n\n\n6.7.3 Teste Pesaran CD (cross-section dependence)\n\ncd &lt;- pcdtest(esp, data = dadosp) # H0: ausência de dependência CS\n\nWarning: Insufficient number of observations in time to estimate heterogeneous\nmodel: using within residuals\n\nprint(cd)\n\n\n    Pesaran CD test for cross-sectional dependence in panels\n\ndata:  HR ~ RD + UE\nz = 0.47708, p-value = 0.6333\nalternative hypothesis: cross-sectional dependence\n\n\n\n\n6.7.4 Teste BSK\n\nres_lmh &lt;- bsktest(esp, data = dadosp, listw = w1, test = \"LMH\")\nres_lm1 &lt;- bsktest(esp, data = dadosp, listw = w1, test = \"LM1\")\nres_lm2 &lt;- bsktest(esp, data = dadosp, listw = w1, test = \"LM2\")\nres_clm_mu &lt;- bsktest(esp, data = dadosp, listw = w1, test = \"CLMmu\")\nres_clm_lambda &lt;- bsktest(esp, data = dadosp, listw = w1, test = \"CLMlambda\")\n\nres &lt;- cbind(\n  c(res_lmh$statistic, res_lmh$p.value),\n  c(res_lm1$statistic, res_lm1$p.value),\n  c(res_lm2$statistic, res_lm2$p.value),\n  c(res_clm_mu$statistic, res_clm_mu$p.value),\n  c(res_clm_lambda$statistic, res_clm_lambda$p.value)\n)\n\ndimnames(res) &lt;- list(c(\"test\", \"p-value\"), c(\"LM joint\",\"LM mu\",\"LM lambda\", \"CLM mu\", \"CLM lambda\"))\nround(x = res, digits = 5)\n\n        LM joint    LM mu LM lambda  CLM mu CLM lambda\ntest     0.00067 -0.16962   0.02596 0.16929    0.01471\np-value  0.73956  1.13469   0.97929 0.86557    0.98826\n\n\n\n\n6.7.5 Teste BSJK\n\nres_c1 &lt;- bsjktest(esp, data = dadosp, listw = w1, test = \"C.1\")\nres_c2 &lt;- bsjktest(esp, data = dadosp, listw = w1, test = \"C.2\")\nres_c3 &lt;- bsjktest(esp, data = dadosp, listw = w1, test = \"C.3\")\nres_j &lt;- bsjktest(esp, data = dadosp, listw = w1, test = \"J\")\n\nres &lt;- cbind(\n  c(res_c1$statistic, res_c1$p.value),\n  c(res_c2$statistic, res_c2$p.value),\n  c(res_c3$statistic, res_c3$p.value),\n  c(res_j$statistic, res_j$p.value)\n)\n\ndimnames(res) &lt;- list(c(\"test\", \"p-value\"), c(\"C.1\",\"C.2\",\"C.3\", \"J\"))\nround(x = res, digits = 5)\n\n            C.1      C.2      C.3   J\ntest    0.00089 2627.012 -55.1903 Inf\np-value 0.97618    0.000   1.0000   0"
  },
  {
    "objectID": "modelos_painel.html#modelos",
    "href": "modelos_painel.html#modelos",
    "title": "6  Modelos espaciais em painel",
    "section": "6.8 Modelos",
    "text": "6.8 Modelos\n\n6.8.1 OLS\n\nmodOLS &lt;- plm(esp, data=dadosp)\nsummary(modOLS)\n\nOneway (individual) effect Within Model\n\nCall:\nplm(formula = esp, data = dadosp)\n\nBalanced Panel: n = 55, T = 2, N = 110\n\nResiduals:\n       Min.     1st Qu.      Median     3rd Qu.        Max. \n-1.6018e+01 -1.4836e+00 -9.7145e-17  1.4836e+00  1.6018e+01 \n\nCoefficients:\n   Estimate Std. Error t-value Pr(&gt;|t|)  \nRD -1.70968    2.03753 -0.8391  0.40518  \nUE -0.60668    0.30327 -2.0005  0.05058 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nTotal Sum of Squares:    1945.6\nResidual Sum of Squares: 1778.9\nR-Squared:      0.085641\nAdj. R-Squared: -0.88048\nF-statistic: 2.48204 on 2 and 53 DF, p-value: 0.093239\n\n\n\n\n6.8.2 SAR (ML)\n\nmodSAR &lt;- spml(esp, data = dadosp, listw = w1, lag = TRUE, model = \"within\", effect = \"individual\", spatial.error = \"none\")\nsummary(modSAR)\n\nSpatial panel fixed effects lag model\n \n\nCall:\nspml(formula = esp, data = dadosp, listw = w1, model = \"within\", \n    effect = \"individual\", lag = TRUE, spatial.error = \"none\")\n\nResiduals:\n       Min.     1st Qu.      Median     3rd Qu.        Max. \n-1.6051e+01 -1.5039e+00  5.0307e-16  1.5039e+00  1.6051e+01 \n\nSpatial autoregressive coefficient:\n       Estimate Std. Error t-value Pr(&gt;|t|)\nlambda 0.041611   0.139414  0.2985   0.7653\n\nCoefficients:\n   Estimate Std. Error t-value Pr(&gt;|t|)   \nRD -1.72265    1.41373 -1.2185 0.223029   \nUE -0.60525    0.21228 -2.8512 0.004356 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nimpSAR &lt;- impacts(modSAR, listw = w1, time = 2)\nsummary(impSAR, zstats=TRUE, short=TRUE)\n\nImpact measures (lag, trace):\n       Direct    Indirect      Total\nRD -1.7232646 -0.07418350 -1.7974481\nUE -0.6054694 -0.02606439 -0.6315338\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n      Direct  Indirect     Total\nRD 1.3674978 0.4243478 1.5459931\nUE 0.2227749 0.1095275 0.2485368\n\nSimulated z-values:\n      Direct   Indirect     Total\nRD -1.341009 -0.3528343 -1.283027\nUE -2.723723 -0.3622596 -2.601042\n\nSimulated p-values:\n   Direct    Indirect Total    \nRD 0.1799176 0.72421  0.1994826\nUE 0.0064551 0.71716  0.0092941\n\n\n\n\n6.8.3 SAR (GM)\n\nmodSAR_gm &lt;- spgm(esp, data = dadosp, listw = w1, lag = TRUE, spatial.error = FALSE, model = \"within\", moments = \"weights\", endog = NULL, instruments = NULL)\n\nsummary(modSAR_gm)\n\nSpatial w2sls model \n\nCall:\nspgm(formula = esp, data = dadosp, listw = w1, model = \"within\", \n    lag = TRUE, spatial.error = FALSE, moments = \"weights\", endog = NULL, \n    instruments = NULL)\n\nResiduals:\n       Min.     1st Qu.      Median     3rd Qu.        Max. \n-1.5911e+01 -1.5530e+00 -1.1102e-16  1.5530e+00  1.5911e+01 \n\nSpatial autoregressive coefficient:\n       Estimate Std. Error t-value Pr(&gt;|t|)\nlambda -0.13678    0.34803  -0.393   0.6943\n\nCoefficients:\n   Estimate Std. Error t-value Pr(&gt;|t|)   \nRD -1.66704    1.44634 -1.1526 0.249078   \nUE -0.61138    0.21500 -2.8436 0.004461 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nimpacts(modSAR_gm, listw = w1, time = 2)\n\nImpact measures (lag, trace):\n       Direct   Indirect      Total\nRD -1.6731043 0.20665672 -1.4664475\nUE -0.6136056 0.07579069 -0.5378149\n\n\n\n\n6.8.4 SEM (ML)\n\nmodSEM &lt;- spml(esp, data = dadosp, listw = w1, lag = FALSE, model = \"within\", effect = \"individual\", spatial.error = \"b\")\nsummary(modSEM)\n\nSpatial panel fixed effects error model\n \n\nCall:\nspml(formula = esp, data = dadosp, listw = w1, model = \"within\", \n    effect = \"individual\", lag = FALSE, spatial.error = \"b\")\n\nResiduals:\n       Min.     1st Qu.      Median     3rd Qu.        Max. \n-1.5976e+01 -1.5531e+00  8.8818e-16  1.5531e+00  1.5976e+01 \n\nSpatial error parameter:\n    Estimate Std. Error t-value Pr(&gt;|t|)\nrho  0.12909    0.13804  0.9352   0.3497\n\nCoefficients:\n   Estimate Std. Error t-value Pr(&gt;|t|)   \nRD -1.74299    1.45918 -1.1945 0.232280   \nUE -0.66625    0.22026 -3.0249 0.002488 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n6.8.5 SEM (GM)\n\nmodSEM_gm &lt;- spgm(esp, data = dadosp, listw = w1, lag = FALSE, spatial.error = TRUE, model = \"within\", moments = \"weights\", endog = NULL, instruments = NULL)\n\nsummary(modSEM_gm)\n\nSpatial fixed effects error model (GM estimation) \n\nCall:\nspgm(formula = esp, data = dadosp, listw = w1, model = \"within\", \n    lag = FALSE, spatial.error = TRUE, moments = \"weights\", endog = NULL, \n    instruments = NULL)\n\nResiduals:\n       Min.     1st Qu.      Median     3rd Qu.        Max. \n-1.6009e+01 -1.6060e+00  2.7756e-17  1.6060e+00  1.6009e+01 \n\nEstimated spatial coefficient, variance components and theta:\n          Estimate\nrho        0.12991\nsigma^2_v 32.10872\n\nCoefficients:\n   Estimate Std. Error t-value Pr(&gt;|t|)   \nRD -1.74318    1.47292 -1.1835 0.236618   \nUE -0.66665    0.22235 -2.9982 0.002716 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n6.8.6 SAC (ML)\n\nmodSAC &lt;- spml(esp, data = dadosp, listw = w1, lag = TRUE, model = \"within\", effect = \"individual\", spatial.error = \"b\")\nsummary(modSAC)\n\nSpatial panel fixed effects sarar model\n \n\nCall:\nspml(formula = esp, data = dadosp, listw = w1, model = \"within\", \n    effect = \"individual\", lag = TRUE, spatial.error = \"b\")\n\nResiduals:\n       Min.     1st Qu.      Median     3rd Qu.        Max. \n-1.5352e+01 -2.2314e+00  1.1102e-15  2.2314e+00  1.5352e+01 \n\nSpatial error parameter:\n    Estimate Std. Error t-value  Pr(&gt;|t|)    \nrho  0.56959    0.17228  3.3062 0.0009455 ***\n\nSpatial autoregressive coefficient:\n       Estimate Std. Error t-value Pr(&gt;|t|)  \nlambda -0.61788    0.26057 -2.3713  0.01773 *\n\nCoefficients:\n   Estimate Std. Error t-value  Pr(&gt;|t|)    \nRD -1.27359    1.47521 -0.8633 0.3879579    \nUE -0.81066    0.23375 -3.4681 0.0005242 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nimpSAC &lt;- impacts(modSAC, listw = w1, time = 2)\nsummary(impSAC, zstats=TRUE, short=TRUE)\n\nImpact measures (lag, trace):\n       Direct  Indirect      Total\nRD -1.3659102 0.5787157 -0.7871945\nUE -0.8694233 0.3683616 -0.5010617\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n      Direct Indirect    Total\nRD 147.74878 5605.883 5753.624\nUE  62.02735 2352.592 2414.618\n\nSimulated z-values:\n       Direct   Indirect      Total\nRD 0.06323979 0.07178852 0.07156909\nUE 0.05940991 0.07386598 0.07349465\n\nSimulated p-values:\n   Direct  Indirect Total  \nRD 0.94958 0.94277  0.94294\nUE 0.95263 0.94112  0.94141\n\n\n\n\n6.8.7 SAC (GM)\n\nmodSAC_gm &lt;- spgm(esp, data = dadosp, listw = w1, lag = TRUE, spatial.error = TRUE, model = \"within\", moments = \"weights\", endog = NULL, instruments = NULL)\n\nsummary(modSAC_gm)\n\nSpatial fixed effects  SARAR model (GM estimation) \n\nCall:\nspgm(formula = esp, data = dadosp, listw = w1, model = \"within\", \n    lag = TRUE, spatial.error = TRUE, moments = \"weights\", endog = NULL, \n    instruments = NULL)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.185   4.166   8.600  10.750  14.484  42.990 \n\nEstimated spatial coefficient, variance components and theta:\n          Estimate\nrho        0.24997\nsigma^2_v 31.37009\n\nSpatial autoregressive coefficient:\n       Estimate Std. Error t-value Pr(&gt;|t|)\nlambda -0.42865    0.57903 -0.7403   0.4591\n\nCoefficients:\n   Estimate Std. Error t-value Pr(&gt;|t|)  \nRD -1.49849    2.14154 -0.6997  0.48410  \nUE -0.70468    0.32459 -2.1709  0.02994 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Impactos ainda não implementado\n# splm:::impacts(modSAC_gm, listw = w1, time = 2)\n\n\n\n6.8.8 Especificação com lag\n\nesp_lag &lt;- HR ~ lag_RD + lag_UE\n\n\n\n6.8.9 SDM (ML)\n\nmodSDM &lt;- spml(esp_lag, data = dadosp, listw = w1, lag = TRUE, model = \"within\", effect = \"individual\", spatial.error = \"none\")\nsummary(modSDM)\n\nSpatial panel fixed effects lag model\n \n\nCall:\nspml(formula = esp_lag, data = dadosp, listw = w1, model = \"within\", \n    effect = \"individual\", lag = TRUE, spatial.error = \"none\")\n\nResiduals:\n       Min.     1st Qu.      Median     3rd Qu.        Max. \n-1.6035e+01 -7.9460e-01  7.2164e-16  7.9460e-01  1.6035e+01 \n\nSpatial autoregressive coefficient:\n       Estimate Std. Error t-value Pr(&gt;|t|)\nlambda 0.079183   0.140775  0.5625   0.5738\n\nCoefficients:\n       Estimate Std. Error t-value Pr(&gt;|t|)\nlag_RD  2.08471    2.67145  0.7804   0.4352\nlag_UE  0.28441    0.34111  0.8338   0.4044\n\nimpSDM &lt;- impacts(modSDM, listw = w1, time = 2)\nsummary(impSDM, zstats=TRUE, short=TRUE)\n\nImpact measures (lag, trace):\n          Direct   Indirect     Total\nlag_RD 2.0874286 0.17655424 2.2639828\nlag_UE 0.2847807 0.02408669 0.3088674\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n          Direct   Indirect     Total\nlag_RD 2.3743758 0.52353230 2.5983533\nlag_UE 0.3288402 0.08001749 0.3610444\n\nSimulated z-values:\n          Direct  Indirect     Total\nlag_RD 0.9133306 0.3098754 0.8970373\nlag_UE 0.9443251 0.3352516 0.9343948\n\nSimulated p-values:\n       Direct  Indirect Total \nlag_RD 0.36107 0.75666  0.3697\nlag_UE 0.34500 0.73744  0.3501\n\n\n\n\n6.8.10 SDEM (ML)\n\nmodSDEM &lt;- spml(esp_lag, data = dadosp, listw = w1, lag = FALSE, model = \"within\", effect = \"individual\", spatial.error = \"b\")\nsummary(modSDEM)\n\nSpatial panel fixed effects error model\n \n\nCall:\nspml(formula = esp_lag, data = dadosp, listw = w1, model = \"within\", \n    effect = \"individual\", lag = FALSE, spatial.error = \"b\")\n\nResiduals:\n    Min.  1st Qu.   Median  3rd Qu.     Max. \n-15.8759  -1.1474   0.0000   1.1474  15.8759 \n\nSpatial error parameter:\n    Estimate Std. Error t-value Pr(&gt;|t|)\nrho  0.12983    0.13799  0.9409   0.3468\n\nCoefficients:\n       Estimate Std. Error t-value Pr(&gt;|t|)\nlag_RD  2.84568    2.86474  0.9933   0.3205\nlag_UE  0.39960    0.36624  1.0911   0.2752\n\n\n\n\n6.8.11 SLX (ML)\n\nmodSLX &lt;- plm(esp_lag, data = dadosp, model = \"within\", spatial.error = \"none\", lag = FALSE)\nsummary(modSLX)\n\nOneway (individual) effect Within Model\n\nCall:\nplm(formula = esp_lag, data = dadosp, model = \"within\", spatial.error = \"none\", \n    lag = FALSE)\n\nBalanced Panel: n = 55, T = 2, N = 110\n\nResiduals:\n       Min.     1st Qu.      Median     3rd Qu.        Max. \n-1.6021e+01 -9.3583e-01  1.0061e-16  9.3583e-01  1.6021e+01 \n\nCoefficients:\n       Estimate Std. Error t-value Pr(&gt;|t|)\nlag_RD  1.79783    3.85166  0.4668   0.6426\nlag_UE  0.23564    0.49172  0.4792   0.6337\n\nTotal Sum of Squares:    1945.6\nResidual Sum of Squares: 1933.2\nR-Squared:      0.0063674\nAdj. R-Squared: -1.0435\nF-statistic: 0.169816 on 2 and 53 DF, p-value: 0.84428"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "Referências",
    "section": "",
    "text": "Almeida, Eduardo. 2012. Econometria Espacial Aplicada.\nCampinas: Alínea."
  },
  {
    "objectID": "importar_matriz.html",
    "href": "importar_matriz.html",
    "title": "Apêndice A — Importar matrizes criadas no Geoda",
    "section": "",
    "text": "B Importar matriz criada no Geoda\nMatrizes criadas no Geoda através de polígonos de Voronoi.\nlibrary(spdep)\n\nLoading required package: spData\n\n\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n\nqueen_nb &lt;- read.gal(file = \"data/tvpaga_queen.gal\")\nqueen_w &lt;- nb2listw(neighbours = queen_nb, style = \"W\")\n\nrook_nb &lt;- read.gal(file = \"data/tvpaga_rook.gal\")\nrook_w &lt;- nb2listw(neighbours = rook_nb, style = \"W\")"
  },
  {
    "objectID": "importar_matriz.html#shapefile",
    "href": "importar_matriz.html#shapefile",
    "title": "Apêndice A — Importar matrizes criadas no Geoda",
    "section": "A.1 Shapefile",
    "text": "A.1 Shapefile\n\n# Pacotes\nlibrary(sf)\n\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n\nlibrary(sp)\n\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n\n# Abra o arquivo 'gm10.shp'\ntvpaga.shp &lt;- st_read(\"data/tvpaga4.shp\", options = \"ENCODING=WINDOWS-1252\")\n\noptions:        ENCODING=WINDOWS-1252 \nReading layer `tvpaga4' from data source \n  `/home/raphael/projects/ecoespacial/data/tvpaga4.shp' using driver `ESRI Shapefile'\nSimple feature collection with 74 features and 41 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -56.69285 ymin: -32.06813 xmax: -35.70185 ymax: -3.783775\nCRS:           NA\n\ntvpaga.shp &lt;- st_make_valid(tvpaga.shp)\ntvpaga.shp &lt;- as_Spatial(tvpaga.shp)\n\n# Plotar o mapa\nplot(tvpaga.shp)"
  },
  {
    "objectID": "importar_matriz.html#teste-da-importação",
    "href": "importar_matriz.html#teste-da-importação",
    "title": "Apêndice A — Importar matrizes criadas no Geoda",
    "section": "B.1 Teste da importação",
    "text": "B.1 Teste da importação\n\nsummary(queen_nb)\n\nNeighbour list object:\nNumber of regions: 74 \nNumber of nonzero links: 404 \nPercentage nonzero weights: 7.377648 \nAverage number of links: 5.459459 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 1  3 17 18 18 10  6  1 \n1 least connected region:\n73 with 2 links\n1 most connected region:\n33 with 9 links\n\nsummary(rook_nb)\n\nNeighbour list object:\nNumber of regions: 74 \nNumber of nonzero links: 404 \nPercentage nonzero weights: 7.377648 \nAverage number of links: 5.459459 \nLink number distribution:\n\n 2  3  4  5  6  7  8  9 \n 1  3 17 18 18 10  6  1 \n1 least connected region:\n73 with 2 links\n1 most connected region:\n33 with 9 links\n\n\n\nmoran.test(x = tvpaga.shp@data$GIN, listw = queen_w)\n\n\n    Moran I test under randomisation\n\ndata:  tvpaga.shp@data$GIN  \nweights: queen_w    \n\nMoran I statistic standard deviate = 0.59822, p-value = 0.2748\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n    -1.141553e-02     -1.369863e-02      1.456567e-05 \n\nmoran.test(x = tvpaga.shp@data$GIN, listw = rook_w)\n\n\n    Moran I test under randomisation\n\ndata:  tvpaga.shp@data$GIN  \nweights: rook_w    \n\nMoran I statistic standard deviate = 0.59822, p-value = 0.2748\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n    -1.141553e-02     -1.369863e-02      1.456567e-05"
  },
  {
    "objectID": "importar_matriz.html#criando-os-polígonos-no-r",
    "href": "importar_matriz.html#criando-os-polígonos-no-r",
    "title": "Apêndice A — Importar matrizes criadas no Geoda",
    "section": "B.2 Criando os polígonos no R",
    "text": "B.2 Criando os polígonos no R\n\nlibrary(dismo)\n\nLoading required package: raster\n\ncoordenadas &lt;- coordinates(obj = tvpaga.shp)\n\ntvpaga_voronoi &lt;- voronoi(coordenadas)\n\nplot(tvpaga_voronoi)\n\n\n\n\n\nB.2.1 Matriz\n\n# Matriz queen\nw1 &lt;- nb2listw(poly2nb(tvpaga_voronoi, queen = TRUE), style = \"W\")\n\n\n\nB.2.2 Comparação\n\nmoran.test(x = tvpaga.shp@data$GIN, listw = queen_w)\n\n\n    Moran I test under randomisation\n\ndata:  tvpaga.shp@data$GIN  \nweights: queen_w    \n\nMoran I statistic standard deviate = 0.59822, p-value = 0.2748\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n    -1.141553e-02     -1.369863e-02      1.456567e-05 \n\n\n\nmoran.test(x = tvpaga.shp@data$GIN, listw = w1)\n\n\n    Moran I test under randomisation\n\ndata:  tvpaga.shp@data$GIN  \nweights: w1    \n\nMoran I statistic standard deviate = 0.61642, p-value = 0.2688\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n    -1.141553e-02     -1.369863e-02      1.371827e-05"
  }
]